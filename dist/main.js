!function(){var t={77:function(t,e,n){var r;function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */}t=n.nmd(t),function(){var i,u="Expected a function",a="__lodash_hash_undefined__",c="__lodash_placeholder__",f=16,l=32,s=64,p=128,h=256,y=1/0,d=9007199254740991,v=NaN,b=4294967295,m=[["ary",p],["bind",1],["bindKey",2],["curry",8],["curryRight",f],["flip",512],["partial",l],["partialRight",s],["rearg",h]],g="[object Arguments]",_="[object Array]",w="[object Boolean]",x="[object Date]",O="[object Error]",P="[object Function]",S="[object GeneratorFunction]",T="[object Map]",A="[object Number]",j="[object Object]",R="[object Promise]",N="[object RegExp]",F="[object Set]",E="[object String]",L="[object Symbol]",k="[object WeakMap]",C="[object ArrayBuffer]",I="[object DataView]",U="[object Float32Array]",D="[object Float64Array]",M="[object Int8Array]",z="[object Int16Array]",B="[object Int32Array]",X="[object Uint8Array]",J="[object Uint8ClampedArray]",Q="[object Uint16Array]",V="[object Uint32Array]",Y=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,W=/(__e\(.*?\)|\b__t\)) \+\n'';/g,G=/&(?:amp|lt|gt|quot|#39);/g,q=/[&<>"']/g,K=RegExp(G.source),$=RegExp(q.source),Z=/<%-([\s\S]+?)%>/g,tt=/<%([\s\S]+?)%>/g,et=/<%=([\s\S]+?)%>/g,nt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rt=/^\w*$/,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/[\\^$.*+?()[\]{}|]/g,ut=RegExp(it.source),at=/^\s+/,ct=/\s/,ft=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,st=/,? & /,pt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ht=/[()=,{}\[\]\/\s]/,yt=/\\(\\)?/g,dt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vt=/\w*$/,bt=/^[-+]0x[0-9a-f]+$/i,mt=/^0b[01]+$/i,gt=/^\[object .+?Constructor\]$/,_t=/^0o[0-7]+$/i,wt=/^(?:0|[1-9]\d*)$/,xt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ot=/($^)/,Pt=/['\n\r\u2028\u2029\\]/g,St="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Tt="\\u2700-\\u27bf",At="a-z\\xdf-\\xf6\\xf8-\\xff",jt="A-Z\\xc0-\\xd6\\xd8-\\xde",Rt="\\ufe0e\\ufe0f",Nt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ft="['’]",Et="[\\ud800-\\udfff]",Lt="["+Nt+"]",kt="["+St+"]",Ct="\\d+",It="[\\u2700-\\u27bf]",Ut="["+At+"]",Dt="[^\\ud800-\\udfff"+Nt+Ct+Tt+At+jt+"]",Mt="\\ud83c[\\udffb-\\udfff]",zt="[^\\ud800-\\udfff]",Bt="(?:\\ud83c[\\udde6-\\uddff]){2}",Xt="[\\ud800-\\udbff][\\udc00-\\udfff]",Jt="["+jt+"]",Qt="(?:"+Ut+"|"+Dt+")",Vt="(?:"+Jt+"|"+Dt+")",Yt="(?:['’](?:d|ll|m|re|s|t|ve))?",Ht="(?:['’](?:D|LL|M|RE|S|T|VE))?",Wt="(?:"+kt+"|"+Mt+")"+"?",Gt="[\\ufe0e\\ufe0f]?",qt=Gt+Wt+("(?:\\u200d(?:"+[zt,Bt,Xt].join("|")+")"+Gt+Wt+")*"),Kt="(?:"+[It,Bt,Xt].join("|")+")"+qt,$t="(?:"+[zt+kt+"?",kt,Bt,Xt,Et].join("|")+")",Zt=RegExp(Ft,"g"),te=RegExp(kt,"g"),ee=RegExp(Mt+"(?="+Mt+")|"+$t+qt,"g"),ne=RegExp([Jt+"?"+Ut+"+"+Yt+"(?="+[Lt,Jt,"$"].join("|")+")",Vt+"+"+Ht+"(?="+[Lt,Jt+Qt,"$"].join("|")+")",Jt+"?"+Qt+"+"+Yt,Jt+"+"+Ht,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ct,Kt].join("|"),"g"),re=RegExp("[\\u200d\\ud800-\\udfff"+St+Rt+"]"),oe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ie=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ue=-1,ae={};ae[U]=ae[D]=ae[M]=ae[z]=ae[B]=ae[X]=ae[J]=ae[Q]=ae[V]=!0,ae[g]=ae[_]=ae[C]=ae[w]=ae[I]=ae[x]=ae[O]=ae[P]=ae[T]=ae[A]=ae[j]=ae[N]=ae[F]=ae[E]=ae[k]=!1;var ce={};ce[g]=ce[_]=ce[C]=ce[I]=ce[w]=ce[x]=ce[U]=ce[D]=ce[M]=ce[z]=ce[B]=ce[T]=ce[A]=ce[j]=ce[N]=ce[F]=ce[E]=ce[L]=ce[X]=ce[J]=ce[Q]=ce[V]=!0,ce[O]=ce[P]=ce[k]=!1;var fe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},le=parseFloat,se=parseInt,pe="object"==(void 0===n.g?"undefined":o(n.g))&&n.g&&n.g.Object===Object&&n.g,he="object"==("undefined"==typeof self?"undefined":o(self))&&self&&self.Object===Object&&self,ye=pe||he||Function("return this")(),de="object"==o(e)&&e&&!e.nodeType&&e,ve=de&&"object"==o(t)&&t&&!t.nodeType&&t,be=ve&&ve.exports===de,me=be&&pe.process,ge=function(){try{var t=ve&&ve.require&&ve.require("util").types;return t||me&&me.binding&&me.binding("util")}catch(t){}}(),_e=ge&&ge.isArrayBuffer,we=ge&&ge.isDate,xe=ge&&ge.isMap,Oe=ge&&ge.isRegExp,Pe=ge&&ge.isSet,Se=ge&&ge.isTypedArray;function Te(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Ae(t,e,n,r){for(var o=-1,i=null==t?0:t.length;++o<i;){var u=t[o];e(r,u,n(u),t)}return r}function je(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Re(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Ne(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Fe(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var u=t[n];e(u,n,t)&&(i[o++]=u)}return i}function Ee(t,e){return!!(null==t?0:t.length)&&Xe(t,e,0)>-1}function Le(t,e,n){for(var r=-1,o=null==t?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}function ke(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}function Ce(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}function Ie(t,e,n,r){var o=-1,i=null==t?0:t.length;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}function Ue(t,e,n,r){var o=null==t?0:t.length;for(r&&o&&(n=t[--o]);o--;)n=e(n,t[o],o,t);return n}function De(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Me=Ye("length");function ze(t,e,n){var r;return n(t,(function(t,n,o){if(e(t,n,o))return r=n,!1})),r}function Be(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}function Xe(t,e,n){return e==e?function(t,e,n){var r=n-1,o=t.length;for(;++r<o;)if(t[r]===e)return r;return-1}(t,e,n):Be(t,Qe,n)}function Je(t,e,n,r){for(var o=n-1,i=t.length;++o<i;)if(r(t[o],e))return o;return-1}function Qe(t){return t!=t}function Ve(t,e){var n=null==t?0:t.length;return n?Ge(t,e)/n:v}function Ye(t){return function(e){return null==e?i:e[t]}}function He(t){return function(e){return null==t?i:t[e]}}function We(t,e,n,r,o){return o(t,(function(t,o,i){n=r?(r=!1,t):e(n,t,o,i)})),n}function Ge(t,e){for(var n,r=-1,o=t.length;++r<o;){var u=e(t[r]);u!==i&&(n=n===i?u:n+u)}return n}function qe(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ke(t){return t?t.slice(0,vn(t)+1).replace(at,""):t}function $e(t){return function(e){return t(e)}}function Ze(t,e){return ke(e,(function(e){return t[e]}))}function tn(t,e){return t.has(e)}function en(t,e){for(var n=-1,r=t.length;++n<r&&Xe(e,t[n],0)>-1;);return n}function nn(t,e){for(var n=t.length;n--&&Xe(e,t[n],0)>-1;);return n}function rn(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var on=He({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),un=He({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function an(t){return"\\"+fe[t]}function cn(t){return re.test(t)}function fn(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function ln(t,e){return function(n){return t(e(n))}}function sn(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var u=t[n];u!==e&&u!==c||(t[n]=c,i[o++]=n)}return i}function pn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function hn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function yn(t){return cn(t)?function(t){var e=ee.lastIndex=0;for(;ee.test(t);)++e;return e}(t):Me(t)}function dn(t){return cn(t)?function(t){return t.match(ee)||[]}(t):function(t){return t.split("")}(t)}function vn(t){for(var e=t.length;e--&&ct.test(t.charAt(e)););return e}var bn=He({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var mn=function t(e){var n,r=(e=null==e?ye:mn.defaults(ye.Object(),e,mn.pick(ye,ie))).Array,ct=e.Date,St=e.Error,Tt=e.Function,At=e.Math,jt=e.Object,Rt=e.RegExp,Nt=e.String,Ft=e.TypeError,Et=r.prototype,Lt=Tt.prototype,kt=jt.prototype,Ct=e["__core-js_shared__"],It=Lt.toString,Ut=kt.hasOwnProperty,Dt=0,Mt=(n=/[^.]+$/.exec(Ct&&Ct.keys&&Ct.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",zt=kt.toString,Bt=It.call(jt),Xt=ye._,Jt=Rt("^"+It.call(Ut).replace(it,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Qt=be?e.Buffer:i,Vt=e.Symbol,Yt=e.Uint8Array,Ht=Qt?Qt.allocUnsafe:i,Wt=ln(jt.getPrototypeOf,jt),Gt=jt.create,qt=kt.propertyIsEnumerable,Kt=Et.splice,$t=Vt?Vt.isConcatSpreadable:i,ee=Vt?Vt.iterator:i,re=Vt?Vt.toStringTag:i,fe=function(){try{var t=di(jt,"defineProperty");return t({},"",{}),t}catch(t){}}(),pe=e.clearTimeout!==ye.clearTimeout&&e.clearTimeout,he=ct&&ct.now!==ye.Date.now&&ct.now,de=e.setTimeout!==ye.setTimeout&&e.setTimeout,ve=At.ceil,me=At.floor,ge=jt.getOwnPropertySymbols,Me=Qt?Qt.isBuffer:i,He=e.isFinite,gn=Et.join,_n=ln(jt.keys,jt),wn=At.max,xn=At.min,On=ct.now,Pn=e.parseInt,Sn=At.random,Tn=Et.reverse,An=di(e,"DataView"),jn=di(e,"Map"),Rn=di(e,"Promise"),Nn=di(e,"Set"),Fn=di(e,"WeakMap"),En=di(jt,"create"),Ln=Fn&&new Fn,kn={},Cn=Xi(An),In=Xi(jn),Un=Xi(Rn),Dn=Xi(Nn),Mn=Xi(Fn),zn=Vt?Vt.prototype:i,Bn=zn?zn.valueOf:i,Xn=zn?zn.toString:i;function Jn(t){if(ia(t)&&!Wu(t)&&!(t instanceof Hn)){if(t instanceof Yn)return t;if(Ut.call(t,"__wrapped__"))return Ji(t)}return new Yn(t)}var Qn=function(){function t(){}return function(e){if(!oa(e))return{};if(Gt)return Gt(e);t.prototype=e;var n=new t;return t.prototype=i,n}}();function Vn(){}function Yn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}function Hn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=b,this.__views__=[]}function Wn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Gn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function qn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Kn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new qn;++e<n;)this.add(t[e])}function $n(t){var e=this.__data__=new Gn(t);this.size=e.size}function Zn(t,e){var n=Wu(t),r=!n&&Hu(t),o=!n&&!r&&$u(t),i=!n&&!r&&!o&&ha(t),u=n||r||o||i,a=u?qe(t.length,Nt):[],c=a.length;for(var f in t)!e&&!Ut.call(t,f)||u&&("length"==f||o&&("offset"==f||"parent"==f)||i&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||xi(f,c))||a.push(f);return a}function tr(t){var e=t.length;return e?t[Kr(0,e-1)]:i}function er(t,e){return Mi(Lo(t),lr(e,0,t.length))}function nr(t){return Mi(Lo(t))}function rr(t,e,n){(n!==i&&!Qu(t[e],n)||n===i&&!(e in t))&&cr(t,e,n)}function or(t,e,n){var r=t[e];Ut.call(t,e)&&Qu(r,n)&&(n!==i||e in t)||cr(t,e,n)}function ir(t,e){for(var n=t.length;n--;)if(Qu(t[n][0],e))return n;return-1}function ur(t,e,n,r){return dr(t,(function(t,o,i){e(r,t,n(t),i)})),r}function ar(t,e){return t&&ko(e,Ca(e),t)}function cr(t,e,n){"__proto__"==e&&fe?fe(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function fr(t,e){for(var n=-1,o=e.length,u=r(o),a=null==t;++n<o;)u[n]=a?i:Na(t,e[n]);return u}function lr(t,e,n){return t==t&&(n!==i&&(t=t<=n?t:n),e!==i&&(t=t>=e?t:e)),t}function sr(t,e,n,r,o,u){var a,c=1&e,f=2&e,l=4&e;if(n&&(a=o?n(t,r,o,u):n(t)),a!==i)return a;if(!oa(t))return t;var s=Wu(t);if(s){if(a=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&Ut.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!c)return Lo(t,a)}else{var p=mi(t),h=p==P||p==S;if($u(t))return Ao(t,c);if(p==j||p==g||h&&!o){if(a=f||h?{}:_i(t),!c)return f?function(t,e){return ko(t,bi(t),e)}(t,function(t,e){return t&&ko(e,Ia(e),t)}(a,t)):function(t,e){return ko(t,vi(t),e)}(t,ar(a,t))}else{if(!ce[p])return o?t:{};a=function(t,e,n){var r=t.constructor;switch(e){case C:return jo(t);case w:case x:return new r(+t);case I:return function(t,e){var n=e?jo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case U:case D:case M:case z:case B:case X:case J:case Q:case V:return Ro(t,n);case T:return new r;case A:case E:return new r(t);case N:return function(t){var e=new t.constructor(t.source,vt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case F:return new r;case L:return o=t,Bn?jt(Bn.call(o)):{}}var o}(t,p,c)}}u||(u=new $n);var y=u.get(t);if(y)return y;u.set(t,a),la(t)?t.forEach((function(r){a.add(sr(r,e,n,r,t,u))})):ua(t)&&t.forEach((function(r,o){a.set(o,sr(r,e,n,o,t,u))}));var d=s?i:(l?f?ci:ai:f?Ia:Ca)(t);return je(d||t,(function(r,o){d&&(r=t[o=r]),or(a,o,sr(r,e,n,o,t,u))})),a}function pr(t,e,n){var r=n.length;if(null==t)return!r;for(t=jt(t);r--;){var o=n[r],u=e[o],a=t[o];if(a===i&&!(o in t)||!u(a))return!1}return!0}function hr(t,e,n){if("function"!=typeof t)throw new Ft(u);return Ci((function(){t.apply(i,n)}),e)}function yr(t,e,n,r){var o=-1,i=Ee,u=!0,a=t.length,c=[],f=e.length;if(!a)return c;n&&(e=ke(e,$e(n))),r?(i=Le,u=!1):e.length>=200&&(i=tn,u=!1,e=new Kn(e));t:for(;++o<a;){var l=t[o],s=null==n?l:n(l);if(l=r||0!==l?l:0,u&&s==s){for(var p=f;p--;)if(e[p]===s)continue t;c.push(l)}else i(e,s,r)||c.push(l)}return c}Jn.templateSettings={escape:Z,evaluate:tt,interpolate:et,variable:"",imports:{_:Jn}},Jn.prototype=Vn.prototype,Jn.prototype.constructor=Jn,Yn.prototype=Qn(Vn.prototype),Yn.prototype.constructor=Yn,Hn.prototype=Qn(Vn.prototype),Hn.prototype.constructor=Hn,Wn.prototype.clear=function(){this.__data__=En?En(null):{},this.size=0},Wn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Wn.prototype.get=function(t){var e=this.__data__;if(En){var n=e[t];return n===a?i:n}return Ut.call(e,t)?e[t]:i},Wn.prototype.has=function(t){var e=this.__data__;return En?e[t]!==i:Ut.call(e,t)},Wn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=En&&e===i?a:e,this},Gn.prototype.clear=function(){this.__data__=[],this.size=0},Gn.prototype.delete=function(t){var e=this.__data__,n=ir(e,t);return!(n<0)&&(n==e.length-1?e.pop():Kt.call(e,n,1),--this.size,!0)},Gn.prototype.get=function(t){var e=this.__data__,n=ir(e,t);return n<0?i:e[n][1]},Gn.prototype.has=function(t){return ir(this.__data__,t)>-1},Gn.prototype.set=function(t,e){var n=this.__data__,r=ir(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},qn.prototype.clear=function(){this.size=0,this.__data__={hash:new Wn,map:new(jn||Gn),string:new Wn}},qn.prototype.delete=function(t){var e=hi(this,t).delete(t);return this.size-=e?1:0,e},qn.prototype.get=function(t){return hi(this,t).get(t)},qn.prototype.has=function(t){return hi(this,t).has(t)},qn.prototype.set=function(t,e){var n=hi(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Kn.prototype.add=Kn.prototype.push=function(t){return this.__data__.set(t,a),this},Kn.prototype.has=function(t){return this.__data__.has(t)},$n.prototype.clear=function(){this.__data__=new Gn,this.size=0},$n.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},$n.prototype.get=function(t){return this.__data__.get(t)},$n.prototype.has=function(t){return this.__data__.has(t)},$n.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Gn){var r=n.__data__;if(!jn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new qn(r)}return n.set(t,e),this.size=n.size,this};var dr=Uo(Or),vr=Uo(Pr,!0);function br(t,e){var n=!0;return dr(t,(function(t,r,o){return n=!!e(t,r,o)})),n}function mr(t,e,n){for(var r=-1,o=t.length;++r<o;){var u=t[r],a=e(u);if(null!=a&&(c===i?a==a&&!pa(a):n(a,c)))var c=a,f=u}return f}function gr(t,e){var n=[];return dr(t,(function(t,r,o){e(t,r,o)&&n.push(t)})),n}function _r(t,e,n,r,o){var i=-1,u=t.length;for(n||(n=wi),o||(o=[]);++i<u;){var a=t[i];e>0&&n(a)?e>1?_r(a,e-1,n,r,o):Ce(o,a):r||(o[o.length]=a)}return o}var wr=Do(),xr=Do(!0);function Or(t,e){return t&&wr(t,e,Ca)}function Pr(t,e){return t&&xr(t,e,Ca)}function Sr(t,e){return Fe(e,(function(e){return ea(t[e])}))}function Tr(t,e){for(var n=0,r=(e=Oo(e,t)).length;null!=t&&n<r;)t=t[Bi(e[n++])];return n&&n==r?t:i}function Ar(t,e,n){var r=e(t);return Wu(t)?r:Ce(r,n(t))}function jr(t){return null==t?t===i?"[object Undefined]":"[object Null]":re&&re in jt(t)?function(t){var e=Ut.call(t,re),n=t[re];try{t[re]=i;var r=!0}catch(t){}var o=zt.call(t);r&&(e?t[re]=n:delete t[re]);return o}(t):function(t){return zt.call(t)}(t)}function Rr(t,e){return t>e}function Nr(t,e){return null!=t&&Ut.call(t,e)}function Fr(t,e){return null!=t&&e in jt(t)}function Er(t,e,n){for(var o=n?Le:Ee,u=t[0].length,a=t.length,c=a,f=r(a),l=1/0,s=[];c--;){var p=t[c];c&&e&&(p=ke(p,$e(e))),l=xn(p.length,l),f[c]=!n&&(e||u>=120&&p.length>=120)?new Kn(c&&p):i}p=t[0];var h=-1,y=f[0];t:for(;++h<u&&s.length<l;){var d=p[h],v=e?e(d):d;if(d=n||0!==d?d:0,!(y?tn(y,v):o(s,v,n))){for(c=a;--c;){var b=f[c];if(!(b?tn(b,v):o(t[c],v,n)))continue t}y&&y.push(v),s.push(d)}}return s}function Lr(t,e,n){var r=null==(t=Fi(t,e=Oo(e,t)))?t:t[Bi(tu(e))];return null==r?i:Te(r,t,n)}function kr(t){return ia(t)&&jr(t)==g}function Cr(t,e,n,r,o){return t===e||(null==t||null==e||!ia(t)&&!ia(e)?t!=t&&e!=e:function(t,e,n,r,o,u){var a=Wu(t),c=Wu(e),f=a?_:mi(t),l=c?_:mi(e),s=(f=f==g?j:f)==j,p=(l=l==g?j:l)==j,h=f==l;if(h&&$u(t)){if(!$u(e))return!1;a=!0,s=!1}if(h&&!s)return u||(u=new $n),a||ha(t)?ii(t,e,n,r,o,u):function(t,e,n,r,o,i,u){switch(n){case I:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case C:return!(t.byteLength!=e.byteLength||!i(new Yt(t),new Yt(e)));case w:case x:case A:return Qu(+t,+e);case O:return t.name==e.name&&t.message==e.message;case N:case E:return t==e+"";case T:var a=fn;case F:var c=1&r;if(a||(a=pn),t.size!=e.size&&!c)return!1;var f=u.get(t);if(f)return f==e;r|=2,u.set(t,e);var l=ii(a(t),a(e),r,o,i,u);return u.delete(t),l;case L:if(Bn)return Bn.call(t)==Bn.call(e)}return!1}(t,e,f,n,r,o,u);if(!(1&n)){var y=s&&Ut.call(t,"__wrapped__"),d=p&&Ut.call(e,"__wrapped__");if(y||d){var v=y?t.value():t,b=d?e.value():e;return u||(u=new $n),o(v,b,n,r,u)}}if(!h)return!1;return u||(u=new $n),function(t,e,n,r,o,u){var a=1&n,c=ai(t),f=c.length,l=ai(e).length;if(f!=l&&!a)return!1;var s=f;for(;s--;){var p=c[s];if(!(a?p in e:Ut.call(e,p)))return!1}var h=u.get(t),y=u.get(e);if(h&&y)return h==e&&y==t;var d=!0;u.set(t,e),u.set(e,t);var v=a;for(;++s<f;){var b=t[p=c[s]],m=e[p];if(r)var g=a?r(m,b,p,e,t,u):r(b,m,p,t,e,u);if(!(g===i?b===m||o(b,m,n,r,u):g)){d=!1;break}v||(v="constructor"==p)}if(d&&!v){var _=t.constructor,w=e.constructor;_==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w||(d=!1)}return u.delete(t),u.delete(e),d}(t,e,n,r,o,u)}(t,e,n,r,Cr,o))}function Ir(t,e,n,r){var o=n.length,u=o,a=!r;if(null==t)return!u;for(t=jt(t);o--;){var c=n[o];if(a&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<u;){var f=(c=n[o])[0],l=t[f],s=c[1];if(a&&c[2]){if(l===i&&!(f in t))return!1}else{var p=new $n;if(r)var h=r(l,s,f,t,e,p);if(!(h===i?Cr(s,l,3,r,p):h))return!1}}return!0}function Ur(t){return!(!oa(t)||(e=t,Mt&&Mt in e))&&(ea(t)?Jt:gt).test(Xi(t));var e}function Dr(t){return"function"==typeof t?t:null==t?ac:"object"==o(t)?Wu(t)?Qr(t[0],t[1]):Jr(t):vc(t)}function Mr(t){if(!Ai(t))return _n(t);var e=[];for(var n in jt(t))Ut.call(t,n)&&"constructor"!=n&&e.push(n);return e}function zr(t){if(!oa(t))return function(t){var e=[];if(null!=t)for(var n in jt(t))e.push(n);return e}(t);var e=Ai(t),n=[];for(var r in t)("constructor"!=r||!e&&Ut.call(t,r))&&n.push(r);return n}function Br(t,e){return t<e}function Xr(t,e){var n=-1,o=qu(t)?r(t.length):[];return dr(t,(function(t,r,i){o[++n]=e(t,r,i)})),o}function Jr(t){var e=yi(t);return 1==e.length&&e[0][2]?Ri(e[0][0],e[0][1]):function(n){return n===t||Ir(n,t,e)}}function Qr(t,e){return Pi(t)&&ji(e)?Ri(Bi(t),e):function(n){var r=Na(n,t);return r===i&&r===e?Fa(n,t):Cr(e,r,3)}}function Vr(t,e,n,r,o){t!==e&&wr(e,(function(u,a){if(o||(o=new $n),oa(u))!function(t,e,n,r,o,u,a){var c=Li(t,n),f=Li(e,n),l=a.get(f);if(l)return void rr(t,n,l);var s=u?u(c,f,n+"",t,e,a):i,p=s===i;if(p){var h=Wu(f),y=!h&&$u(f),d=!h&&!y&&ha(f);s=f,h||y||d?Wu(c)?s=c:Ku(c)?s=Lo(c):y?(p=!1,s=Ao(f,!0)):d?(p=!1,s=Ro(f,!0)):s=[]:ca(f)||Hu(f)?(s=c,Hu(c)?s=wa(c):oa(c)&&!ea(c)||(s=_i(f))):p=!1}p&&(a.set(f,s),o(s,f,r,u,a),a.delete(f));rr(t,n,s)}(t,e,a,n,Vr,r,o);else{var c=r?r(Li(t,a),u,a+"",t,e,o):i;c===i&&(c=u),rr(t,a,c)}}),Ia)}function Yr(t,e){var n=t.length;if(n)return xi(e+=e<0?n:0,n)?t[e]:i}function Hr(t,e,n){e=e.length?ke(e,(function(t){return Wu(t)?function(e){return Tr(e,1===t.length?t[0]:t)}:t})):[ac];var r=-1;e=ke(e,$e(pi()));var o=Xr(t,(function(t,n,o){var i=ke(e,(function(e){return e(t)}));return{criteria:i,index:++r,value:t}}));return function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(o,(function(t,e){return function(t,e,n){var r=-1,o=t.criteria,i=e.criteria,u=o.length,a=n.length;for(;++r<u;){var c=No(o[r],i[r]);if(c)return r>=a?c:c*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}))}function Wr(t,e,n){for(var r=-1,o=e.length,i={};++r<o;){var u=e[r],a=Tr(t,u);n(a,u)&&no(i,Oo(u,t),a)}return i}function Gr(t,e,n,r){var o=r?Je:Xe,i=-1,u=e.length,a=t;for(t===e&&(e=Lo(e)),n&&(a=ke(t,$e(n)));++i<u;)for(var c=0,f=e[i],l=n?n(f):f;(c=o(a,l,c,r))>-1;)a!==t&&Kt.call(a,c,1),Kt.call(t,c,1);return t}function qr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var o=e[n];if(n==r||o!==i){var i=o;xi(o)?Kt.call(t,o,1):yo(t,o)}}return t}function Kr(t,e){return t+me(Sn()*(e-t+1))}function $r(t,e){var n="";if(!t||e<1||e>d)return n;do{e%2&&(n+=t),(e=me(e/2))&&(t+=t)}while(e);return n}function Zr(t,e){return Ii(Ni(t,e,ac),t+"")}function to(t){return tr(Qa(t))}function eo(t,e){var n=Qa(t);return Mi(n,lr(e,0,n.length))}function no(t,e,n,r){if(!oa(t))return t;for(var o=-1,u=(e=Oo(e,t)).length,a=u-1,c=t;null!=c&&++o<u;){var f=Bi(e[o]),l=n;if("__proto__"===f||"constructor"===f||"prototype"===f)return t;if(o!=a){var s=c[f];(l=r?r(s,f,c):i)===i&&(l=oa(s)?s:xi(e[o+1])?[]:{})}or(c,f,l),c=c[f]}return t}var ro=Ln?function(t,e){return Ln.set(t,e),t}:ac,oo=fe?function(t,e){return fe(t,"toString",{configurable:!0,enumerable:!1,value:oc(e),writable:!0})}:ac;function io(t){return Mi(Qa(t))}function uo(t,e,n){var o=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var u=r(i);++o<i;)u[o]=t[o+e];return u}function ao(t,e){var n;return dr(t,(function(t,r,o){return!(n=e(t,r,o))})),!!n}function co(t,e,n){var r=0,o=null==t?r:t.length;if("number"==typeof e&&e==e&&o<=2147483647){for(;r<o;){var i=r+o>>>1,u=t[i];null!==u&&!pa(u)&&(n?u<=e:u<e)?r=i+1:o=i}return o}return fo(t,e,ac,n)}function fo(t,e,n,r){var o=0,u=null==t?0:t.length;if(0===u)return 0;for(var a=(e=n(e))!=e,c=null===e,f=pa(e),l=e===i;o<u;){var s=me((o+u)/2),p=n(t[s]),h=p!==i,y=null===p,d=p==p,v=pa(p);if(a)var b=r||d;else b=l?d&&(r||h):c?d&&h&&(r||!y):f?d&&h&&!y&&(r||!v):!y&&!v&&(r?p<=e:p<e);b?o=s+1:u=s}return xn(u,4294967294)}function lo(t,e){for(var n=-1,r=t.length,o=0,i=[];++n<r;){var u=t[n],a=e?e(u):u;if(!n||!Qu(a,c)){var c=a;i[o++]=0===u?0:u}}return i}function so(t){return"number"==typeof t?t:pa(t)?v:+t}function po(t){if("string"==typeof t)return t;if(Wu(t))return ke(t,po)+"";if(pa(t))return Xn?Xn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function ho(t,e,n){var r=-1,o=Ee,i=t.length,u=!0,a=[],c=a;if(n)u=!1,o=Le;else if(i>=200){var f=e?null:Zo(t);if(f)return pn(f);u=!1,o=tn,c=new Kn}else c=e?[]:a;t:for(;++r<i;){var l=t[r],s=e?e(l):l;if(l=n||0!==l?l:0,u&&s==s){for(var p=c.length;p--;)if(c[p]===s)continue t;e&&c.push(s),a.push(l)}else o(c,s,n)||(c!==a&&c.push(s),a.push(l))}return a}function yo(t,e){return null==(t=Fi(t,e=Oo(e,t)))||delete t[Bi(tu(e))]}function vo(t,e,n,r){return no(t,e,n(Tr(t,e)),r)}function bo(t,e,n,r){for(var o=t.length,i=r?o:-1;(r?i--:++i<o)&&e(t[i],i,t););return n?uo(t,r?0:i,r?i+1:o):uo(t,r?i+1:0,r?o:i)}function mo(t,e){var n=t;return n instanceof Hn&&(n=n.value()),Ie(e,(function(t,e){return e.func.apply(e.thisArg,Ce([t],e.args))}),n)}function go(t,e,n){var o=t.length;if(o<2)return o?ho(t[0]):[];for(var i=-1,u=r(o);++i<o;)for(var a=t[i],c=-1;++c<o;)c!=i&&(u[i]=yr(u[i]||a,t[c],e,n));return ho(_r(u,1),e,n)}function _o(t,e,n){for(var r=-1,o=t.length,u=e.length,a={};++r<o;){var c=r<u?e[r]:i;n(a,t[r],c)}return a}function wo(t){return Ku(t)?t:[]}function xo(t){return"function"==typeof t?t:ac}function Oo(t,e){return Wu(t)?t:Pi(t,e)?[t]:zi(xa(t))}var Po=Zr;function So(t,e,n){var r=t.length;return n=n===i?r:n,!e&&n>=r?t:uo(t,e,n)}var To=pe||function(t){return ye.clearTimeout(t)};function Ao(t,e){if(e)return t.slice();var n=t.length,r=Ht?Ht(n):new t.constructor(n);return t.copy(r),r}function jo(t){var e=new t.constructor(t.byteLength);return new Yt(e).set(new Yt(t)),e}function Ro(t,e){var n=e?jo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function No(t,e){if(t!==e){var n=t!==i,r=null===t,o=t==t,u=pa(t),a=e!==i,c=null===e,f=e==e,l=pa(e);if(!c&&!l&&!u&&t>e||u&&a&&f&&!c&&!l||r&&a&&f||!n&&f||!o)return 1;if(!r&&!u&&!l&&t<e||l&&n&&o&&!r&&!u||c&&n&&o||!a&&o||!f)return-1}return 0}function Fo(t,e,n,o){for(var i=-1,u=t.length,a=n.length,c=-1,f=e.length,l=wn(u-a,0),s=r(f+l),p=!o;++c<f;)s[c]=e[c];for(;++i<a;)(p||i<u)&&(s[n[i]]=t[i]);for(;l--;)s[c++]=t[i++];return s}function Eo(t,e,n,o){for(var i=-1,u=t.length,a=-1,c=n.length,f=-1,l=e.length,s=wn(u-c,0),p=r(s+l),h=!o;++i<s;)p[i]=t[i];for(var y=i;++f<l;)p[y+f]=e[f];for(;++a<c;)(h||i<u)&&(p[y+n[a]]=t[i++]);return p}function Lo(t,e){var n=-1,o=t.length;for(e||(e=r(o));++n<o;)e[n]=t[n];return e}function ko(t,e,n,r){var o=!n;n||(n={});for(var u=-1,a=e.length;++u<a;){var c=e[u],f=r?r(n[c],t[c],c,n,t):i;f===i&&(f=t[c]),o?cr(n,c,f):or(n,c,f)}return n}function Co(t,e){return function(n,r){var o=Wu(n)?Ae:ur,i=e?e():{};return o(n,t,pi(r,2),i)}}function Io(t){return Zr((function(e,n){var r=-1,o=n.length,u=o>1?n[o-1]:i,a=o>2?n[2]:i;for(u=t.length>3&&"function"==typeof u?(o--,u):i,a&&Oi(n[0],n[1],a)&&(u=o<3?i:u,o=1),e=jt(e);++r<o;){var c=n[r];c&&t(e,c,r,u)}return e}))}function Uo(t,e){return function(n,r){if(null==n)return n;if(!qu(n))return t(n,r);for(var o=n.length,i=e?o:-1,u=jt(n);(e?i--:++i<o)&&!1!==r(u[i],i,u););return n}}function Do(t){return function(e,n,r){for(var o=-1,i=jt(e),u=r(e),a=u.length;a--;){var c=u[t?a:++o];if(!1===n(i[c],c,i))break}return e}}function Mo(t){return function(e){var n=cn(e=xa(e))?dn(e):i,r=n?n[0]:e.charAt(0),o=n?So(n,1).join(""):e.slice(1);return r[t]()+o}}function zo(t){return function(e){return Ie(ec(Ha(e).replace(Zt,"")),t,"")}}function Bo(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Qn(t.prototype),r=t.apply(n,e);return oa(r)?r:n}}function Xo(t){return function(e,n,r){var o=jt(e);if(!qu(e)){var u=pi(n,3);e=Ca(e),n=function(t){return u(o[t],t,o)}}var a=t(e,n,r);return a>-1?o[u?e[a]:a]:i}}function Jo(t){return ui((function(e){var n=e.length,r=n,o=Yn.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new Ft(u);if(o&&!c&&"wrapper"==li(a))var c=new Yn([],!0)}for(r=c?r:n;++r<n;){var f=li(a=e[r]),l="wrapper"==f?fi(a):i;c=l&&Si(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?c[li(l[0])].apply(c,l[3]):1==a.length&&Si(a)?c[f]():c.thru(a)}return function(){var t=arguments,r=t[0];if(c&&1==t.length&&Wu(r))return c.plant(r).value();for(var o=0,i=n?e[o].apply(this,t):r;++o<n;)i=e[o].call(this,i);return i}}))}function Qo(t,e,n,o,u,a,c,f,l,s){var h=e&p,y=1&e,d=2&e,v=24&e,b=512&e,m=d?i:Bo(t);return function i(){for(var p=arguments.length,g=r(p),_=p;_--;)g[_]=arguments[_];if(v)var w=si(i),x=rn(g,w);if(o&&(g=Fo(g,o,u,v)),a&&(g=Eo(g,a,c,v)),p-=x,v&&p<s){var O=sn(g,w);return Ko(t,e,Qo,i.placeholder,n,g,O,f,l,s-p)}var P=y?n:this,S=d?P[t]:t;return p=g.length,f?g=Ei(g,f):b&&p>1&&g.reverse(),h&&l<p&&(g.length=l),this&&this!==ye&&this instanceof i&&(S=m||Bo(S)),S.apply(P,g)}}function Vo(t,e){return function(n,r){return function(t,e,n,r){return Or(t,(function(t,o,i){e(r,n(t),o,i)})),r}(n,t,e(r),{})}}function Yo(t,e){return function(n,r){var o;if(n===i&&r===i)return e;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=po(n),r=po(r)):(n=so(n),r=so(r)),o=t(n,r)}return o}}function Ho(t){return ui((function(e){return e=ke(e,$e(pi())),Zr((function(n){var r=this;return t(e,(function(t){return Te(t,r,n)}))}))}))}function Wo(t,e){var n=(e=e===i?" ":po(e)).length;if(n<2)return n?$r(e,t):e;var r=$r(e,ve(t/yn(e)));return cn(e)?So(dn(r),0,t).join(""):r.slice(0,t)}function Go(t){return function(e,n,o){return o&&"number"!=typeof o&&Oi(e,n,o)&&(n=o=i),e=ba(e),n===i?(n=e,e=0):n=ba(n),function(t,e,n,o){for(var i=-1,u=wn(ve((e-t)/(n||1)),0),a=r(u);u--;)a[o?u:++i]=t,t+=n;return a}(e,n,o=o===i?e<n?1:-1:ba(o),t)}}function qo(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=_a(e),n=_a(n)),t(e,n)}}function Ko(t,e,n,r,o,u,a,c,f,p){var h=8&e;e|=h?l:s,4&(e&=~(h?s:l))||(e&=-4);var y=[t,e,o,h?u:i,h?a:i,h?i:u,h?i:a,c,f,p],d=n.apply(i,y);return Si(t)&&ki(d,y),d.placeholder=r,Ui(d,t,e)}function $o(t){var e=At[t];return function(t,n){if(t=_a(t),(n=null==n?0:xn(ma(n),292))&&He(t)){var r=(xa(t)+"e").split("e");return+((r=(xa(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Zo=Nn&&1/pn(new Nn([,-0]))[1]==y?function(t){return new Nn(t)}:pc;function ti(t){return function(e){var n=mi(e);return n==T?fn(e):n==F?hn(e):function(t,e){return ke(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function ei(t,e,n,o,a,y,d,v){var b=2&e;if(!b&&"function"!=typeof t)throw new Ft(u);var m=o?o.length:0;if(m||(e&=-97,o=a=i),d=d===i?d:wn(ma(d),0),v=v===i?v:ma(v),m-=a?a.length:0,e&s){var g=o,_=a;o=a=i}var w=b?i:fi(t),x=[t,e,n,o,a,g,_,y,d,v];if(w&&function(t,e){var n=t[1],r=e[1],o=n|r,i=o<131,u=r==p&&8==n||r==p&&n==h&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!i&&!u)return t;1&r&&(t[2]=e[2],o|=1&n?0:4);var a=e[3];if(a){var f=t[3];t[3]=f?Fo(f,a,e[4]):a,t[4]=f?sn(t[3],c):e[4]}(a=e[5])&&(f=t[5],t[5]=f?Eo(f,a,e[6]):a,t[6]=f?sn(t[5],c):e[6]);(a=e[7])&&(t[7]=a);r&p&&(t[8]=null==t[8]?e[8]:xn(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=o}(x,w),t=x[0],e=x[1],n=x[2],o=x[3],a=x[4],!(v=x[9]=x[9]===i?b?0:t.length:wn(x[9]-m,0))&&24&e&&(e&=-25),e&&1!=e)O=8==e||e==f?function(t,e,n){var o=Bo(t);return function u(){for(var a=arguments.length,c=r(a),f=a,l=si(u);f--;)c[f]=arguments[f];var s=a<3&&c[0]!==l&&c[a-1]!==l?[]:sn(c,l);return(a-=s.length)<n?Ko(t,e,Qo,u.placeholder,i,c,s,i,i,n-a):Te(this&&this!==ye&&this instanceof u?o:t,this,c)}}(t,e,v):e!=l&&33!=e||a.length?Qo.apply(i,x):function(t,e,n,o){var i=1&e,u=Bo(t);return function e(){for(var a=-1,c=arguments.length,f=-1,l=o.length,s=r(l+c),p=this&&this!==ye&&this instanceof e?u:t;++f<l;)s[f]=o[f];for(;c--;)s[f++]=arguments[++a];return Te(p,i?n:this,s)}}(t,e,n,o);else var O=function(t,e,n){var r=1&e,o=Bo(t);return function e(){return(this&&this!==ye&&this instanceof e?o:t).apply(r?n:this,arguments)}}(t,e,n);return Ui((w?ro:ki)(O,x),t,e)}function ni(t,e,n,r){return t===i||Qu(t,kt[n])&&!Ut.call(r,n)?e:t}function ri(t,e,n,r,o,u){return oa(t)&&oa(e)&&(u.set(e,t),Vr(t,e,i,ri,u),u.delete(e)),t}function oi(t){return ca(t)?i:t}function ii(t,e,n,r,o,u){var a=1&n,c=t.length,f=e.length;if(c!=f&&!(a&&f>c))return!1;var l=u.get(t),s=u.get(e);if(l&&s)return l==e&&s==t;var p=-1,h=!0,y=2&n?new Kn:i;for(u.set(t,e),u.set(e,t);++p<c;){var d=t[p],v=e[p];if(r)var b=a?r(v,d,p,e,t,u):r(d,v,p,t,e,u);if(b!==i){if(b)continue;h=!1;break}if(y){if(!De(e,(function(t,e){if(!tn(y,e)&&(d===t||o(d,t,n,r,u)))return y.push(e)}))){h=!1;break}}else if(d!==v&&!o(d,v,n,r,u)){h=!1;break}}return u.delete(t),u.delete(e),h}function ui(t){return Ii(Ni(t,i,Gi),t+"")}function ai(t){return Ar(t,Ca,vi)}function ci(t){return Ar(t,Ia,bi)}var fi=Ln?function(t){return Ln.get(t)}:pc;function li(t){for(var e=t.name+"",n=kn[e],r=Ut.call(kn,e)?n.length:0;r--;){var o=n[r],i=o.func;if(null==i||i==t)return o.name}return e}function si(t){return(Ut.call(Jn,"placeholder")?Jn:t).placeholder}function pi(){var t=Jn.iteratee||cc;return t=t===cc?Dr:t,arguments.length?t(arguments[0],arguments[1]):t}function hi(t,e){var n,r,i=t.__data__;return("string"==(r=o(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function yi(t){for(var e=Ca(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,ji(o)]}return e}function di(t,e){var n=function(t,e){return null==t?i:t[e]}(t,e);return Ur(n)?n:i}var vi=ge?function(t){return null==t?[]:(t=jt(t),Fe(ge(t),(function(e){return qt.call(t,e)})))}:gc,bi=ge?function(t){for(var e=[];t;)Ce(e,vi(t)),t=Wt(t);return e}:gc,mi=jr;function gi(t,e,n){for(var r=-1,o=(e=Oo(e,t)).length,i=!1;++r<o;){var u=Bi(e[r]);if(!(i=null!=t&&n(t,u)))break;t=t[u]}return i||++r!=o?i:!!(o=null==t?0:t.length)&&ra(o)&&xi(u,o)&&(Wu(t)||Hu(t))}function _i(t){return"function"!=typeof t.constructor||Ai(t)?{}:Qn(Wt(t))}function wi(t){return Wu(t)||Hu(t)||!!($t&&t&&t[$t])}function xi(t,e){var n=o(t);return!!(e=null==e?d:e)&&("number"==n||"symbol"!=n&&wt.test(t))&&t>-1&&t%1==0&&t<e}function Oi(t,e,n){if(!oa(n))return!1;var r=o(e);return!!("number"==r?qu(n)&&xi(e,n.length):"string"==r&&e in n)&&Qu(n[e],t)}function Pi(t,e){if(Wu(t))return!1;var n=o(t);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!pa(t))||(rt.test(t)||!nt.test(t)||null!=e&&t in jt(e))}function Si(t){var e=li(t),n=Jn[e];if("function"!=typeof n||!(e in Hn.prototype))return!1;if(t===n)return!0;var r=fi(n);return!!r&&t===r[0]}(An&&mi(new An(new ArrayBuffer(1)))!=I||jn&&mi(new jn)!=T||Rn&&mi(Rn.resolve())!=R||Nn&&mi(new Nn)!=F||Fn&&mi(new Fn)!=k)&&(mi=function(t){var e=jr(t),n=e==j?t.constructor:i,r=n?Xi(n):"";if(r)switch(r){case Cn:return I;case In:return T;case Un:return R;case Dn:return F;case Mn:return k}return e});var Ti=Ct?ea:_c;function Ai(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||kt)}function ji(t){return t==t&&!oa(t)}function Ri(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==i||t in jt(n)))}}function Ni(t,e,n){return e=wn(e===i?t.length-1:e,0),function(){for(var o=arguments,i=-1,u=wn(o.length-e,0),a=r(u);++i<u;)a[i]=o[e+i];i=-1;for(var c=r(e+1);++i<e;)c[i]=o[i];return c[e]=n(a),Te(t,this,c)}}function Fi(t,e){return e.length<2?t:Tr(t,uo(e,0,-1))}function Ei(t,e){for(var n=t.length,r=xn(e.length,n),o=Lo(t);r--;){var u=e[r];t[r]=xi(u,n)?o[u]:i}return t}function Li(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var ki=Di(ro),Ci=de||function(t,e){return ye.setTimeout(t,e)},Ii=Di(oo);function Ui(t,e,n){var r=e+"";return Ii(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(ft,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return je(m,(function(n){var r="_."+n[0];e&n[1]&&!Ee(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(lt);return e?e[1].split(st):[]}(r),n)))}function Di(t){var e=0,n=0;return function(){var r=On(),o=16-(r-n);if(n=r,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(i,arguments)}}function Mi(t,e){var n=-1,r=t.length,o=r-1;for(e=e===i?r:e;++n<e;){var u=Kr(n,o),a=t[u];t[u]=t[n],t[n]=a}return t.length=e,t}var zi=function(t){var e=Du(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ot,(function(t,n,r,o){e.push(r?o.replace(yt,"$1"):n||t)})),e}));function Bi(t){if("string"==typeof t||pa(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Xi(t){if(null!=t){try{return It.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ji(t){if(t instanceof Hn)return t.clone();var e=new Yn(t.__wrapped__,t.__chain__);return e.__actions__=Lo(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Qi=Zr((function(t,e){return Ku(t)?yr(t,_r(e,1,Ku,!0)):[]})),Vi=Zr((function(t,e){var n=tu(e);return Ku(n)&&(n=i),Ku(t)?yr(t,_r(e,1,Ku,!0),pi(n,2)):[]})),Yi=Zr((function(t,e){var n=tu(e);return Ku(n)&&(n=i),Ku(t)?yr(t,_r(e,1,Ku,!0),i,n):[]}));function Hi(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ma(n);return o<0&&(o=wn(r+o,0)),Be(t,pi(e,3),o)}function Wi(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r-1;return n!==i&&(o=ma(n),o=n<0?wn(r+o,0):xn(o,r-1)),Be(t,pi(e,3),o,!0)}function Gi(t){return(null==t?0:t.length)?_r(t,1):[]}function qi(t){return t&&t.length?t[0]:i}var Ki=Zr((function(t){var e=ke(t,wo);return e.length&&e[0]===t[0]?Er(e):[]})),$i=Zr((function(t){var e=tu(t),n=ke(t,wo);return e===tu(n)?e=i:n.pop(),n.length&&n[0]===t[0]?Er(n,pi(e,2)):[]})),Zi=Zr((function(t){var e=tu(t),n=ke(t,wo);return(e="function"==typeof e?e:i)&&n.pop(),n.length&&n[0]===t[0]?Er(n,i,e):[]}));function tu(t){var e=null==t?0:t.length;return e?t[e-1]:i}var eu=Zr(nu);function nu(t,e){return t&&t.length&&e&&e.length?Gr(t,e):t}var ru=ui((function(t,e){var n=null==t?0:t.length,r=fr(t,e);return qr(t,ke(e,(function(t){return xi(t,n)?+t:t})).sort(No)),r}));function ou(t){return null==t?t:Tn.call(t)}var iu=Zr((function(t){return ho(_r(t,1,Ku,!0))})),uu=Zr((function(t){var e=tu(t);return Ku(e)&&(e=i),ho(_r(t,1,Ku,!0),pi(e,2))})),au=Zr((function(t){var e=tu(t);return e="function"==typeof e?e:i,ho(_r(t,1,Ku,!0),i,e)}));function cu(t){if(!t||!t.length)return[];var e=0;return t=Fe(t,(function(t){if(Ku(t))return e=wn(t.length,e),!0})),qe(e,(function(e){return ke(t,Ye(e))}))}function fu(t,e){if(!t||!t.length)return[];var n=cu(t);return null==e?n:ke(n,(function(t){return Te(e,i,t)}))}var lu=Zr((function(t,e){return Ku(t)?yr(t,e):[]})),su=Zr((function(t){return go(Fe(t,Ku))})),pu=Zr((function(t){var e=tu(t);return Ku(e)&&(e=i),go(Fe(t,Ku),pi(e,2))})),hu=Zr((function(t){var e=tu(t);return e="function"==typeof e?e:i,go(Fe(t,Ku),i,e)})),yu=Zr(cu);var du=Zr((function(t){var e=t.length,n=e>1?t[e-1]:i;return n="function"==typeof n?(t.pop(),n):i,fu(t,n)}));function vu(t){var e=Jn(t);return e.__chain__=!0,e}function bu(t,e){return e(t)}var mu=ui((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,o=function(e){return fr(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Hn&&xi(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:bu,args:[o],thisArg:i}),new Yn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(i),t}))):this.thru(o)}));var gu=Co((function(t,e,n){Ut.call(t,n)?++t[n]:cr(t,n,1)}));var _u=Xo(Hi),wu=Xo(Wi);function xu(t,e){return(Wu(t)?je:dr)(t,pi(e,3))}function Ou(t,e){return(Wu(t)?Re:vr)(t,pi(e,3))}var Pu=Co((function(t,e,n){Ut.call(t,n)?t[n].push(e):cr(t,n,[e])}));var Su=Zr((function(t,e,n){var o=-1,i="function"==typeof e,u=qu(t)?r(t.length):[];return dr(t,(function(t){u[++o]=i?Te(e,t,n):Lr(t,e,n)})),u})),Tu=Co((function(t,e,n){cr(t,n,e)}));function Au(t,e){return(Wu(t)?ke:Xr)(t,pi(e,3))}var ju=Co((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var Ru=Zr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&Oi(t,e[0],e[1])?e=[]:n>2&&Oi(e[0],e[1],e[2])&&(e=[e[0]]),Hr(t,_r(e,1),[])})),Nu=he||function(){return ye.Date.now()};function Fu(t,e,n){return e=n?i:e,e=t&&null==e?t.length:e,ei(t,p,i,i,i,i,e)}function Eu(t,e){var n;if("function"!=typeof e)throw new Ft(u);return t=ma(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=i),n}}var Lu=Zr((function(t,e,n){var r=1;if(n.length){var o=sn(n,si(Lu));r|=l}return ei(t,r,e,n,o)})),ku=Zr((function(t,e,n){var r=3;if(n.length){var o=sn(n,si(ku));r|=l}return ei(e,r,t,n,o)}));function Cu(t,e,n){var r,o,a,c,f,l,s=0,p=!1,h=!1,y=!0;if("function"!=typeof t)throw new Ft(u);function d(e){var n=r,u=o;return r=o=i,s=e,c=t.apply(u,n)}function v(t){return s=t,f=Ci(m,e),p?d(t):c}function b(t){var n=t-l;return l===i||n>=e||n<0||h&&t-s>=a}function m(){var t=Nu();if(b(t))return g(t);f=Ci(m,function(t){var n=e-(t-l);return h?xn(n,a-(t-s)):n}(t))}function g(t){return f=i,y&&r?d(t):(r=o=i,c)}function _(){var t=Nu(),n=b(t);if(r=arguments,o=this,l=t,n){if(f===i)return v(l);if(h)return To(f),f=Ci(m,e),d(l)}return f===i&&(f=Ci(m,e)),c}return e=_a(e)||0,oa(n)&&(p=!!n.leading,a=(h="maxWait"in n)?wn(_a(n.maxWait)||0,e):a,y="trailing"in n?!!n.trailing:y),_.cancel=function(){f!==i&&To(f),s=0,r=l=o=f=i},_.flush=function(){return f===i?c:g(Nu())},_}var Iu=Zr((function(t,e){return hr(t,1,e)})),Uu=Zr((function(t,e,n){return hr(t,_a(e)||0,n)}));function Du(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Ft(u);var n=function n(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var u=t.apply(this,r);return n.cache=i.set(o,u)||i,u};return n.cache=new(Du.Cache||qn),n}function Mu(t){if("function"!=typeof t)throw new Ft(u);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Du.Cache=qn;var zu=Po((function(t,e){var n=(e=1==e.length&&Wu(e[0])?ke(e[0],$e(pi())):ke(_r(e,1),$e(pi()))).length;return Zr((function(r){for(var o=-1,i=xn(r.length,n);++o<i;)r[o]=e[o].call(this,r[o]);return Te(t,this,r)}))})),Bu=Zr((function(t,e){var n=sn(e,si(Bu));return ei(t,l,i,e,n)})),Xu=Zr((function(t,e){var n=sn(e,si(Xu));return ei(t,s,i,e,n)})),Ju=ui((function(t,e){return ei(t,h,i,i,i,e)}));function Qu(t,e){return t===e||t!=t&&e!=e}var Vu=qo(Rr),Yu=qo((function(t,e){return t>=e})),Hu=kr(function(){return arguments}())?kr:function(t){return ia(t)&&Ut.call(t,"callee")&&!qt.call(t,"callee")},Wu=r.isArray,Gu=_e?$e(_e):function(t){return ia(t)&&jr(t)==C};function qu(t){return null!=t&&ra(t.length)&&!ea(t)}function Ku(t){return ia(t)&&qu(t)}var $u=Me||_c,Zu=we?$e(we):function(t){return ia(t)&&jr(t)==x};function ta(t){if(!ia(t))return!1;var e=jr(t);return e==O||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ca(t)}function ea(t){if(!oa(t))return!1;var e=jr(t);return e==P||e==S||"[object AsyncFunction]"==e||"[object Proxy]"==e}function na(t){return"number"==typeof t&&t==ma(t)}function ra(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=d}function oa(t){var e=o(t);return null!=t&&("object"==e||"function"==e)}function ia(t){return null!=t&&"object"==o(t)}var ua=xe?$e(xe):function(t){return ia(t)&&mi(t)==T};function aa(t){return"number"==typeof t||ia(t)&&jr(t)==A}function ca(t){if(!ia(t)||jr(t)!=j)return!1;var e=Wt(t);if(null===e)return!0;var n=Ut.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&It.call(n)==Bt}var fa=Oe?$e(Oe):function(t){return ia(t)&&jr(t)==N};var la=Pe?$e(Pe):function(t){return ia(t)&&mi(t)==F};function sa(t){return"string"==typeof t||!Wu(t)&&ia(t)&&jr(t)==E}function pa(t){return"symbol"==o(t)||ia(t)&&jr(t)==L}var ha=Se?$e(Se):function(t){return ia(t)&&ra(t.length)&&!!ae[jr(t)]};var ya=qo(Br),da=qo((function(t,e){return t<=e}));function va(t){if(!t)return[];if(qu(t))return sa(t)?dn(t):Lo(t);if(ee&&t[ee])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[ee]());var e=mi(t);return(e==T?fn:e==F?pn:Qa)(t)}function ba(t){return t?(t=_a(t))===y||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ma(t){var e=ba(t),n=e%1;return e==e?n?e-n:e:0}function ga(t){return t?lr(ma(t),0,b):0}function _a(t){if("number"==typeof t)return t;if(pa(t))return v;if(oa(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=oa(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ke(t);var n=mt.test(t);return n||_t.test(t)?se(t.slice(2),n?2:8):bt.test(t)?v:+t}function wa(t){return ko(t,Ia(t))}function xa(t){return null==t?"":po(t)}var Oa=Io((function(t,e){if(Ai(e)||qu(e))ko(e,Ca(e),t);else for(var n in e)Ut.call(e,n)&&or(t,n,e[n])})),Pa=Io((function(t,e){ko(e,Ia(e),t)})),Sa=Io((function(t,e,n,r){ko(e,Ia(e),t,r)})),Ta=Io((function(t,e,n,r){ko(e,Ca(e),t,r)})),Aa=ui(fr);var ja=Zr((function(t,e){t=jt(t);var n=-1,r=e.length,o=r>2?e[2]:i;for(o&&Oi(e[0],e[1],o)&&(r=1);++n<r;)for(var u=e[n],a=Ia(u),c=-1,f=a.length;++c<f;){var l=a[c],s=t[l];(s===i||Qu(s,kt[l])&&!Ut.call(t,l))&&(t[l]=u[l])}return t})),Ra=Zr((function(t){return t.push(i,ri),Te(Da,i,t)}));function Na(t,e,n){var r=null==t?i:Tr(t,e);return r===i?n:r}function Fa(t,e){return null!=t&&gi(t,e,Fr)}var Ea=Vo((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=zt.call(e)),t[e]=n}),oc(ac)),La=Vo((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=zt.call(e)),Ut.call(t,e)?t[e].push(n):t[e]=[n]}),pi),ka=Zr(Lr);function Ca(t){return qu(t)?Zn(t):Mr(t)}function Ia(t){return qu(t)?Zn(t,!0):zr(t)}var Ua=Io((function(t,e,n){Vr(t,e,n)})),Da=Io((function(t,e,n,r){Vr(t,e,n,r)})),Ma=ui((function(t,e){var n={};if(null==t)return n;var r=!1;e=ke(e,(function(e){return e=Oo(e,t),r||(r=e.length>1),e})),ko(t,ci(t),n),r&&(n=sr(n,7,oi));for(var o=e.length;o--;)yo(n,e[o]);return n}));var za=ui((function(t,e){return null==t?{}:function(t,e){return Wr(t,e,(function(e,n){return Fa(t,n)}))}(t,e)}));function Ba(t,e){if(null==t)return{};var n=ke(ci(t),(function(t){return[t]}));return e=pi(e),Wr(t,n,(function(t,n){return e(t,n[0])}))}var Xa=ti(Ca),Ja=ti(Ia);function Qa(t){return null==t?[]:Ze(t,Ca(t))}var Va=zo((function(t,e,n){return e=e.toLowerCase(),t+(n?Ya(e):e)}));function Ya(t){return tc(xa(t).toLowerCase())}function Ha(t){return(t=xa(t))&&t.replace(xt,on).replace(te,"")}var Wa=zo((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Ga=zo((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),qa=Mo("toLowerCase");var Ka=zo((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var $a=zo((function(t,e,n){return t+(n?" ":"")+tc(e)}));var Za=zo((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),tc=Mo("toUpperCase");function ec(t,e,n){return t=xa(t),(e=n?i:e)===i?function(t){return oe.test(t)}(t)?function(t){return t.match(ne)||[]}(t):function(t){return t.match(pt)||[]}(t):t.match(e)||[]}var nc=Zr((function(t,e){try{return Te(t,i,e)}catch(t){return ta(t)?t:new St(t)}})),rc=ui((function(t,e){return je(e,(function(e){e=Bi(e),cr(t,e,Lu(t[e],t))})),t}));function oc(t){return function(){return t}}var ic=Jo(),uc=Jo(!0);function ac(t){return t}function cc(t){return Dr("function"==typeof t?t:sr(t,1))}var fc=Zr((function(t,e){return function(n){return Lr(n,t,e)}})),lc=Zr((function(t,e){return function(n){return Lr(t,n,e)}}));function sc(t,e,n){var r=Ca(e),o=Sr(e,r);null!=n||oa(e)&&(o.length||!r.length)||(n=e,e=t,t=this,o=Sr(e,Ca(e)));var i=!(oa(n)&&"chain"in n&&!n.chain),u=ea(t);return je(o,(function(n){var r=e[n];t[n]=r,u&&(t.prototype[n]=function(){var e=this.__chain__;if(i||e){var n=t(this.__wrapped__),o=n.__actions__=Lo(this.__actions__);return o.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Ce([this.value()],arguments))})})),t}function pc(){}var hc=Ho(ke),yc=Ho(Ne),dc=Ho(De);function vc(t){return Pi(t)?Ye(Bi(t)):function(t){return function(e){return Tr(e,t)}}(t)}var bc=Go(),mc=Go(!0);function gc(){return[]}function _c(){return!1}var wc=Yo((function(t,e){return t+e}),0),xc=$o("ceil"),Oc=Yo((function(t,e){return t/e}),1),Pc=$o("floor");var Sc,Tc=Yo((function(t,e){return t*e}),1),Ac=$o("round"),jc=Yo((function(t,e){return t-e}),0);return Jn.after=function(t,e){if("function"!=typeof e)throw new Ft(u);return t=ma(t),function(){if(--t<1)return e.apply(this,arguments)}},Jn.ary=Fu,Jn.assign=Oa,Jn.assignIn=Pa,Jn.assignInWith=Sa,Jn.assignWith=Ta,Jn.at=Aa,Jn.before=Eu,Jn.bind=Lu,Jn.bindAll=rc,Jn.bindKey=ku,Jn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Wu(t)?t:[t]},Jn.chain=vu,Jn.chunk=function(t,e,n){e=(n?Oi(t,e,n):e===i)?1:wn(ma(e),0);var o=null==t?0:t.length;if(!o||e<1)return[];for(var u=0,a=0,c=r(ve(o/e));u<o;)c[a++]=uo(t,u,u+=e);return c},Jn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,o=[];++e<n;){var i=t[e];i&&(o[r++]=i)}return o},Jn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return Ce(Wu(n)?Lo(n):[n],_r(e,1))},Jn.cond=function(t){var e=null==t?0:t.length,n=pi();return t=e?ke(t,(function(t){if("function"!=typeof t[1])throw new Ft(u);return[n(t[0]),t[1]]})):[],Zr((function(n){for(var r=-1;++r<e;){var o=t[r];if(Te(o[0],this,n))return Te(o[1],this,n)}}))},Jn.conforms=function(t){return function(t){var e=Ca(t);return function(n){return pr(n,t,e)}}(sr(t,1))},Jn.constant=oc,Jn.countBy=gu,Jn.create=function(t,e){var n=Qn(t);return null==e?n:ar(n,e)},Jn.curry=function t(e,n,r){var o=ei(e,8,i,i,i,i,i,n=r?i:n);return o.placeholder=t.placeholder,o},Jn.curryRight=function t(e,n,r){var o=ei(e,f,i,i,i,i,i,n=r?i:n);return o.placeholder=t.placeholder,o},Jn.debounce=Cu,Jn.defaults=ja,Jn.defaultsDeep=Ra,Jn.defer=Iu,Jn.delay=Uu,Jn.difference=Qi,Jn.differenceBy=Vi,Jn.differenceWith=Yi,Jn.drop=function(t,e,n){var r=null==t?0:t.length;return r?uo(t,(e=n||e===i?1:ma(e))<0?0:e,r):[]},Jn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?uo(t,0,(e=r-(e=n||e===i?1:ma(e)))<0?0:e):[]},Jn.dropRightWhile=function(t,e){return t&&t.length?bo(t,pi(e,3),!0,!0):[]},Jn.dropWhile=function(t,e){return t&&t.length?bo(t,pi(e,3),!0):[]},Jn.fill=function(t,e,n,r){var o=null==t?0:t.length;return o?(n&&"number"!=typeof n&&Oi(t,e,n)&&(n=0,r=o),function(t,e,n,r){var o=t.length;for((n=ma(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:ma(r))<0&&(r+=o),r=n>r?0:ga(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Jn.filter=function(t,e){return(Wu(t)?Fe:gr)(t,pi(e,3))},Jn.flatMap=function(t,e){return _r(Au(t,e),1)},Jn.flatMapDeep=function(t,e){return _r(Au(t,e),y)},Jn.flatMapDepth=function(t,e,n){return n=n===i?1:ma(n),_r(Au(t,e),n)},Jn.flatten=Gi,Jn.flattenDeep=function(t){return(null==t?0:t.length)?_r(t,y):[]},Jn.flattenDepth=function(t,e){return(null==t?0:t.length)?_r(t,e=e===i?1:ma(e)):[]},Jn.flip=function(t){return ei(t,512)},Jn.flow=ic,Jn.flowRight=uc,Jn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var o=t[e];r[o[0]]=o[1]}return r},Jn.functions=function(t){return null==t?[]:Sr(t,Ca(t))},Jn.functionsIn=function(t){return null==t?[]:Sr(t,Ia(t))},Jn.groupBy=Pu,Jn.initial=function(t){return(null==t?0:t.length)?uo(t,0,-1):[]},Jn.intersection=Ki,Jn.intersectionBy=$i,Jn.intersectionWith=Zi,Jn.invert=Ea,Jn.invertBy=La,Jn.invokeMap=Su,Jn.iteratee=cc,Jn.keyBy=Tu,Jn.keys=Ca,Jn.keysIn=Ia,Jn.map=Au,Jn.mapKeys=function(t,e){var n={};return e=pi(e,3),Or(t,(function(t,r,o){cr(n,e(t,r,o),t)})),n},Jn.mapValues=function(t,e){var n={};return e=pi(e,3),Or(t,(function(t,r,o){cr(n,r,e(t,r,o))})),n},Jn.matches=function(t){return Jr(sr(t,1))},Jn.matchesProperty=function(t,e){return Qr(t,sr(e,1))},Jn.memoize=Du,Jn.merge=Ua,Jn.mergeWith=Da,Jn.method=fc,Jn.methodOf=lc,Jn.mixin=sc,Jn.negate=Mu,Jn.nthArg=function(t){return t=ma(t),Zr((function(e){return Yr(e,t)}))},Jn.omit=Ma,Jn.omitBy=function(t,e){return Ba(t,Mu(pi(e)))},Jn.once=function(t){return Eu(2,t)},Jn.orderBy=function(t,e,n,r){return null==t?[]:(Wu(e)||(e=null==e?[]:[e]),Wu(n=r?i:n)||(n=null==n?[]:[n]),Hr(t,e,n))},Jn.over=hc,Jn.overArgs=zu,Jn.overEvery=yc,Jn.overSome=dc,Jn.partial=Bu,Jn.partialRight=Xu,Jn.partition=ju,Jn.pick=za,Jn.pickBy=Ba,Jn.property=vc,Jn.propertyOf=function(t){return function(e){return null==t?i:Tr(t,e)}},Jn.pull=eu,Jn.pullAll=nu,Jn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Gr(t,e,pi(n,2)):t},Jn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Gr(t,e,i,n):t},Jn.pullAt=ru,Jn.range=bc,Jn.rangeRight=mc,Jn.rearg=Ju,Jn.reject=function(t,e){return(Wu(t)?Fe:gr)(t,Mu(pi(e,3)))},Jn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,o=[],i=t.length;for(e=pi(e,3);++r<i;){var u=t[r];e(u,r,t)&&(n.push(u),o.push(r))}return qr(t,o),n},Jn.rest=function(t,e){if("function"!=typeof t)throw new Ft(u);return Zr(t,e=e===i?e:ma(e))},Jn.reverse=ou,Jn.sampleSize=function(t,e,n){return e=(n?Oi(t,e,n):e===i)?1:ma(e),(Wu(t)?er:eo)(t,e)},Jn.set=function(t,e,n){return null==t?t:no(t,e,n)},Jn.setWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:no(t,e,n,r)},Jn.shuffle=function(t){return(Wu(t)?nr:io)(t)},Jn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&Oi(t,e,n)?(e=0,n=r):(e=null==e?0:ma(e),n=n===i?r:ma(n)),uo(t,e,n)):[]},Jn.sortBy=Ru,Jn.sortedUniq=function(t){return t&&t.length?lo(t):[]},Jn.sortedUniqBy=function(t,e){return t&&t.length?lo(t,pi(e,2)):[]},Jn.split=function(t,e,n){return n&&"number"!=typeof n&&Oi(t,e,n)&&(e=n=i),(n=n===i?b:n>>>0)?(t=xa(t))&&("string"==typeof e||null!=e&&!fa(e))&&!(e=po(e))&&cn(t)?So(dn(t),0,n):t.split(e,n):[]},Jn.spread=function(t,e){if("function"!=typeof t)throw new Ft(u);return e=null==e?0:wn(ma(e),0),Zr((function(n){var r=n[e],o=So(n,0,e);return r&&Ce(o,r),Te(t,this,o)}))},Jn.tail=function(t){var e=null==t?0:t.length;return e?uo(t,1,e):[]},Jn.take=function(t,e,n){return t&&t.length?uo(t,0,(e=n||e===i?1:ma(e))<0?0:e):[]},Jn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?uo(t,(e=r-(e=n||e===i?1:ma(e)))<0?0:e,r):[]},Jn.takeRightWhile=function(t,e){return t&&t.length?bo(t,pi(e,3),!1,!0):[]},Jn.takeWhile=function(t,e){return t&&t.length?bo(t,pi(e,3)):[]},Jn.tap=function(t,e){return e(t),t},Jn.throttle=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new Ft(u);return oa(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Cu(t,e,{leading:r,maxWait:e,trailing:o})},Jn.thru=bu,Jn.toArray=va,Jn.toPairs=Xa,Jn.toPairsIn=Ja,Jn.toPath=function(t){return Wu(t)?ke(t,Bi):pa(t)?[t]:Lo(zi(xa(t)))},Jn.toPlainObject=wa,Jn.transform=function(t,e,n){var r=Wu(t),o=r||$u(t)||ha(t);if(e=pi(e,4),null==n){var i=t&&t.constructor;n=o?r?new i:[]:oa(t)&&ea(i)?Qn(Wt(t)):{}}return(o?je:Or)(t,(function(t,r,o){return e(n,t,r,o)})),n},Jn.unary=function(t){return Fu(t,1)},Jn.union=iu,Jn.unionBy=uu,Jn.unionWith=au,Jn.uniq=function(t){return t&&t.length?ho(t):[]},Jn.uniqBy=function(t,e){return t&&t.length?ho(t,pi(e,2)):[]},Jn.uniqWith=function(t,e){return e="function"==typeof e?e:i,t&&t.length?ho(t,i,e):[]},Jn.unset=function(t,e){return null==t||yo(t,e)},Jn.unzip=cu,Jn.unzipWith=fu,Jn.update=function(t,e,n){return null==t?t:vo(t,e,xo(n))},Jn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:vo(t,e,xo(n),r)},Jn.values=Qa,Jn.valuesIn=function(t){return null==t?[]:Ze(t,Ia(t))},Jn.without=lu,Jn.words=ec,Jn.wrap=function(t,e){return Bu(xo(e),t)},Jn.xor=su,Jn.xorBy=pu,Jn.xorWith=hu,Jn.zip=yu,Jn.zipObject=function(t,e){return _o(t||[],e||[],or)},Jn.zipObjectDeep=function(t,e){return _o(t||[],e||[],no)},Jn.zipWith=du,Jn.entries=Xa,Jn.entriesIn=Ja,Jn.extend=Pa,Jn.extendWith=Sa,sc(Jn,Jn),Jn.add=wc,Jn.attempt=nc,Jn.camelCase=Va,Jn.capitalize=Ya,Jn.ceil=xc,Jn.clamp=function(t,e,n){return n===i&&(n=e,e=i),n!==i&&(n=(n=_a(n))==n?n:0),e!==i&&(e=(e=_a(e))==e?e:0),lr(_a(t),e,n)},Jn.clone=function(t){return sr(t,4)},Jn.cloneDeep=function(t){return sr(t,5)},Jn.cloneDeepWith=function(t,e){return sr(t,5,e="function"==typeof e?e:i)},Jn.cloneWith=function(t,e){return sr(t,4,e="function"==typeof e?e:i)},Jn.conformsTo=function(t,e){return null==e||pr(t,e,Ca(e))},Jn.deburr=Ha,Jn.defaultTo=function(t,e){return null==t||t!=t?e:t},Jn.divide=Oc,Jn.endsWith=function(t,e,n){t=xa(t),e=po(e);var r=t.length,o=n=n===i?r:lr(ma(n),0,r);return(n-=e.length)>=0&&t.slice(n,o)==e},Jn.eq=Qu,Jn.escape=function(t){return(t=xa(t))&&$.test(t)?t.replace(q,un):t},Jn.escapeRegExp=function(t){return(t=xa(t))&&ut.test(t)?t.replace(it,"\\$&"):t},Jn.every=function(t,e,n){var r=Wu(t)?Ne:br;return n&&Oi(t,e,n)&&(e=i),r(t,pi(e,3))},Jn.find=_u,Jn.findIndex=Hi,Jn.findKey=function(t,e){return ze(t,pi(e,3),Or)},Jn.findLast=wu,Jn.findLastIndex=Wi,Jn.findLastKey=function(t,e){return ze(t,pi(e,3),Pr)},Jn.floor=Pc,Jn.forEach=xu,Jn.forEachRight=Ou,Jn.forIn=function(t,e){return null==t?t:wr(t,pi(e,3),Ia)},Jn.forInRight=function(t,e){return null==t?t:xr(t,pi(e,3),Ia)},Jn.forOwn=function(t,e){return t&&Or(t,pi(e,3))},Jn.forOwnRight=function(t,e){return t&&Pr(t,pi(e,3))},Jn.get=Na,Jn.gt=Vu,Jn.gte=Yu,Jn.has=function(t,e){return null!=t&&gi(t,e,Nr)},Jn.hasIn=Fa,Jn.head=qi,Jn.identity=ac,Jn.includes=function(t,e,n,r){t=qu(t)?t:Qa(t),n=n&&!r?ma(n):0;var o=t.length;return n<0&&(n=wn(o+n,0)),sa(t)?n<=o&&t.indexOf(e,n)>-1:!!o&&Xe(t,e,n)>-1},Jn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=null==n?0:ma(n);return o<0&&(o=wn(r+o,0)),Xe(t,e,o)},Jn.inRange=function(t,e,n){return e=ba(e),n===i?(n=e,e=0):n=ba(n),function(t,e,n){return t>=xn(e,n)&&t<wn(e,n)}(t=_a(t),e,n)},Jn.invoke=ka,Jn.isArguments=Hu,Jn.isArray=Wu,Jn.isArrayBuffer=Gu,Jn.isArrayLike=qu,Jn.isArrayLikeObject=Ku,Jn.isBoolean=function(t){return!0===t||!1===t||ia(t)&&jr(t)==w},Jn.isBuffer=$u,Jn.isDate=Zu,Jn.isElement=function(t){return ia(t)&&1===t.nodeType&&!ca(t)},Jn.isEmpty=function(t){if(null==t)return!0;if(qu(t)&&(Wu(t)||"string"==typeof t||"function"==typeof t.splice||$u(t)||ha(t)||Hu(t)))return!t.length;var e=mi(t);if(e==T||e==F)return!t.size;if(Ai(t))return!Mr(t).length;for(var n in t)if(Ut.call(t,n))return!1;return!0},Jn.isEqual=function(t,e){return Cr(t,e)},Jn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:i)?n(t,e):i;return r===i?Cr(t,e,i,n):!!r},Jn.isError=ta,Jn.isFinite=function(t){return"number"==typeof t&&He(t)},Jn.isFunction=ea,Jn.isInteger=na,Jn.isLength=ra,Jn.isMap=ua,Jn.isMatch=function(t,e){return t===e||Ir(t,e,yi(e))},Jn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:i,Ir(t,e,yi(e),n)},Jn.isNaN=function(t){return aa(t)&&t!=+t},Jn.isNative=function(t){if(Ti(t))throw new St("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ur(t)},Jn.isNil=function(t){return null==t},Jn.isNull=function(t){return null===t},Jn.isNumber=aa,Jn.isObject=oa,Jn.isObjectLike=ia,Jn.isPlainObject=ca,Jn.isRegExp=fa,Jn.isSafeInteger=function(t){return na(t)&&t>=-9007199254740991&&t<=d},Jn.isSet=la,Jn.isString=sa,Jn.isSymbol=pa,Jn.isTypedArray=ha,Jn.isUndefined=function(t){return t===i},Jn.isWeakMap=function(t){return ia(t)&&mi(t)==k},Jn.isWeakSet=function(t){return ia(t)&&"[object WeakSet]"==jr(t)},Jn.join=function(t,e){return null==t?"":gn.call(t,e)},Jn.kebabCase=Wa,Jn.last=tu,Jn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=ma(n))<0?wn(r+o,0):xn(o,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,o):Be(t,Qe,o,!0)},Jn.lowerCase=Ga,Jn.lowerFirst=qa,Jn.lt=ya,Jn.lte=da,Jn.max=function(t){return t&&t.length?mr(t,ac,Rr):i},Jn.maxBy=function(t,e){return t&&t.length?mr(t,pi(e,2),Rr):i},Jn.mean=function(t){return Ve(t,ac)},Jn.meanBy=function(t,e){return Ve(t,pi(e,2))},Jn.min=function(t){return t&&t.length?mr(t,ac,Br):i},Jn.minBy=function(t,e){return t&&t.length?mr(t,pi(e,2),Br):i},Jn.stubArray=gc,Jn.stubFalse=_c,Jn.stubObject=function(){return{}},Jn.stubString=function(){return""},Jn.stubTrue=function(){return!0},Jn.multiply=Tc,Jn.nth=function(t,e){return t&&t.length?Yr(t,ma(e)):i},Jn.noConflict=function(){return ye._===this&&(ye._=Xt),this},Jn.noop=pc,Jn.now=Nu,Jn.pad=function(t,e,n){t=xa(t);var r=(e=ma(e))?yn(t):0;if(!e||r>=e)return t;var o=(e-r)/2;return Wo(me(o),n)+t+Wo(ve(o),n)},Jn.padEnd=function(t,e,n){t=xa(t);var r=(e=ma(e))?yn(t):0;return e&&r<e?t+Wo(e-r,n):t},Jn.padStart=function(t,e,n){t=xa(t);var r=(e=ma(e))?yn(t):0;return e&&r<e?Wo(e-r,n)+t:t},Jn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),Pn(xa(t).replace(at,""),e||0)},Jn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&Oi(t,e,n)&&(e=n=i),n===i&&("boolean"==typeof e?(n=e,e=i):"boolean"==typeof t&&(n=t,t=i)),t===i&&e===i?(t=0,e=1):(t=ba(t),e===i?(e=t,t=0):e=ba(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var o=Sn();return xn(t+o*(e-t+le("1e-"+((o+"").length-1))),e)}return Kr(t,e)},Jn.reduce=function(t,e,n){var r=Wu(t)?Ie:We,o=arguments.length<3;return r(t,pi(e,4),n,o,dr)},Jn.reduceRight=function(t,e,n){var r=Wu(t)?Ue:We,o=arguments.length<3;return r(t,pi(e,4),n,o,vr)},Jn.repeat=function(t,e,n){return e=(n?Oi(t,e,n):e===i)?1:ma(e),$r(xa(t),e)},Jn.replace=function(){var t=arguments,e=xa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Jn.result=function(t,e,n){var r=-1,o=(e=Oo(e,t)).length;for(o||(o=1,t=i);++r<o;){var u=null==t?i:t[Bi(e[r])];u===i&&(r=o,u=n),t=ea(u)?u.call(t):u}return t},Jn.round=Ac,Jn.runInContext=t,Jn.sample=function(t){return(Wu(t)?tr:to)(t)},Jn.size=function(t){if(null==t)return 0;if(qu(t))return sa(t)?yn(t):t.length;var e=mi(t);return e==T||e==F?t.size:Mr(t).length},Jn.snakeCase=Ka,Jn.some=function(t,e,n){var r=Wu(t)?De:ao;return n&&Oi(t,e,n)&&(e=i),r(t,pi(e,3))},Jn.sortedIndex=function(t,e){return co(t,e)},Jn.sortedIndexBy=function(t,e,n){return fo(t,e,pi(n,2))},Jn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=co(t,e);if(r<n&&Qu(t[r],e))return r}return-1},Jn.sortedLastIndex=function(t,e){return co(t,e,!0)},Jn.sortedLastIndexBy=function(t,e,n){return fo(t,e,pi(n,2),!0)},Jn.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=co(t,e,!0)-1;if(Qu(t[n],e))return n}return-1},Jn.startCase=$a,Jn.startsWith=function(t,e,n){return t=xa(t),n=null==n?0:lr(ma(n),0,t.length),e=po(e),t.slice(n,n+e.length)==e},Jn.subtract=jc,Jn.sum=function(t){return t&&t.length?Ge(t,ac):0},Jn.sumBy=function(t,e){return t&&t.length?Ge(t,pi(e,2)):0},Jn.template=function(t,e,n){var r=Jn.templateSettings;n&&Oi(t,e,n)&&(e=i),t=xa(t),e=Sa({},e,r,ni);var o,u,a=Sa({},e.imports,r.imports,ni),c=Ca(a),f=Ze(a,c),l=0,s=e.interpolate||Ot,p="__p += '",h=Rt((e.escape||Ot).source+"|"+s.source+"|"+(s===et?dt:Ot).source+"|"+(e.evaluate||Ot).source+"|$","g"),y="//# sourceURL="+(Ut.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ue+"]")+"\n";t.replace(h,(function(e,n,r,i,a,c){return r||(r=i),p+=t.slice(l,c).replace(Pt,an),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),a&&(u=!0,p+="';\n"+a+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=c+e.length,e})),p+="';\n";var d=Ut.call(e,"variable")&&e.variable;if(d){if(ht.test(d))throw new St("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(u?p.replace(Y,""):p).replace(H,"$1").replace(W,"$1;"),p="function("+(d||"obj")+") {\n"+(d?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v=nc((function(){return Tt(c,y+"return "+p).apply(i,f)}));if(v.source=p,ta(v))throw v;return v},Jn.times=function(t,e){if((t=ma(t))<1||t>d)return[];var n=b,r=xn(t,b);e=pi(e),t-=b;for(var o=qe(r,e);++n<t;)e(n);return o},Jn.toFinite=ba,Jn.toInteger=ma,Jn.toLength=ga,Jn.toLower=function(t){return xa(t).toLowerCase()},Jn.toNumber=_a,Jn.toSafeInteger=function(t){return t?lr(ma(t),-9007199254740991,d):0===t?t:0},Jn.toString=xa,Jn.toUpper=function(t){return xa(t).toUpperCase()},Jn.trim=function(t,e,n){if((t=xa(t))&&(n||e===i))return Ke(t);if(!t||!(e=po(e)))return t;var r=dn(t),o=dn(e);return So(r,en(r,o),nn(r,o)+1).join("")},Jn.trimEnd=function(t,e,n){if((t=xa(t))&&(n||e===i))return t.slice(0,vn(t)+1);if(!t||!(e=po(e)))return t;var r=dn(t);return So(r,0,nn(r,dn(e))+1).join("")},Jn.trimStart=function(t,e,n){if((t=xa(t))&&(n||e===i))return t.replace(at,"");if(!t||!(e=po(e)))return t;var r=dn(t);return So(r,en(r,dn(e))).join("")},Jn.truncate=function(t,e){var n=30,r="...";if(oa(e)){var o="separator"in e?e.separator:o;n="length"in e?ma(e.length):n,r="omission"in e?po(e.omission):r}var u=(t=xa(t)).length;if(cn(t)){var a=dn(t);u=a.length}if(n>=u)return t;var c=n-yn(r);if(c<1)return r;var f=a?So(a,0,c).join(""):t.slice(0,c);if(o===i)return f+r;if(a&&(c+=f.length-c),fa(o)){if(t.slice(c).search(o)){var l,s=f;for(o.global||(o=Rt(o.source,xa(vt.exec(o))+"g")),o.lastIndex=0;l=o.exec(s);)var p=l.index;f=f.slice(0,p===i?c:p)}}else if(t.indexOf(po(o),c)!=c){var h=f.lastIndexOf(o);h>-1&&(f=f.slice(0,h))}return f+r},Jn.unescape=function(t){return(t=xa(t))&&K.test(t)?t.replace(G,bn):t},Jn.uniqueId=function(t){var e=++Dt;return xa(t)+e},Jn.upperCase=Za,Jn.upperFirst=tc,Jn.each=xu,Jn.eachRight=Ou,Jn.first=qi,sc(Jn,(Sc={},Or(Jn,(function(t,e){Ut.call(Jn.prototype,e)||(Sc[e]=t)})),Sc),{chain:!1}),Jn.VERSION="4.17.21",je(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Jn[t].placeholder=Jn})),je(["drop","take"],(function(t,e){Hn.prototype[t]=function(n){n=n===i?1:wn(ma(n),0);var r=this.__filtered__&&!e?new Hn(this):this.clone();return r.__filtered__?r.__takeCount__=xn(n,r.__takeCount__):r.__views__.push({size:xn(n,b),type:t+(r.__dir__<0?"Right":"")}),r},Hn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),je(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Hn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:pi(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),je(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Hn.prototype[t]=function(){return this[n](1).value()[0]}})),je(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Hn.prototype[t]=function(){return this.__filtered__?new Hn(this):this[n](1)}})),Hn.prototype.compact=function(){return this.filter(ac)},Hn.prototype.find=function(t){return this.filter(t).head()},Hn.prototype.findLast=function(t){return this.reverse().find(t)},Hn.prototype.invokeMap=Zr((function(t,e){return"function"==typeof t?new Hn(this):this.map((function(n){return Lr(n,t,e)}))})),Hn.prototype.reject=function(t){return this.filter(Mu(pi(t)))},Hn.prototype.slice=function(t,e){t=ma(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Hn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==i&&(n=(e=ma(e))<0?n.dropRight(-e):n.take(e-t)),n)},Hn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Hn.prototype.toArray=function(){return this.take(b)},Or(Hn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),o=Jn[r?"take"+("last"==e?"Right":""):e],u=r||/^find/.test(e);o&&(Jn.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,c=e instanceof Hn,f=a[0],l=c||Wu(e),s=function(t){var e=o.apply(Jn,Ce([t],a));return r&&p?e[0]:e};l&&n&&"function"==typeof f&&1!=f.length&&(c=l=!1);var p=this.__chain__,h=!!this.__actions__.length,y=u&&!p,d=c&&!h;if(!u&&l){e=d?e:new Hn(this);var v=t.apply(e,a);return v.__actions__.push({func:bu,args:[s],thisArg:i}),new Yn(v,p)}return y&&d?t.apply(this,a):(v=this.thru(s),y?r?v.value()[0]:v.value():v)})})),je(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Et[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Jn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var o=this.value();return e.apply(Wu(o)?o:[],t)}return this[n]((function(n){return e.apply(Wu(n)?n:[],t)}))}})),Or(Hn.prototype,(function(t,e){var n=Jn[e];if(n){var r=n.name+"";Ut.call(kn,r)||(kn[r]=[]),kn[r].push({name:e,func:n})}})),kn[Qo(i,2).name]=[{name:"wrapper",func:i}],Hn.prototype.clone=function(){var t=new Hn(this.__wrapped__);return t.__actions__=Lo(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Lo(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Lo(this.__views__),t},Hn.prototype.reverse=function(){if(this.__filtered__){var t=new Hn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Hn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Wu(t),r=e<0,o=n?t.length:0,i=function(t,e,n){var r=-1,o=n.length;for(;++r<o;){var i=n[r],u=i.size;switch(i.type){case"drop":t+=u;break;case"dropRight":e-=u;break;case"take":e=xn(e,t+u);break;case"takeRight":t=wn(t,e-u)}}return{start:t,end:e}}(0,o,this.__views__),u=i.start,a=i.end,c=a-u,f=r?a:u-1,l=this.__iteratees__,s=l.length,p=0,h=xn(c,this.__takeCount__);if(!n||!r&&o==c&&h==c)return mo(t,this.__actions__);var y=[];t:for(;c--&&p<h;){for(var d=-1,v=t[f+=e];++d<s;){var b=l[d],m=b.iteratee,g=b.type,_=m(v);if(2==g)v=_;else if(!_){if(1==g)continue t;break t}}y[p++]=v}return y},Jn.prototype.at=mu,Jn.prototype.chain=function(){return vu(this)},Jn.prototype.commit=function(){return new Yn(this.value(),this.__chain__)},Jn.prototype.next=function(){this.__values__===i&&(this.__values__=va(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?i:this.__values__[this.__index__++]}},Jn.prototype.plant=function(t){for(var e,n=this;n instanceof Vn;){var r=Ji(n);r.__index__=0,r.__values__=i,e?o.__wrapped__=r:e=r;var o=r;n=n.__wrapped__}return o.__wrapped__=t,e},Jn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Hn){var e=t;return this.__actions__.length&&(e=new Hn(this)),(e=e.reverse()).__actions__.push({func:bu,args:[ou],thisArg:i}),new Yn(e,this.__chain__)}return this.thru(ou)},Jn.prototype.toJSON=Jn.prototype.valueOf=Jn.prototype.value=function(){return mo(this.__wrapped__,this.__actions__)},Jn.prototype.first=Jn.prototype.head,ee&&(Jn.prototype[ee]=function(){return this}),Jn}();"object"==o(n.amdO)&&n.amdO?(ye._=mn,(r=function(){return mn}.call(e,n,e,t))===i||(t.exports=r)):ve?((ve.exports=mn)._=mn,de._=mn):ye._=mn}.call(this)}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.amdO={},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){"use strict";var t=THREE;function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t){return Object.keys(t).sort()}function o(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(t).reduce((function(r,i){var u=n.length?"".concat(n,"."):"";return"object"===e(t[i])&&null!==t[i]&&Object.keys(t[i]).length?Object.assign(r,o(t[i],u+i)):r[u+i]=t[i],r}),{})}function i(t){return Object.keys(t).reduce((function(e,n){return n.split(".").reduce((function(e,r,o,i){return e[r]||(e[r]=isNaN(Number(i[o+1]))?i.length-1===o?t[n]:{}:[])}),e),e}),{})}var u,a="d~i-f*f";function c(t,e){var n,r,o,i=0;return Object.keys(t).sort().reduce((function(n,r){var o=t[r];return o!==e[r]&&(n[r]=o,n["d~i-f*f"].push(i)),i++,n}),(o=[],(r=a)in(n={})?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n))}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],u=!0,a=!1;try{for(n=n.call(t);!(u=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==n.return||n.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}var h="string",y="number",d="boolean";function v(t){return u.types.includes(p(t))}function b(t,e,n,r,i){var u=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];p(n)===h&&(n=n.split(",")),p(r)===h&&(r=r.split(","));var o=Object.keys(t),i=n.length?o.filter((function(t){return n.includes(t)})):o.filter((function(t){return!r.includes(t)}));return e&&(i=i.filter((function(t){return t!==e}))),i.sort()}(t,e,n,r),a=o(Object.keys(t).filter((function(t){return u.includes(t)})).reduce((function(e,n){return Object.assign(e,s({},n,t[n]))}),{})),f=Object.keys(a).filter((function(t){return v(a[t])})).reduce((function(t,e){return Object.assign(t,s({},e,a[e]))}),{});if(!i)return f;var l=c(f,o(i));return i||delete l["d~i-f*f"],l}function m(t,e,n){if(void 0!==n[t])return p(n[t])===d?Boolean(e):p(n[t])===y?Number(e):e}function g(t){var e=u.digits;if(p(t)!==y||Number.isInteger(t)||!e)return t;var n=Math.pow(10,e);return t=Math.round(t*n)/n}u={name:"winlo",separator:"~",overwrite:!0,types:[h,y,d],digits:3,diffSeparator:".",reset:function(){u.hash="",u.search=""},init:function(){u.search||u.hash||(u.hash="/",u.reset())},save:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.hash,o=n.include,i=n.exclude,a=n.reference,c=u,l=c.name,s=c.overwrite,p=c.separator,h=c.search,y=c.diffSeparator,d=s?void 0:h,m=new URLSearchParams(d),_=t[r];_&&v(_)?u.hash=_:r=!1;var w=b(t,r,o,i,a),x=Object.entries(w);if(x.length){var O;if(x.forEach((function(t){var e=f(t,2),n=e[0],r=e[1];return w[n]=g(r)})),e){O=!0===e?l:e;var P=w["d~i-f*f"],S=P?P.join(y):"";delete w["d~i-f*f"];var T=Object.keys(w).sort().map((function(t){return w[t]})),A=T.join(p);if(S.length){var j="".concat(p).concat(p);A+="".concat(j).concat(S)}A.length&&m.set(O,A)}else{delete w["d~i-f*f"];var R=new URLSearchParams(w);R.forEach((function(t,e){e=s?e:"".concat(l,".").concat(e),m.set(e,t)}))}return u.search=m,t}},load:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.hash,c=n.include,f=n.exclude,l=u,s=l.name,p=l.separator,h=l.search,y=l.diffSeparator,d=new URLSearchParams(h);if(a&&void 0!==t[a]){var v=window.location.hash;v&&(v=v.substring(1),t[a]=m(a,v,t))}var _=o(t);if(e){var w=b(t,a,c,f),x=r(w);if(!x.length)return;var O=!0===e?s:e,P=d.get(O);if(!P)return;var S,T="".concat(p).concat(p);if(P.includes(T)){var A=P.split(T);S=A[1].split(y),P=A[0]}var j=P.split(p);if(j.length!==x.length&&!S)return;var R=0;x.forEach((function(t){(!S||S.includes(R.toString()))&&(_[t]=m(t,j.shift(),_)),R++}))}else d.forEach((function(t,e){var n=m(e,t,_);void 0!==m&&(_[e]=n)}));for(var N in _=i(_))t[N]=g(_[N]);return t},round:g,get hash(){var t=window.location.hash;if(t&&(t=t.substring(1)),t.length)return t},set hash(t){t.length&&"#"!==t.charAt(0)&&(t="#"+t),window.location.hash=t},get search(){return window.location.search},set search(t){window.location.search=t}};var _=u;function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O(t,e){return O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},O(t,e)}function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=T(t);if(e){var o=T(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return S(this,n)}}function S(t,e){if(e&&("object"===w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}var A=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}(u,e);var n,r,o,i=P(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,{glslVersion:t.GLSL3,uniforms:{tMap:new t.Uniform(null),uBluriness:new t.Uniform(1),uDirection:new t.Uniform(new t.Vector2(1,0)),uResolution:new t.Uniform(new t.Vector2)},vertexShader:"in vec2 uv;\r\nin vec3 position;\r\n\r\nout vec2 vUv;\r\n\r\nvoid main() {\r\n    vUv = uv;\r\n\r\n    gl_Position = vec4(position, 1.0);\r\n}",fragmentShader:"precision highp float;\r\n\r\nuniform sampler2D tMap;\r\nuniform float uBluriness;\r\nuniform vec2 uDirection;\r\nuniform vec2 uResolution;\r\n\r\nin vec2 vUv;\r\n\r\nout vec4 FragColor;\r\n\r\nvec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\r\n  vec4 color = vec4(0.0);\r\n  vec2 off1 = vec2(1.411764705882353) * direction;\r\n  vec2 off2 = vec2(3.2941176470588234) * direction;\r\n  vec2 off3 = vec2(5.176470588235294) * direction;\r\n  color += texture(image, uv) * 0.1964825501511404;\r\n  color += texture(image, uv + (off1 / resolution)) * 0.2969069646728344;\r\n  color += texture(image, uv - (off1 / resolution)) * 0.2969069646728344;\r\n  color += texture(image, uv + (off2 / resolution)) * 0.09447039785044732;\r\n  color += texture(image, uv - (off2 / resolution)) * 0.09447039785044732;\r\n  color += texture(image, uv + (off3 / resolution)) * 0.010381362401148057;\r\n  color += texture(image, uv - (off3 / resolution)) * 0.010381362401148057;\r\n  return color;\r\n}\r\n\r\nvoid main() {\r\n    FragColor = blur13(tMap, vUv, uResolution, smoothstep(0.5 + uBluriness * 0.5, 0.0, vUv.y) * uDirection);\r\n}",blending:t.NoBlending,depthWrite:!1,depthTest:!1})}return n=u,r&&x(n.prototype,r),o&&x(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n}(t.RawShaderMaterial);function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function F(t,e){return F=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},F(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var o=k(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return L(this,n)}}function L(t,e){if(e&&("object"===j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}var C=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F(t,e)}(u,e);var n,r,o,i=E(u);function u(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,o=void 0===r?512:r,a=n.height,c=void 0===a?512:a,f=n.clipBias,l=void 0===f?0:f,s=n.blurIterations,p=void 0===s?8:s,h=n.blurFactor,y=void 0===h?1:h;return R(this,u),(e=i.call(this)).clipBias=l,e.blurIterations=p,e.reflectorPlane=new t.Plane,e.normal=new t.Vector3,e.reflectorWorldPosition=new t.Vector3,e.cameraWorldPosition=new t.Vector3,e.rotationMatrix=new t.Matrix4,e.lookAtPosition=new t.Vector3(0,0,-1),e.clipPlane=new t.Vector4,e.view=new t.Vector3,e.target=new t.Vector3,e.q=new t.Vector4,e.textureMatrix=new t.Matrix4,e.virtualCamera=new t.PerspectiveCamera,e.textureMatrixUniform=new t.Uniform(e.textureMatrix),e.renderTarget=new t.WebGLRenderTarget(o,c,{format:t.RGBFormat,depthBuffer:!1}),e.renderTargetRead=e.renderTarget.clone(),e.renderTargetWrite=e.renderTarget.clone(),e.renderTarget.depthBuffer=!0,e.renderTargetUniform=e.blurIterations>0?new t.Uniform(e.renderTargetRead.texture):new t.Uniform(e.renderTarget.texture),e.blurMaterial=new A,e.blurMaterial.uniforms.uBluriness.value=y,e.blurMaterial.uniforms.uResolution.value.set(o,c),e.screenScene=new t.Scene,e.screenCamera=new t.OrthographicCamera(-1,1,1,-1,0,1),e.screenGeometry=u.getFullscreenTriangle(),e.screen=new t.Mesh(e.screenGeometry,e.blurMaterial),e.screen.frustumCulled=!1,e.screenScene.add(e.screen),e}return n=u,r=[{key:"setSize",value:function(t,e){this.renderTarget.setSize(t,e),this.renderTargetRead.setSize(t,e),this.renderTargetWrite.setSize(t,e),this.blurMaterial.uniforms.uResolution.value.set(t,e)}},{key:"update",value:function(t,e,n){if(this.reflectorWorldPosition.setFromMatrixPosition(this.matrixWorld),this.cameraWorldPosition.setFromMatrixPosition(n.matrixWorld),this.rotationMatrix.extractRotation(this.matrixWorld),this.normal.set(0,0,1),this.normal.applyMatrix4(this.rotationMatrix),this.view.subVectors(this.reflectorWorldPosition,this.cameraWorldPosition),!(this.view.dot(this.normal)>0)){this.view.reflect(this.normal).negate(),this.view.add(this.reflectorWorldPosition),this.rotationMatrix.extractRotation(n.matrixWorld),this.lookAtPosition.set(0,0,-1),this.lookAtPosition.applyMatrix4(this.rotationMatrix),this.lookAtPosition.add(this.cameraWorldPosition),this.target.subVectors(this.reflectorWorldPosition,this.lookAtPosition),this.target.reflect(this.normal).negate(),this.target.add(this.reflectorWorldPosition),this.virtualCamera.position.copy(this.view),this.virtualCamera.up.set(0,1,0),this.virtualCamera.up.applyMatrix4(this.rotationMatrix),this.virtualCamera.up.reflect(this.normal),this.virtualCamera.lookAt(this.target),this.virtualCamera.far=n.far,this.virtualCamera.updateMatrixWorld(),this.virtualCamera.projectionMatrix.copy(n.projectionMatrix),this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.virtualCamera.projectionMatrix),this.textureMatrix.multiply(this.virtualCamera.matrixWorldInverse),this.textureMatrix.multiply(this.matrixWorld),this.reflectorPlane.setFromNormalAndCoplanarPoint(this.normal,this.reflectorWorldPosition),this.reflectorPlane.applyMatrix4(this.virtualCamera.matrixWorldInverse),this.clipPlane.set(this.reflectorPlane.normal.x,this.reflectorPlane.normal.y,this.reflectorPlane.normal.z,this.reflectorPlane.constant);var r=this.virtualCamera.projectionMatrix;this.q.x=(Math.sign(this.clipPlane.x)+r.elements[8])/r.elements[0],this.q.y=(Math.sign(this.clipPlane.y)+r.elements[9])/r.elements[5],this.q.z=-1,this.q.w=(1+r.elements[10])/r.elements[14],this.clipPlane.multiplyScalar(2/this.clipPlane.dot(this.q)),r.elements[2]=this.clipPlane.x,r.elements[6]=this.clipPlane.y,r.elements[10]=this.clipPlane.z+1-this.clipBias,r.elements[14]=this.clipPlane.w;var o=t.getRenderTarget(),i=t.xr.enabled,u=t.shadowMap.autoUpdate;t.xr.enabled=!1,t.shadowMap.autoUpdate=!1,t.setRenderTarget(this.renderTarget),t.state.buffers.depth.setMask(!0),!1===t.autoClear&&t.clear(),t.render(e,this.virtualCamera);for(var a=this.blurIterations,c=0;c<a;c++){this.blurMaterial.uniforms.tMap.value=0===c?this.renderTarget.texture:this.renderTargetRead.texture;var f=.5*(a-c-1);this.blurMaterial.uniforms.uDirection.value.set(c%2==0?f:0,c%2==0?0:f),t.setRenderTarget(this.renderTargetWrite),!1===t.autoClear&&t.clear(),t.render(this.screenScene,this.screenCamera);var l=this.renderTargetRead;this.renderTargetRead=this.renderTargetWrite,this.renderTargetWrite=l,this.renderTargetUniform.value=this.renderTargetRead.texture}t.xr.enabled=i,t.shadowMap.autoUpdate=u,t.setRenderTarget(o)}}},{key:"destroy",value:function(){for(var t in this.renderTargetWrite.dispose(),this.renderTargetRead.dispose(),this.renderTarget.dispose(),this.blurMaterial.dispose(),this.screenGeometry.dispose(),this)this[t]=null;return null}}],r&&N(n.prototype,r),o&&N(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(t.Group);C.getFullscreenTriangle=function(){var e=new t.BufferGeometry,n=new Float32Array([-1,-1,3,-1,-1,3]),r=new Float32Array([0,0,2,0,0,2]);return e.setAttribute("position",new t.BufferAttribute(n,2)),e.setAttribute("uv",new t.BufferAttribute(r,2)),e};var I="in vec3 position;\r\nin vec2 uv;\r\n\r\nuniform mat4 modelViewMatrix;\r\nuniform mat4 projectionMatrix;\r\n\r\nuniform mat3 uMapTransform;\r\nuniform mat4 uMatrix;\r\n\r\nout vec2 vUv;\r\nout vec4 vCoord;\r\n\r\nvoid main() {\r\n    vUv = (uMapTransform * vec3(uv, 1.0)).xy;\r\n    vCoord = uMatrix * vec4(position, 1.0);\r\n\r\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n}",U="precision highp float;\r\n\r\nuniform sampler2D tMap;\r\nuniform sampler2D tReflect;\r\nuniform vec3 uColor;\r\n\r\n#ifdef USE_FOG\r\n    uniform vec3 uFogColor;\r\n    uniform float uFogNear;\r\n    uniform float uFogFar;\r\n#endif\r\n\r\nin vec2 vUv;\r\nin vec4 vCoord;\r\n\r\nout vec4 FragColor;\r\n\r\nfloat blendOverlay(float x, float y) {\r\n    return (x < 0.5) ? (2.0 * x * y) : (1.0 - 2.0 * (1.0 - x) * (1.0 - y));\r\n}\r\n\r\nvec4 blendOverlay(vec4 x, vec4 y, float opacity) {\r\n    vec4 z = vec4(blendOverlay(x.r, y.r), blendOverlay(x.g, y.g), blendOverlay(x.b, y.b), blendOverlay(x.a, y.a));\r\n    return z * opacity + x * (1.0 - opacity);\r\n}\r\n\r\nfloat random(vec2 co) {\r\n    float a = 12.9898;\r\n    float b = 78.233;\r\n    float c = 43758.5453;\r\n    float dt = dot(co.xy, vec2(a, b));\r\n    float sn = mod(dt, 3.14);\r\n    return fract(sin(sn) * c);\r\n}\r\n\r\nvec3 dither(vec3 color) {\r\n    // Calculate grid position\r\n    float grid_position = random(gl_FragCoord.xy);\r\n\r\n    // Shift the individual colors differently, thus making it even harder to see the dithering pattern\r\n    vec3 dither_shift_RGB = vec3(0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0);\r\n\r\n    // Modify shift acording to grid position\r\n    dither_shift_RGB = mix(2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position);\r\n\r\n    // Shift the color by dither_shift\r\n    return color + dither_shift_RGB;\r\n}\r\n\r\nvoid main() {\r\n    vec4 base = texture(tMap, vUv);\r\n    vec4 blend = textureProj(tReflect, vCoord);\r\n\r\n    FragColor = base * blend;\r\n\r\n    base = FragColor;\r\n    blend = vec4(uColor, 1.0);\r\n\r\n    FragColor = blendOverlay(base, blend, 1.0);\r\n\r\n    #ifdef USE_FOG\r\n        float fogDepth = gl_FragCoord.z / gl_FragCoord.w;\r\n        float fogFactor = smoothstep(uFogNear, uFogFar, fogDepth);\r\n\r\n        FragColor.rgb = mix(FragColor.rgb, uFogColor, fogFactor);\r\n    #endif\r\n\r\n    #ifdef DITHERING\r\n        FragColor.rgb = dither(FragColor.rgb);\r\n    #endif\r\n}";function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B(t,e){return B=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},B(t,e)}function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Q(t);if(e){var o=Q(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return J(this,n)}}function J(t,e){if(e&&("object"===D(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Q(t){return Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Q(t)}var V=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B(t,e)}(u,e);var n,r,o,i=X(u);function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.color,r=void 0===n?new t.Color(8355711):n,o=e.map,a=void 0===o?null:o,c=e.fog,f=void 0===c?null:c,l=e.dithering,s=void 0!==l&&l;z(this,u);var p={glslVersion:t.GLSL3,defines:{},uniforms:{tMap:new t.Uniform(null),tReflect:new t.Uniform(null),uMapTransform:new t.Uniform(new t.Matrix3),uMatrix:new t.Uniform(new t.Matrix4),uColor:new t.Uniform(r instanceof t.Color?r:new t.Color(r))},vertexShader:I,fragmentShader:U};return a&&(a.updateMatrix(),p.uniforms=Object.assign(p.uniforms,{tMap:new t.Uniform(a),uMapTransform:new t.Uniform(a.matrix)})),f&&(p.defines=Object.assign(p.defines,{USE_FOG:""}),p.uniforms=Object.assign(p.uniforms,{uFogColor:new t.Uniform(f.color),uFogNear:new t.Uniform(f.near),uFogFar:new t.Uniform(f.far)})),s&&(p.defines=Object.assign(p.defines,{DITHERING:""})),i.call(this,p)}return n=u,r&&M(n.prototype,r),o&&M(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n}(t.RawShaderMaterial),Y=new t.Scene;Y.background=new t.Color(2237222),Y.fog=new t.Fog(Y.background,1,50);var H=new t.PerspectiveCamera(30);H.position.set(0,0,8.5),H.near=.5,H.far=50;var W=new t.HemisphereLight(6316128,4210752),G=new t.DirectionalLight(16777215);G.position.set(1,1,1);var q={hemisphere:W,directional:G};Object.values(q).forEach((function(t){return Y.add(t)}));var K={scene:Y,camera:H,lights:q,resize:function(t,e){H.aspect=t/e,H.updateProjectionMatrix()}};function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tt(t,e){return tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},tt(t,e)}function et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=rt(t);if(e){var o=rt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nt(this,n)}}function nt(t,e){if(e&&("object"===$(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function rt(t){return rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},rt(t)}var ot=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tt(t,e)}(u,e);var n,r,o,i=et(u);function u(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this)).reflector=new C,t}return n=u,r=[{key:"init",value:function(e){var n=this,r=new t.PlaneGeometry(110,110);e&&(e.wrapS=t.RepeatWrapping,e.wrapT=t.RepeatWrapping,e.repeat.set(16,16));var o=K.scene.fog,i=new V({map:e,fog:o,dithering:!0});i.uniforms.tReflect=this.reflector.renderTargetUniform,i.uniforms.uMatrix=this.reflector.textureMatrixUniform;var u=new t.Mesh(r,i);u.rotation.x=-Math.PI/2,u.add(this.reflector),u.onBeforeRender=function(t,e,r){n.visible=!1,n.reflector.update(t,e,r),n.visible=!0},this.add(u)}},{key:"resize",value:function(e,n,r){e=Math.round(e/r),n=Math.round(n/r),e=t.MathUtils.floorPowerOfTwo(e)/2,n=1024,this.reflector.setSize(e,n)}}],r&&Z(n.prototype,r),o&&Z(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(t.Group),it=n(77);function ut(t){var e,n=this,r=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.random=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1)}function at(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function ct(t){return at(0,t)}var ft={random:{int:at,uint:ct,item:function(t){return t[ct(t.length-1)]},boolean:function(){return Math.random()<.5}}},lt=[["black","white","red","green","blue","pink","purple","orange","silver","golden","iron","stone","velvet","opal","ivory","coral","broken","pearl","silk","fire","ice","thunder","falling","rising","diamond","turquoise","ruby","emerald","onyx","lapis","jade","amber"],["shield","sword","spear","arrow","knight","king","queen","phoenix","box","garden","flower","apple","echo","gambit","fist","dragon","sun","moon","star","cloud","rain","wind","dawn","storm","eagle","tiger","lion","puma","wolf","panther","dove","fox"]],st=[["loud","adorab","glad","zealous","grumpi","happi","polite","expert","awkward","warm","sincere","shy","quiet","lazi","mad","bold"].map((function(t){return"".concat(t,"ly")})),["beam","giggl","paint","smil","danc","laugh","sing","sneez","clapp","whistl","hopp","cheer","fly","greet","wav","juggl"].map((function(t){return"".concat(t,"ing")})),["smart","creative","bubbly","fun","cute","tiny","giant","laidback","upbeat","kind","cool","brave","dumb","tipsy","popular","generous"],["puppy","kitten","monkey","pumpkin","robot","nun","ninja","giraffe","baby","penguin","panda","koala","bear","wizard","pirate","knight"]],pt="abcdefghijklmnopqrstuvwxyz".split(""),ht="aeiou".split(""),yt=pt.filter((function(t){return!ht.includes(t)})),dt={alphabet:pt,vowels:ht,consonnants:yt};function vt(t){return function(t){if(Array.isArray(t))return bt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return bt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var mt={CODENAME:"codename",DESCRIPTION:"description",GIBBERISH:"gibberish",SERIAL:"serial"},gt={NONE:"",DASH:"-",DOT:".",TILDE:"~",UNDERSCORE:"_"},_t="";function wt(t){return ft.random.item(t)}function xt(){var t=At.verbose,e=At.separator;return(t?[].concat(vt(lt.map(wt)),[ft.random.uint(999)]):lt.map(wt)).join(e)}function Ot(){var t=At.verbose,e=At.separator;return(t?st:[st[1],st[3]]).map(wt).join(e)}function Pt(){var t=At.verbose,e=dt.vowels,n=dt.consonnants,r=t?8:4;return Array.from({length:r},(function(t,r){var o=r%2?e:n;return ft.random.item(o)})).join("")}function St(){var t=At.verbose?8:4,e=dt.alphabet.filter((function(t){return!"ilo".includes(t)}));return Array.from({length:t},(function(){return At.bool()?ft.random.item(e).toUpperCase():ft.random.int(1,9)})).join("")}function Tt(){var t={codename:xt,description:Ot,gibberish:Pt,serial:St}[At.mode]||xt;return At.seed=t(),At.seed}var At={modes:mt,mode:mt.CODENAME,separators:gt,separator:gt.NONE,verbose:!1,prng:new ut(_t),codename:xt,description:Ot,gibberish:Pt,serial:St,autoseed:Tt,reset:function(){At.prng=new ut(At.seed)},random:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=At.prng,o=r.random();return isNaN(t)||isNaN(e)?o:n?Math.floor(o*(e-t+1)+t):o*(e-t)+t},int:function(t,e){return At.random(t,e,!0)},uint:function(t){return At.int(0,t)},item:function(t){return t[At.uint(t.length-1)]},bool:function(){return At.random()<.5},char:function(t){return t.charAt(At.uint(t.length-1))},get seed(){return _t},set seed(t){_t=t,this.reset()}};Tt();var jt=At,Rt=30,Nt={defaults:{adjustments:{hue:0,saturation:1.5},bloom:{threshold:.6,strength:.2,radius:.8},orb:{passes:3,speed:6,smoothness:7,value1:.7,value2:.9,rotationSpeed:{x:0,y:9,z:0}}},random:{adjustments:{hue:{min:0,max:2*Math.PI},saturation:{min:0,max:3}},orb:{passes:{min:2,max:4,round:!0},speed:{min:1,max:Rt,round:!0},smoothness:{min:5,max:10,round:!0},value1:{min:0,max:1},value2:{min:0,max:1}},rotationSpeed:{x:{min:-30,max:Rt,round:!0},y:{min:-30,max:Rt,round:!0},z:{min:-30,max:Rt,round:!0}}}},Ft=window,Et={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"};function Lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ct(t,e,n){return e&&kt(t.prototype,e),n&&kt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var It=function(){function t(){Lt(this,t),this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}return Ct(t,[{key:"setSize",value:function(){}},{key:"render",value:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}]),t}(),Ut=new t.OrthographicCamera(-1,1,1,-1,0,1),Dt=new t.BufferGeometry;Dt.setAttribute("position",new t.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),Dt.setAttribute("uv",new t.Float32BufferAttribute([0,2,0,0,2,0],2));var Mt=function(){function e(n){Lt(this,e),this._mesh=new t.Mesh(Dt,n)}return Ct(e,[{key:"dispose",value:function(){this._mesh.geometry.dispose()}},{key:"render",value:function(t){t.render(this._mesh,Ut)}},{key:"material",get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}]),e}();function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xt(t,e){return Xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xt(t,e)}function Jt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Vt(t);if(e){var o=Vt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qt(this,n)}}function Qt(t,e){if(e&&("object"===zt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Vt(t){return Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Vt(t)}var Yt=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(u,e);var n,r,o,i=Jt(u);function u(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=i.call(this)).textureID=void 0!==n?n:"tDiffuse",e instanceof t.ShaderMaterial?(r.uniforms=e.uniforms,r.material=e):e&&(r.uniforms=t.UniformsUtils.clone(e.uniforms),r.material=new t.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:r.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),r.fsQuad=new Mt(r.material),r}return n=u,r=[{key:"render",value:function(t,e,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}}],r&&Bt(n.prototype,r),o&&Bt(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(It);function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function Wt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qt(t,e,n){return e&&Gt(t.prototype,e),n&&Gt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Kt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$t(t,e)}function $t(t,e){return $t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},$t(t,e)}function Zt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ee(t);if(e){var o=ee(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return te(this,n)}}function te(t,e){if(e&&("object"===Ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ee(t){return ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ee(t)}var ne=function(t){Kt(n,t);var e=Zt(n);function n(t,r){var o;return Wt(this,n),(o=e.call(this)).scene=t,o.camera=r,o.clear=!0,o.needsSwap=!1,o.inverse=!1,o}return qt(n,[{key:"render",value:function(t,e,n){var r,o,i=t.getContext(),u=t.state;u.buffers.color.setMask(!1),u.buffers.depth.setMask(!1),u.buffers.color.setLocked(!0),u.buffers.depth.setLocked(!0),this.inverse?(r=0,o=1):(r=1,o=0),u.buffers.stencil.setTest(!0),u.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),u.buffers.stencil.setFunc(i.ALWAYS,r,4294967295),u.buffers.stencil.setClear(o),u.buffers.stencil.setLocked(!0),t.setRenderTarget(n),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),u.buffers.color.setLocked(!1),u.buffers.depth.setLocked(!1),u.buffers.stencil.setLocked(!1),u.buffers.stencil.setFunc(i.EQUAL,1,4294967295),u.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),u.buffers.stencil.setLocked(!0)}}]),n}(It),re=function(t){Kt(n,t);var e=Zt(n);function n(){var t;return Wt(this,n),(t=e.call(this)).needsSwap=!1,t}return qt(n,[{key:"render",value:function(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}}]),n}(It);function oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ue(t,e,n){return e&&ie(t.prototype,e),n&&ie(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var ae=function(){function e(n,r){if(oe(this,e),this.renderer=n,void 0===r){var o={minFilter:t.LinearFilter,magFilter:t.LinearFilter,format:t.RGBAFormat},i=n.getSize(new t.Vector2);this._pixelRatio=n.getPixelRatio(),this._width=i.width,this._height=i.height,(r=new t.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,o)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=r.width,this._height=r.height;this.renderTarget1=r,this.renderTarget2=r.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===Et&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===Yt&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new Yt(Et),this.clock=new t.Clock}return ue(e,[{key:"swapBuffers",value:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}},{key:"addPass",value:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"insertPass",value:function(t,e){this.passes.splice(e,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"removePass",value:function(t){var e=this.passes.indexOf(t);-1!==e&&this.passes.splice(e,1)}},{key:"isLastEnabledPass",value:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0}},{key:"render",value:function(t){void 0===t&&(t=this.clock.getDelta());for(var e=this.renderer.getRenderTarget(),n=!1,r=0,o=this.passes.length;r<o;r++){var i=this.passes[r];if(!1!==i.enabled){if(i.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),i.render(this.renderer,this.writeBuffer,this.readBuffer,t,n),i.needsSwap){if(n){var u=this.renderer.getContext(),a=this.renderer.state.buffers.stencil;a.setFunc(u.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),a.setFunc(u.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==ne&&(i instanceof ne?n=!0:i instanceof re&&(n=!1))}}this.renderer.setRenderTarget(e)}},{key:"reset",value:function(e){if(void 0===e){var n=this.renderer.getSize(new t.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=n.width,this._height=n.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}},{key:"setSize",value:function(t,e){this._width=t,this._height=e;var n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(var o=0;o<this.passes.length;o++)this.passes[o].setSize(n,r)}},{key:"setPixelRatio",value:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}}]),e}(),ce=(new t.OrthographicCamera(-1,1,1,-1,0,1),new t.BufferGeometry);ce.setAttribute("position",new t.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),ce.setAttribute("uv",new t.Float32BufferAttribute([0,2,0,0,2,0],2));function fe(t){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe(t)}function le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function se(t,e){return se=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},se(t,e)}function pe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ye(t);if(e){var o=ye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return he(this,n)}}function he(t,e){if(e&&("object"===fe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ye(t){return ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ye(t)}var de=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&se(t,e)}(u,e);var n,r,o,i=pe(u);function u(e,n,r,o,a){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(c=i.call(this)).scene=e,c.camera=n,c.overrideMaterial=r,c.clearColor=o,c.clearAlpha=void 0!==a?a:0,c.clear=!0,c.clearDepth=!1,c.needsSwap=!1,c._oldClearColor=new t.Color,c}return n=u,r=[{key:"render",value:function(t,e,n){var r,o,i=t.autoClear;t.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(t.getClearColor(this._oldClearColor),r=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:n),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(this._oldClearColor,r),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),t.autoClear=i}}],r&&le(n.prototype,r),o&&le(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(It);function ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var me=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ve(this,t),this.name=e.name,this.type=e.type,this.node=e.node,this.needsUpdate=e.needsUpdate}var e,n,r;return e=t,(n=[{key:"value",get:function(){return this.node.value},set:function(t){this.node.value=t}}])&&be(e.prototype,n),r&&be(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ge={elements:["x","y","z","w"],addShortcuts:function(){function t(t,e,n){return n?{get:function(){return this[t][e][n]},set:function(r){this[t][e][n]=r}}:{get:function(){return this[t][e]},set:function(n){this[t][e]=n}}}return function(e,n,r){for(var o={},i=0;i<r.length;++i){var u=r[i].split("."),a=u[0],c=u[1];o[a]=t(n,a,c)}Object.defineProperties(e,o)}}()},_e={nodes:{},keywords:{},add:function(t){this.nodes[t.name]=t},addKeyword:function(t,e,n){n=void 0===n||n,this.keywords[t]={callback:e,cache:n}},remove:function(t){delete this.nodes[t.name]},removeKeyword:function(t){delete this.keywords[t]},get:function(t){return this.nodes[t]},getKeyword:function(t,e){return this.keywords[t].callback.call(this,e)},getKeywordData:function(t){return this.keywords[t]},contains:function(t){return void 0!==this.nodes[t]},containsKeyword:function(t){return void 0!==this.keywords[t]}};function we(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xe=function(){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.uuid=t.MathUtils.generateUUID(),this.name="",this.type=n,this.userData={}}var n,r,o;return n=e,r=[{key:"analyze",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.analyzing=!0,this.build(t.addFlow(e.slot,e.cache,e.context),"v4"),t.clearVertexNodeCode(),t.clearFragmentNodeCode(),t.removeFlow(),t.analyzing=!1}},{key:"analyzeAndFlow",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.analyze(t,n),this.flow(t,e,n)}},{key:"flow",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t.addFlow(n.slot,n.cache,n.context);var r={};return r.result=this.build(t,e),r.code=t.clearNodeCode(),r.extra=t.context.extra,t.removeFlow(),r}},{key:"build",value:function(t,e,n){e=e||this.getType(t,e);var r=t.getNodeData(n||this);return t.analyzing&&this.appendDepsNode(t,r,e),-1===t.nodes.indexOf(this)&&t.nodes.push(this),void 0!==this.updateFrame&&-1===t.updaters.indexOf(this)&&t.updaters.push(this),this.generate(t,e,n)}},{key:"generate",value:function(){}},{key:"getHash",value:function(){var t,n,r="{";for(t in this)(n=this[t])instanceof e&&(r+='"'+t+'":'+n.getHash()+",");if(this.hashProperties)for(var o=0;o<this.hashProperties.length;o++)n=this[t=this.hashProperties[o]],r+='"'+t+'":"'+String(n)+'",';return r+='"id":"'+this.uuid+'"}'}},{key:"appendDepsNode",value:function(t,e,n){e.deps=(e.deps||0)+1;var r=t.getTypeLength(n);(r>(e.outputMax||0)||this.getType(t,n))&&(e.outputMax=r,e.output=n)}},{key:"setName",value:function(t){return this.name=t,this}},{key:"getName",value:function(){return this.name}},{key:"getType",value:function(t,e){return"sampler2D"===e||"samplerCube"===e?e:this.type}},{key:"getJSONNode",value:function(t){if(void 0!==t&&"string"!=typeof t&&void 0!==t.nodes[this.uuid])return t.nodes[this.uuid]}},{key:"copy",value:function(t){return void 0!==t.name&&(this.name=t.name),void 0!==t.userData&&(this.userData=JSON.parse(JSON.stringify(t.userData))),this}},{key:"createJSONNode",value:function(t){var e=void 0===t||"string"==typeof t,n={};if("string"!=typeof this.nodeType)throw new Error("Node does not allow serialization.");return n.uuid=this.uuid,n.nodeType=this.nodeType,""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.nodes[this.uuid]=n),n}},{key:"toJSON",value:function(t){return this.getJSONNode(t)||this.createJSONNode(t)}}],r&&we(n.prototype,r),o&&we(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();function Oe(t){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(t)}function Pe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Te(){return Te="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Ae(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Te.apply(this,arguments)}function Ae(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fe(t)););return t}function je(t,e){return je=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},je(t,e)}function Re(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Fe(t);if(e){var o=Fe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ne(this,n)}}function Ne(t,e){if(e&&("object"===Oe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Fe(t){return Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Fe(t)}xe.prototype.isNode=!0,xe.prototype.hashProperties=void 0;var Ee=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&je(t,e)}(u,e);var n,r,o,i=Re(u);function u(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Pe(this,u),(e=i.call(this,t)).shared=void 0===n.shared||n.shared,e.unique=void 0!==n.unique&&n.unique,e}return n=u,(r=[{key:"build",value:function(e,n,r,o){if(n=n||this.getType(e),this.getShared(e,n)){var i=this.getUnique(e,n);i&&void 0===this.constructor.uuid&&(this.constructor.uuid=t.MathUtils.generateUUID()),r=e.getUuid(r||this.getUuid(),!i);var a=e.getNodeData(r),c=a.output||this.getType(e);if(e.analyzing)return(a.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,a,n),this.generate(e,n,r)):Te(Fe(u.prototype),"build",this).call(this,e,n,r);if(i)return a.name=a.name||Te(Fe(u.prototype),"build",this).call(this,e,n,r),a.name;if(!this.getLabel()&&(!this.getShared(e,c)||e.context.ignoreCache||1===a.deps))return Te(Fe(u.prototype),"build",this).call(this,e,n,r);r=this.getUuid(!1);var f=this.getTemp(e,r);if(f)return e.format(f,c,n);f=u.prototype.generate.call(this,e,n,r,a.output,o);var l=this.generate(e,c,r);return e.addNodeCode(f+" = "+l+";"),e.format(f,c,n)}return Te(Fe(u.prototype),"build",this).call(this,e,n,r)}},{key:"getShared",value:function(t,e){return"sampler2D"!==e&&"samplerCube"!==e&&this.shared}},{key:"getUnique",value:function(){return this.unique}},{key:"setLabel",value:function(t){return this.label=t,this}},{key:"getLabel",value:function(){return this.label}},{key:"getUuid",value:function(t){var e=(t||null==t)&&this.constructor.uuid||this.uuid;return"string"==typeof this.scope&&(e=this.scope+"-"+e),e}},{key:"getTemp",value:function(t,e){e=e||this.uuid;var n=t.getVars()[e];return n?n.name:void 0}},{key:"generate",value:function(t,e,n,r,o){return this.getShared(t,e)||console.error("THREE.TempNode is not shared!"),n=n||this.uuid,t.getTempVar(n,r||this.getType(t),o,this.getLabel()).name}}])&&Se(n.prototype,r),o&&Se(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(xe);function Le(t){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Le(t)}function ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ce(){return Ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Ie(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ce.apply(this,arguments)}function Ie(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ze(t)););return t}function Ue(t,e){return Ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ue(t,e)}function De(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ze(t);if(e){var o=ze(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Me(this,n)}}function Me(t,e){if(e&&("object"===Le(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ze(t){return ze=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ze(t)}var Be=/^\s*([a-z_0-9]+)\s+([a-z_0-9]+)\s*\(([\s\S]*?)\)/i,Xe=/[a-z_0-9]+/gi,Je=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ue(t,e)}(i,t);var e,n,r,o=De(i);function i(t,e,n,r,u){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(a=o.call(this,u)).isMethod=void 0===u,a.isInterface=!1,a.parse(t,e,n,r),a}return e=i,n=[{key:"getShared",value:function(){return!this.isMethod}},{key:"getType",value:function(t){return t.getTypeByFormat(this.type)}},{key:"getInputByName",value:function(t){for(var e=this.inputs.length;e--;)if(this.inputs[e].name===t)return this.inputs[e]}},{key:"getIncludeByName",value:function(t){for(var e=this.includes.length;e--;)if(this.includes[e].name===t)return this.includes[e]}},{key:"generate",value:function(t,e){for(var n,r=0,o=this.src,i=0;i<this.includes.length;i++)t.include(this.includes[i],this);for(var u in this.extensions)t.extensions[u]=!0;for(var a=[];n=Xe.exec(this.src);)a.push(n);for(var c=0;c<a.length;c++){var f=a[c],l=f[0],s=!this.isMethod||!this.getInputByName(l),p=l;if(this.keywords[l]||this.useKeywords&&s&&_e.containsKeyword(l)){var h=this.keywords[l];if(!h){var y=_e.getKeywordData(l);y.cache&&(h=t.keywords[l]),h=h||_e.getKeyword(l,t),y.cache&&(t.keywords[l]=h)}p=h.build(t)}l!==p&&(o=o.substring(0,f.index+r)+p+o.substring(f.index+l.length+r),r+=p.length-l.length),void 0===this.getIncludeByName(p)&&_e.contains(p)&&t.include(_e.get(p))}return"source"===e?o:this.isMethod?(this.isInterface||t.include(this,!1,o),this.name):t.format("( "+o+" )",this.getType(t),e)}},{key:"parse",value:function(t,e,n,r){if(this.src=t||"",this.includes=e||[],this.extensions=n||{},this.keywords=r||{},this.isMethod){var o=this.src.match(Be);if(this.inputs=[],o&&4==o.length){this.type=o[1],this.name=o[2];var i=o[3].match(Xe);if(i)for(var u=0;u<i.length;){var a=i[u++],c=void 0;"in"===a||"out"===a||"inout"===a?c=i[u++]:(c=a,a="");var f=i[u++];this.inputs.push({name:f,type:c,qualifier:a})}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}}},{key:"copy",value:function(t){return Ce(ze(i.prototype),"copy",this).call(this,t),this.isMethod=t.isMethod,this.useKeywords=t.useKeywords,this.parse(t.src,t.includes,t.extensions,t.keywords),void 0!==t.type&&(this.type=t.type),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);if(!e){for(var n in(e=this.createJSONNode(t)).src=this.src,e.isMethod=this.isMethod,e.useKeywords=this.useKeywords,this.isMethod||(e.type=this.type),e.extensions=JSON.parse(JSON.stringify(this.extensions)),e.keywords={},this.keywords)e.keywords[n]=this.keywords[n].toJSON(t).uuid;if(this.includes.length){e.includes=[];for(var r=0;r<this.includes.length;r++)e.includes.push(this.includes[r].toJSON(t).uuid)}}return e}}],n&&ke(e.prototype,n),r&&ke(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Qe(t){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(t)}function Ve(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ye(){return Ye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=He(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ye.apply(this,arguments)}function He(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ke(t)););return t}function We(t,e){return We=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},We(t,e)}function Ge(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ke(t);if(e){var o=Ke(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qe(this,n)}}function qe(t,e){if(e&&("object"===Qe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ke(t){return Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ke(t)}Je.prototype.nodeType="Function",Je.prototype.useKeywords=!0;var $e=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,Ze=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&We(t,e)}(i,t);var e,n,r,o=Ge(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).parse(t||i.PI,e),n}return e=i,(n=[{key:"getType",value:function(t){return t.getTypeByFormat(this.type)}},{key:"parse",value:function(t,e){this.src=t||"";var n,r,o="",i=this.src.match($e);this.useDefine=e||"#"===this.src.charAt(0),i&&i.length>1?(r=i[1],n=i[2],o=i[3]):(n=this.src,r="f"),this.name=n,this.type=r,this.value=o}},{key:"build",value:function(t,e){return"source"!==e?(t.include(this),t.format(this.name,this.getType(t),e)):this.value?this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";":this.useDefine?this.src:void 0}},{key:"generate",value:function(t,e){return t.format(this.name,this.getType(t),e)}},{key:"copy",value:function(t){return Ye(Ke(i.prototype),"copy",this).call(this,t),this.parse(t.src,t.useDefine),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).src=this.src,!0===e.useDefine&&(e.useDefine=!0)),e}}])&&Ve(e.prototype,n),r&&Ve(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nn(t,e){return nn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},nn(t,e)}function rn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=un(t);if(e){var o=un(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return on(this,n)}}function on(t,e){if(e&&("object"===tn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function un(t){return un=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},un(t)}Ze.prototype.nodeType="Const",Ze.PI="PI",Ze.PI2="PI2",Ze.RECIPROCAL_PI="RECIPROCAL_PI",Ze.RECIPROCAL_PI2="RECIPROCAL_PI2",Ze.LOG2="LOG2",Ze.EPSILON="EPSILON";var an=/^struct\s*([a-z_0-9]+)\s*{\s*((.|\n)*?)}/gim,cn=/\s*(\w*?)\s*(\w*?)(\=|\;)/gim,fn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nn(t,e)}(i,t);var e,n,r,o=rn(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).parse(t),e}return e=i,n=[{key:"getType",value:function(t){return t.getTypeByFormat(this.name)}},{key:"getInputByName",value:function(t){for(var e=this.inputs.length;e--;)if(this.inputs[e].name===t)return this.inputs[e]}},{key:"generate",value:function(t,e){return"source"===e?this.src+";":t.format("( "+this.src+" )",this.getType(t),e)}},{key:"parse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.src=t,this.inputs=[];var e=an.exec(this.src);if(e){for(var n,r=e[2];n=cn.exec(r);)this.inputs.push({type:n[1],name:n[2]});this.name=e[1]}else this.name="";this.type=this.name}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).src=this.src),e}}],n&&en(e.prototype,n),r&&en(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function ln(t){return ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ln(t)}function sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pn(){return pn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=hn(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},pn.apply(this,arguments)}function hn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bn(t)););return t}function yn(t,e){return yn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},yn(t,e)}function dn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=bn(t);if(e){var o=bn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vn(this,n)}}function vn(t,e){if(e&&("object"===ln(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function bn(t){return bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},bn(t)}fn.prototype.nodeType="Struct";var mn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yn(t,e)}(i,t);var e,n,r,o=dn(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=e||{}).shared=void 0!==e.shared&&e.shared,(n=o.call(this,t,e)).readonly=!1,n}return e=i,(n=[{key:"setReadonly",value:function(t){return this.readonly=t,this.hashProperties=this.readonly?["value"]:void 0,this}},{key:"getReadonly",value:function(){return this.readonly}},{key:"copy",value:function(t){return pn(bn(i.prototype),"copy",this).call(this,t),void 0!==t.readonly&&(this.readonly=t.readonly),this}},{key:"createJSONNode",value:function(t){var e=pn(bn(i.prototype),"createJSONNode",this).call(this,t);return!0===this.readonly&&(e.readonly=this.readonly),e}},{key:"generate",value:function(t,e,n,r,o,i){n=t.getUuid(n||this.getUuid()),r=r||this.getType(t);var u=t.getNodeData(n);return this.getReadonly(t)&&void 0!==this.generateReadonly?this.generateReadonly(t,e,n,r,o,i):t.isShader("vertex")?(u.vertex||(u.vertex=t.createVertexUniform(r,this,o,i,this.getLabel())),t.format(u.vertex.name,r,e)):(u.fragment||(u.fragment=t.createFragmentUniform(r,this,o,i,this.getLabel())),t.format(u.fragment.name,r,e))}}])&&sn(e.prototype,n),r&&sn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function gn(t){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gn(t)}function _n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wn(){return wn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=xn(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},wn.apply(this,arguments)}function xn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tn(t)););return t}function On(t,e){return On=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},On(t,e)}function Pn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Tn(t);if(e){var o=Tn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Sn(this,n)}}function Sn(t,e){if(e&&("object"===gn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Tn(t){return Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Tn(t)}var An=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&On(t,e)}(u,e);var n,r,o,i=Pn(u);function u(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=i.call(this,"v2")).value=e instanceof t.Vector2?e:new t.Vector2(e,n),r}return n=u,(r=[{key:"generateReadonly",value:function(t,e,n,r){return t.format("vec2( "+this.x+", "+this.y+" )",r,e)}},{key:"copy",value:function(t){return wn(Tn(u.prototype),"copy",this).call(this,t),this.value.copy(t),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).x=this.x,e.y=this.y,!0===this.readonly&&(e.readonly=!0)),e}}])&&_n(n.prototype,r),o&&_n(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(mn);function jn(t){return jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jn(t)}function Rn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nn(){return Nn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Fn(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Nn.apply(this,arguments)}function Fn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Cn(t)););return t}function En(t,e){return En=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},En(t,e)}function Ln(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Cn(t);if(e){var o=Cn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kn(this,n)}}function kn(t,e){if(e&&("object"===jn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Cn(t){return Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Cn(t)}An.prototype.nodeType="Vector2",ge.addShortcuts(An.prototype,"value",["x","y"]);var In=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&En(t,e)}(u,e);var n,r,o,i=Ln(u);function u(e,n,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,"v3")).value=e instanceof t.Vector3?e:new t.Vector3(e,n,r),o}return n=u,(r=[{key:"generateReadonly",value:function(t,e,n,r){return t.format("vec3( "+this.x+", "+this.y+", "+this.z+" )",r,e)}},{key:"copy",value:function(t){return Nn(Cn(u.prototype),"copy",this).call(this,t),this.value.copy(t),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).x=this.x,e.y=this.y,e.z=this.z,!0===this.readonly&&(e.readonly=!0)),e}}])&&Rn(n.prototype,r),o&&Rn(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(mn);function Un(t){return Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Un(t)}function Dn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mn(){return Mn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=zn(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Mn.apply(this,arguments)}function zn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qn(t)););return t}function Bn(t,e){return Bn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Bn(t,e)}function Xn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Qn(t);if(e){var o=Qn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jn(this,n)}}function Jn(t,e){if(e&&("object"===Un(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Qn(t){return Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Qn(t)}In.prototype.nodeType="Vector3",ge.addShortcuts(In.prototype,"value",["x","y","z"]);var Vn=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bn(t,e)}(u,e);var n,r,o,i=Xn(u);function u(e,n,r,o){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(a=i.call(this,"v4")).value=e instanceof t.Vector4?e:new t.Vector4(e,n,r,o),a}return n=u,(r=[{key:"generateReadonly",value:function(t,e,n,r){return t.format("vec4( "+this.x+", "+this.y+", "+this.z+", "+this.w+" )",r,e)}},{key:"copy",value:function(t){return Mn(Qn(u.prototype),"copy",this).call(this,t),this.value.copy(t),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,!0===this.readonly&&(e.readonly=!0)),e}}])&&Dn(n.prototype,r),o&&Dn(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(mn);function Yn(t){return Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yn(t)}function Hn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wn(){return Wn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Gn(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Wn.apply(this,arguments)}function Gn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zn(t)););return t}function qn(t,e){return qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},qn(t,e)}function Kn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zn(t);if(e){var o=Zn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $n(this,n)}}function $n(t,e){if(e&&("object"===Yn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Zn(t){return Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Zn(t)}Vn.prototype.nodeType="Vector4",ge.addShortcuts(Vn.prototype,"value",["x","y","z","w"]);var tr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qn(t,e)}(i,t);var e,n,r,o=Kn(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"v2",{shared:!1})).index=t||0,e}return e=i,(n=[{key:"generate",value:function(t,e){t.requires.uv[this.index]=!0;var n=this.index>0?this.index+1:"",r=t.isShader("vertex")?"uv"+n:"vUv"+n;return t.format(r,this.getType(t),e)}},{key:"copy",value:function(t){return Wn(Zn(i.prototype),"copy",this).call(this,t),this.index=t.index,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).index=this.index),e}}])&&Hn(e.prototype,n),r&&Hn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rr(){return rr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=or(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},rr.apply(this,arguments)}function or(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cr(t)););return t}function ir(t,e){return ir=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ir(t,e)}function ur(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=cr(t);if(e){var o=cr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ar(this,n)}}function ar(t,e){if(e&&("object"===er(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function cr(t){return cr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},cr(t)}tr.prototype.nodeType="UV",_e.addKeyword("uv",(function(){return new tr})),_e.addKeyword("uv2",(function(){return new tr(1)}));var fr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ir(t,e)}(i,t);var e,n,r,o=ur(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,"v4")).input=t,n.method=e||i.LINEAR_TO_LINEAR,n}return e=i,(n=[{key:"generate",value:function(t,e){var n=this.input.build(t,"v4"),r=this.getType(t),o=i.Nodes[this.method],u=t.include(o);if(u===i.LINEAR_TO_LINEAR)return t.format(n,r,e);if(2===o.inputs.length){var a=this.factor.build(t,"f");return t.format(u+"( "+n+", "+a+" )",r,e)}return t.format(u+"( "+n+" )",r,e)}},{key:"fromEncoding",value:function(t){var e=i.getEncodingComponents(t);this.method="LinearTo"+e[0],this.factor=e[1]}},{key:"fromDecoding",value:function(t){var e=i.getEncodingComponents(t);this.method=e[0]+"ToLinear",this.factor=e[1]}},{key:"copy",value:function(t){return rr(cr(i.prototype),"copy",this).call(this,t),this.input=t.input,this.method=t.method,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).input=this.input.toJSON(t).uuid,e.method=this.method),e}}])&&nr(e.prototype,n),r&&nr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function lr(t){return lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lr(t)}function sr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pr(t,e){return pr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pr(t,e)}function hr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=dr(t);if(e){var o=dr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yr(this,n)}}function yr(t,e){if(e&&("object"===lr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function dr(t){return dr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},dr(t)}fr.Nodes={LinearToLinear:new Je("\n\t\tvec4 LinearToLinear( in vec4 value ) {\n\n\t\t\treturn value;\n\n\t\t}"),sRGBToLinear:new Je("\n\t\tvec4 sRGBToLinear( in vec4 value ) {\n\n\t\t\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n\n\t\t}"),LinearTosRGB:new Je("\n\t\tvec4 LinearTosRGB( in vec4 value ) {\n\n\t\t\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n\n\t\t}")},fr.LINEAR_TO_LINEAR="LinearToLinear",fr.SRGB_TO_LINEAR="sRGBToLinear",fr.LINEAR_TO_SRGB="LinearTosRGB",fr.getEncodingComponents=function(e){switch(e){case t.LinearEncoding:return["Linear"];case t.sRGBEncoding:return["sRGB"]}},fr.prototype.nodeType="ColorSpace",fr.prototype.hashProperties=["method"];var vr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pr(t,e)}(i,t);var e,n,r,o=hr(i);function i(t,e,n,r,u){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,u,r,n,e)}return e=i,n&&sr(e.prototype,n),r&&sr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Je);function br(t){return br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},br(t)}function mr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gr(){return gr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=_r(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},gr.apply(this,arguments)}function _r(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Pr(t)););return t}function wr(t,e){return wr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},wr(t,e)}function xr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Pr(t);if(e){var o=Pr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Or(this,n)}}function Or(t,e){if(e&&("object"===br(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Pr(t){return Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Pr(t)}vr.prototype.nodeType="Expression";var Sr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wr(t,e)}(i,t);var e,n,r,o=xr(i);function i(t,e,n,r){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(u=o.call(this,"v4",{shared:!0})).value=t,u.uv=e||new tr,u.bias=n,u.project=void 0!==r&&r,u}return e=i,(n=[{key:"getTexture",value:function(t,e){return gr(Pr(i.prototype),"generate",this).call(this,t,e,this.value.uuid,"t")}},{key:"generate",value:function(t,e){if("sampler2D"===e)return this.getTexture(t,e);var n,r,o=this.getTexture(t,e),i=this.uv.build(t,this.project?"v4":"v2"),u=this.bias?this.bias.build(t,"f"):void 0;void 0===u&&t.context.bias&&(u=t.context.bias.setTexture(this).build(t,"f")),n=this.project?"texture2DProj":u?"tex2DBias":"tex2D",r=u?n+"( "+o+", "+i+", "+u+" )":n+"( "+o+", "+i+" )";var a={include:t.isShader("vertex"),ignoreCache:!0},c=this.getType(t);return t.addContext(a),this.colorSpace=this.colorSpace||new fr(new vr("",c)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(r),r=this.colorSpace.build(t,c),t.removeContext(),t.format(r,c,e)}},{key:"copy",value:function(t){return gr(Pr(i.prototype),"copy",this).call(this,t),t.value&&(this.value=t.value),this.uv=t.uv,t.bias&&(this.bias=t.bias),void 0!==t.project&&(this.project=t.project),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),this.value&&(e.value=this.value.uuid),e.uv=this.uv.toJSON(t).uuid,e.project=this.project,this.bias&&(e.bias=this.bias.toJSON(t).uuid)),e}}])&&mr(e.prototype,n),r&&mr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(mn);function Tr(t){return Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tr(t)}function Ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jr(){return jr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Rr(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},jr.apply(this,arguments)}function Rr(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lr(t)););return t}function Nr(t,e){return Nr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Nr(t,e)}function Fr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Lr(t);if(e){var o=Lr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Er(this,n)}}function Er(t,e){if(e&&("object"===Tr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Lr(t){return Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Lr(t)}Sr.prototype.nodeType="Texture";var kr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nr(t,e)}(i,t);var e,n,r,o=Fr(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"v3")).scope=t||i.LOCAL,e}return e=i,(n=[{key:"getType",value:function(){return this.scope===i.PROJECTION?"v4":this.type}},{key:"getShared",value:function(){switch(this.scope){case i.LOCAL:case i.WORLD:return!1}return!0}},{key:"generate",value:function(t,e){var n;switch(this.scope){case i.LOCAL:t.isShader("vertex")?n="transformed":(t.requires.position=!0,n="vPosition");break;case i.WORLD:if(t.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";t.requires.worldPosition=!0,n="vWPosition";break;case i.VIEW:n=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case i.PROJECTION:n=t.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return t.format(n,this.getType(t),e)}},{key:"copy",value:function(t){return jr(Lr(i.prototype),"copy",this).call(this,t),this.scope=t.scope,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope),e}}])&&Ar(e.prototype,n),r&&Ar(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Cr(t){return Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cr(t)}function Ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ur(){return Ur="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Dr(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ur.apply(this,arguments)}function Dr(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xr(t)););return t}function Mr(t,e){return Mr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Mr(t,e)}function zr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Xr(t);if(e){var o=Xr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Br(this,n)}}function Br(t,e){if(e&&("object"===Cr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Xr(t){return Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Xr(t)}kr.LOCAL="local",kr.WORLD="world",kr.VIEW="view",kr.PROJECTION="projection",kr.prototype.nodeType="Position",_e.addKeyword("position",(function(){return new kr})),_e.addKeyword("worldPosition",(function(){return new kr(kr.WORLD)})),_e.addKeyword("viewPosition",(function(){return new kr(kr.VIEW)}));var Jr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mr(t,e)}(i,t);var e,n,r,o=zr(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"v3")).scope=t||i.VIEW,e}return e=i,(n=[{key:"getShared",value:function(){return this.scope===i.WORLD}},{key:"build",value:function(t,e,n,r){var o=t.context[this.scope+"Normal"];return o?o.build(t,e,n,r):Ur(Xr(i.prototype),"build",this).call(this,t,e,n)}},{key:"generate",value:function(t,e){var n;switch(this.scope){case i.VIEW:n=t.isShader("vertex")?"transformedNormal":"geometryNormal";break;case i.LOCAL:t.isShader("vertex")?n="objectNormal":(t.requires.normal=!0,n="vObjectNormal");break;case i.WORLD:t.isShader("vertex")?n="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(t.requires.worldNormal=!0,n="vWNormal")}return t.format(n,this.getType(t),e)}},{key:"copy",value:function(t){return Ur(Xr(i.prototype),"copy",this).call(this,t),this.scope=t.scope,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope),e}}])&&Ir(e.prototype,n),r&&Ir(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Qr(t){return Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qr(t)}function Vr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yr(t,e){return Yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Yr(t,e)}function Hr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Gr(t);if(e){var o=Gr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wr(this,n)}}function Wr(t,e){if(e&&("object"===Qr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Gr(t){return Gr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Gr(t)}Jr.LOCAL="local",Jr.WORLD="world",Jr.VIEW="view",Jr.prototype.nodeType="Normal",_e.addKeyword("viewNormal",(function(){return new Jr(Jr.VIEW)})),_e.addKeyword("localNormal",(function(){return new Jr(Jr.NORMAL)})),_e.addKeyword("worldNormal",(function(){return new Jr(Jr.WORLD)}));var qr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yr(t,e)}(i,t);var e,n,r,o=Hr(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"v3")).scope=t||i.CUBE,e}return e=i,(n=[{key:"getUnique",value:function(t){return!t.context.viewNormal}},{key:"getType",value:function(){return this.scope===i.SPHERE?"v2":this.type}},{key:"generate",value:function(t,e){var n=this.getUnique(t);if(t.isShader("fragment")){var r,o,u;switch(this.scope){case i.VECTOR:var a=new Jr(Jr.VIEW),c=t.context.roughness,f=a.build(t,"v3"),l=new kr(kr.VIEW).build(t,"v3"),s=c?c.build(t,"f"):void 0,p="reflect( -normalize( ".concat(l," ), ").concat(f," )");s&&(p="normalize( mix( ".concat(p,", ").concat(f,", ").concat(s," * ").concat(s," ) )")),o="inverseTransformDirection( ".concat(p,", viewMatrix )"),n?(t.addNodeCode("vec3 reflectVec = ".concat(o,";")),r="reflectVec"):r=o;break;case i.CUBE:o="vec3( -"+(u=new i(i.VECTOR).build(t,"v3"))+".x, "+u+".yz )",n?(t.addNodeCode("vec3 reflectCubeVec = ".concat(o,";")),r="reflectCubeVec"):r=o;break;case i.SPHERE:o="normalize( ( viewMatrix * vec4( "+(u=new i(i.VECTOR).build(t,"v3"))+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5",n?(t.addNodeCode("vec2 reflectSphereVec = ".concat(o,";")),r="reflectSphereVec"):r=o}return t.format(r,this.getType(t),e)}return console.warn("THREE.ReflectNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.type,e)}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope),e}}])&&Vr(e.prototype,n),r&&Vr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Kr(t){return Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kr(t)}function $r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Zr(){return Zr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=to(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Zr.apply(this,arguments)}function to(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oo(t)););return t}function eo(t,e){return eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},eo(t,e)}function no(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=oo(t);if(e){var o=oo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ro(this,n)}}function ro(t,e){if(e&&("object"===Kr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function oo(t){return oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},oo(t)}qr.CUBE="cube",qr.SPHERE="sphere",qr.VECTOR="vector",qr.prototype.nodeType="Reflect";var io=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eo(t,e)}(i,t);var e,n,r,o=no(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this,"v4",{shared:!0})).value=t,r.uv=e||new qr,r.bias=n,r}return e=i,(n=[{key:"getTexture",value:function(t,e){return Zr(oo(i.prototype),"generate",this).call(this,t,e,this.value.uuid,"tc")}},{key:"generate",value:function(t,e){if("samplerCube"===e)return this.getTexture(t,e);var n,r=this.getTexture(t,e),o=this.uv.build(t,"v3"),i=this.bias?this.bias.build(t,"f"):void 0;void 0===i&&t.context.bias&&(i=t.context.bias.setTexture(this).build(t,"f")),n=i?"texCubeBias( "+r+", "+o+", "+i+" )":"texCube( "+r+", "+o+" )";var u={include:t.isShader("vertex"),ignoreCache:!0},a=this.getType(t);return t.addContext(u),this.colorSpace=this.colorSpace||new fr(new vr("",a)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(n),n=this.colorSpace.build(t,a),t.removeContext(),t.format(n,a,e)}},{key:"copy",value:function(t){return Zr(oo(i.prototype),"copy",this).call(this,t),t.value&&(this.value=t.value),this.uv=t.uv,t.bias&&(this.bias=t.bias),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.uuid,e.uv=this.uv.toJSON(t).uuid,this.bias&&(e.bias=this.bias.toJSON(t).uuid)),e}}])&&$r(e.prototype,n),r&&$r(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(mn);function uo(t){return uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uo(t)}function ao(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function co(){return co="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=fo(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},co.apply(this,arguments)}function fo(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ho(t)););return t}function lo(t,e){return lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},lo(t,e)}function so(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ho(t);if(e){var o=ho(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return po(this,n)}}function po(t,e){if(e&&("object"===uo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ho(t){return ho=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ho(t)}io.prototype.nodeType="CubeTexture";var yo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lo(t,e)}(i,t);var e,n,r,o=so(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"f")).value=t||0,e}return e=i,(n=[{key:"generateReadonly",value:function(t,e,n,r){return t.format(this.value+(this.value%1?"":".0"),r,e)}},{key:"copy",value:function(t){return co(ho(i.prototype),"copy",this).call(this,t),this.value=t.value,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value,!0===this.readonly&&(e.readonly=!0)),e}}])&&ao(e.prototype,n),r&&ao(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(mn);function vo(t){return vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vo(t)}function bo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mo(){return mo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=go(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},mo.apply(this,arguments)}function go(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Oo(t)););return t}function _o(t,e){return _o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_o(t,e)}function wo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Oo(t);if(e){var o=Oo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xo(this,n)}}function xo(t,e){if(e&&("object"===vo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Oo(t){return Oo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Oo(t)}yo.prototype.nodeType="Float";var Po=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_o(t,e)}(i,t);var e,n,r,o=wo(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).setFunction(t,e),n}return e=i,n=[{key:"setFunction",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.value=t,this.inputs=e}},{key:"getFunction",value:function(){return this.value}},{key:"getType",value:function(t){return this.value.getType(t)}},{key:"generate",value:function(t,e){for(var n=this.getType(t),r=this.value,o=r.build(t,e)+"( ",i=[],u=0;u<r.inputs.length;u++){var a=r.inputs[u],c=this.inputs[u]||this.inputs[a.name];i.push(c.build(t,t.getTypeByFormat(a.type)))}return o+=i.join(", ")+" )",t.format(o,n,e)}},{key:"copy",value:function(t){for(var e in mo(Oo(i.prototype),"copy",this).call(this,t),t.inputs)this.inputs[e]=t.inputs[e];return this.value=t.value,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);if(!e){var n=this.value;if((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid,n.inputs.length){e.inputs={};for(var r=0;r<n.inputs.length;r++){var o=n.inputs[r],i=this.inputs[r]||this.inputs[o.name];e.inputs[o.name]=i.toJSON(t).uuid}}}return e}}],n&&bo(e.prototype,n),r&&bo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function So(t){return So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},So(t)}function To(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ao(){return Ao="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=jo(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ao.apply(this,arguments)}function jo(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Eo(t)););return t}function Ro(t,e){return Ro=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ro(t,e)}function No(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Eo(t);if(e){var o=Eo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fo(this,n)}}function Fo(t,e){if(e&&("object"===So(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Eo(t){return Eo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Eo(t)}Po.prototype.nodeType="FunctionCall";var Lo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ro(t,e)}(i,t);var e,n,r,o=No(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this)).a=t,r.b=e,r.op=n,r}return e=i,(n=[{key:"getType",value:function(t){var e=this.a.getType(t),n=this.b.getType(t);return t.isTypeMatrix(e)?"v4":t.getTypeLength(n)>t.getTypeLength(e)?n:e}},{key:"generate",value:function(t,e){var n=this.getType(t),r=this.a.build(t,n),o=this.b.build(t,n);return t.format("( "+r+" "+this.op+" "+o+" )",n,e)}},{key:"copy",value:function(t){return Ao(Eo(i.prototype),"copy",this).call(this,t),this.a=t.a,this.b=t.b,this.op=t.op,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).a=this.a.toJSON(t).uuid,e.b=this.b.toJSON(t).uuid,e.op=this.op),e}}])&&To(e.prototype,n),r&&To(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function ko(t){return ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ko(t)}function Co(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Io(){return Io="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Uo(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Io.apply(this,arguments)}function Uo(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bo(t)););return t}function Do(t,e){return Do=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Do(t,e)}function Mo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Bo(t);if(e){var o=Bo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zo(this,n)}}function zo(t,e){if(e&&("object"===ko(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Bo(t){return Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Bo(t)}Lo.ADD="+",Lo.SUB="-",Lo.MUL="*",Lo.DIV="/",Lo.prototype.nodeType="Operator";var Xo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Do(t,e)}(i,t);var e,n,r,o=Mo(i);function i(t,e,n,r){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(u=o.call(this)).a=t,"string"!=typeof e?u.b=e:r=e,"string"!=typeof n?u.c=n:r=n,u.method=r,u}return e=i,(n=[{key:"getNumInputs",value:function(){switch(this.method){case i.ARCTAN:return this.b?2:1;case i.MIX:case i.CLAMP:case i.REFRACT:case i.SMOOTHSTEP:case i.FACEFORWARD:return 3;case i.MIN:case i.MAX:case i.MOD:case i.STEP:case i.REFLECT:case i.DISTANCE:case i.DOT:case i.CROSS:case i.POW:return 2;default:return 1}}},{key:"getInputType",value:function(t){var e=t.getTypeLength(this.a.getType(t)),n=this.b?t.getTypeLength(this.b.getType(t)):0,r=this.c?t.getTypeLength(this.c.getType(t)):0;return e>n&&e>r?this.a.getType(t):n>r?this.b.getType(t):this.c.getType(t)}},{key:"getType",value:function(t){switch(this.method){case i.LENGTH:case i.DISTANCE:case i.DOT:return"f";case i.CROSS:return"v3"}return this.getInputType(t)}},{key:"generate",value:function(t,e){var n,r,o,u=this.a?t.getTypeLength(this.a.getType(t)):0,a=this.b?t.getTypeLength(this.b.getType(t)):0,c=this.c?t.getTypeLength(this.c.getType(t)):0,f=this.getInputType(t),l=this.getType(t);switch(this.method){case i.NEGATE:return t.format("( -"+this.a.build(t,f)+" )",f,e);case i.INVERT:return t.format("( 1.0 - "+this.a.build(t,f)+" )",f,e);case i.CROSS:n=this.a.build(t,"v3"),r=this.b.build(t,"v3");break;case i.STEP:n=this.a.build(t,1===u?"f":f),r=this.b.build(t,f);break;case i.MIN:case i.MAX:case i.MOD:n=this.a.build(t,f),r=this.b.build(t,1===a?"f":f);break;case i.REFRACT:n=this.a.build(t,f),r=this.b.build(t,f),o=this.c.build(t,"f");break;case i.MIX:n=this.a.build(t,f),r=this.b.build(t,f),o=this.c.build(t,1===c?"f":f);break;default:n=this.a.build(t,f),this.b&&(r=this.b.build(t,f)),this.c&&(o=this.c.build(t,f))}var s=[];s.push(n),r&&s.push(r),o&&s.push(o);var p=this.getNumInputs(t);if(s.length!==p)throw Error('Arguments not match used in "'.concat(this.method,'". Require ').concat(p,", currently ").concat(s.length,"."));return t.format(this.method+"( "+s.join(", ")+" )",l,e)}},{key:"copy",value:function(t){return Io(Bo(i.prototype),"copy",this).call(this,t),this.a=t.a,this.b=t.b,this.c=t.c,this.method=t.method,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).a=this.a.toJSON(t).uuid,this.b&&(e.b=this.b.toJSON(t).uuid),this.c&&(e.c=this.c.toJSON(t).uuid),e.method=this.method),e}}])&&Co(e.prototype,n),r&&Co(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Jo(t){return Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jo(t)}function Qo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vo(t,e){return Vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Vo(t,e)}function Yo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Wo(t);if(e){var o=Wo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ho(this,n)}}function Ho(t,e){if(e&&("object"===Jo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Wo(t){return Wo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Wo(t)}Xo.RAD="radians",Xo.DEG="degrees",Xo.EXP="exp",Xo.EXP2="exp2",Xo.LOG="log",Xo.LOG2="log2",Xo.SQRT="sqrt",Xo.INV_SQRT="inversesqrt",Xo.FLOOR="floor",Xo.CEIL="ceil",Xo.NORMALIZE="normalize",Xo.FRACT="fract",Xo.SATURATE="saturate",Xo.SIN="sin",Xo.COS="cos",Xo.TAN="tan",Xo.ASIN="asin",Xo.ACOS="acos",Xo.ARCTAN="atan",Xo.ABS="abs",Xo.SIGN="sign",Xo.LENGTH="length",Xo.NEGATE="negate",Xo.INVERT="invert",Xo.MIN="min",Xo.MAX="max",Xo.MOD="mod",Xo.STEP="step",Xo.REFLECT="reflect",Xo.DISTANCE="distance",Xo.DOT="dot",Xo.CROSS="cross",Xo.POW="pow",Xo.MIX="mix",Xo.CLAMP="clamp",Xo.REFRACT="refract",Xo.SMOOTHSTEP="smoothstep",Xo.FACEFORWARD="faceforward",Xo.prototype.nodeType="Math",Xo.prototype.hashProperties=["method"];var Go=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vo(t,e)}(i,t);var e,n,r,o=Yo(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this,"v4")).value=t,r.uv=e,r.bias=n,r}return e=i,(n=[{key:"bilinearCubeUV",value:function(t,e,n,r){var o=new Po(i.Nodes.bilinearCubeUV,[e,n,r]);this.colorSpaceTL=this.colorSpaceTL||new fr(new vr("","v4")),this.colorSpaceTL.input.parse(o.build(t)+".tl"),this.colorSpaceTR=this.colorSpaceTR||new fr(new vr("","v4")),this.colorSpaceTR.input.parse(o.build(t)+".tr"),this.colorSpaceBL=this.colorSpaceBL||new fr(new vr("","v4")),this.colorSpaceBL.input.parse(o.build(t)+".bl"),this.colorSpaceBR=this.colorSpaceBR||new fr(new vr("","v4")),this.colorSpaceBR.input.parse(o.build(t)+".br");var u={include:t.isShader("vertex"),ignoreCache:!0};t.addContext(u),this.colorSpaceTLExp=new vr(this.colorSpaceTL.build(t,"v4"),"v4"),this.colorSpaceTRExp=new vr(this.colorSpaceTR.build(t,"v4"),"v4"),this.colorSpaceBLExp=new vr(this.colorSpaceBL.build(t,"v4"),"v4"),this.colorSpaceBRExp=new vr(this.colorSpaceBR.build(t,"v4"),"v4"),t.removeContext();var a=new vr("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=o,a}},{key:"generate",value:function(t,e){if(t.isShader("fragment")){var n=this.uv,r=this.bias||t.context.roughness,o=new Po(i.Nodes.roughnessToMip,[r]),u=new Xo(o,i.Nodes.m0,i.Nodes.cubeUV_maxMipLevel,Xo.CLAMP),a=new Xo(u,Xo.FLOOR),c=new Xo(u,Xo.FRACT),f=this.bilinearCubeUV(t,this.value,n,a),l=this.bilinearCubeUV(t,this.value,n,new Lo(a,new yo(1).setReadonly(!0),Lo.ADD)),s=new Xo(f,l,c,Xo.MIX);return t.format(s.build(t),"v4",e)}return console.warn("THREE.TextureCubeUVNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid,e.uv=this.uv.toJSON(t).uuid,e.bias=this.bias.toJSON(t).uuid),e}}])&&Qo(e.prototype,n),r&&Qo(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function qo(t){return qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qo(t)}function Ko(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $o(){return $o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Zo(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},$o.apply(this,arguments)}function Zo(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ri(t)););return t}function ti(t,e){return ti=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ti(t,e)}function ei(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ri(t);if(e){var o=ri(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ni(this,n)}}function ni(t,e){if(e&&("object"===qo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ri(t){return ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ri(t)}Go.Nodes=function(){var t=new fn("struct TextureCubeUVData {\n\t\t\tvec4 tl;\n\t\t\tvec4 tr;\n\t\t\tvec4 br;\n\t\t\tvec4 bl;\n\t\t\tvec2 f;\n\t\t}"),e=new Ze("float cubeUV_maxMipLevel 8.0",!0),n=new Ze("float cubeUV_minMipLevel 4.0",!0),r=new Ze("float cubeUV_maxTileSize 256.0",!0),o=new Ze("float cubeUV_minTileSize 16.0",!0),i=new Je("float getFace(vec3 direction) {\n\t\t\t\tvec3 absDirection = abs(direction);\n\t\t\t\tfloat face = -1.0;\n\t\t\t\tif (absDirection.x > absDirection.z) {\n\t\t\t\t\tif (absDirection.x > absDirection.y)\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t} else {\n\t\t\t\t\tif (absDirection.z > absDirection.y)\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t}\n\t\t\t\treturn face;\n\t\t}");i.useKeywords=!1;var u=new Je("vec2 getUV(vec3 direction, float face) {\n\t\t\t\tvec2 uv;\n\t\t\t\tif (face == 0.0) {\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x); // pos x\n\t\t\t\t} else if (face == 1.0) {\n\t\t\t\t\tuv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y\n\t\t\t\t} else if (face == 2.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z\n\t\t\t\t} else if (face == 3.0) {\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x\n\t\t\t\t} else if (face == 4.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y\n\t\t\t\t} else {\n\t\t\t\t\tuv = vec2(direction.x, direction.y) / abs(direction.z); // neg z\n\t\t\t\t}\n\t\t\t\treturn 0.5 * (uv + 1.0);\n\t\t}");u.useKeywords=!1;var a=new Je("TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n\n\t\t\tfloat face = getFace(direction);\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\n\t\t\tfloat faceSize = exp2(mipInt);\n\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\n\t\t\tvec2 f = fract(uv);\n\t\t\tuv += 0.5 - f;\n\t\t\tif (face > 2.0) {\n\t\t\t\tuv.y += faceSize;\n\t\t\t\tface -= 3.0;\n\t\t\t}\n\t\t\tuv.x += face * faceSize;\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t}\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n\t\t\tuv *= texelSize;\n\n\t\t\tvec4 tl = texture2D(envMap, uv);\n\t\t\tuv.x += texelSize;\n\t\t\tvec4 tr = texture2D(envMap, uv);\n\t\t\tuv.y += texelSize;\n\t\t\tvec4 br = texture2D(envMap, uv);\n\t\t\tuv.x -= texelSize;\n\t\t\tvec4 bl = texture2D(envMap, uv);\n\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\n\t\t}",[t,i,u,e,n,r,o]);a.useKeywords=!1;var c=new Ze("float r0 1.0",!0),f=new Ze("float v0 0.339",!0),l=new Ze("float m0 -2.0",!0),s=new Ze("float r1 0.8",!0),p=new Ze("float v1 0.276",!0),h=new Ze("float m1 -1.0",!0),y=new Ze("float r4 0.4",!0),d=new Ze("float v4 0.046",!0),v=new Ze("float m4 2.0",!0),b=new Ze("float r5 0.305",!0),m=new Ze("float v5 0.016",!0),g=new Ze("float m5 3.0",!0),_=new Ze("float r6 0.21",!0),w=new Ze("float v6 0.0038",!0),x=new Ze("float m6 4.0",!0);return{bilinearCubeUV:a,roughnessToMip:new Je("float roughnessToMip(float roughness) {\n\t\t\tfloat mip = 0.0;\n\t\t\tif (roughness >= r1) {\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n\t\t\t} else if (roughness >= r4) {\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n\t\t\t} else if (roughness >= r5) {\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n\t\t\t} else if (roughness >= r6) {\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n\t\t\t} else {\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n\t\t\t}\n\t\t\treturn mip;\n\t\t}",[c,f,l,s,p,h,y,d,v,b,m,g,_,w,x]),m0:l,cubeUV_maxMipLevel:e}}(),Go.prototype.nodeType="TextureCubeUV";var oi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ti(t,e)}(i,t);var e,n,r,o=ei(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this,"v4")).value=t,r.radianceNode=new Go(r.value,e||new qr(qr.VECTOR),n),r.irradianceNode=new Go(r.value,new Jr(Jr.WORLD),new yo(1).setReadonly(!0)),r}return e=i,(n=[{key:"generate",value:function(t,e){return t.isShader("fragment")?(t.require("irradiance"),t.context.bias&&t.context.bias.setTexture(this.value),("irradiance"===t.slot?this.irradianceNode:this.radianceNode).build(t,e)):(console.warn("THREE.TextureCubeNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e))}},{key:"copy",value:function(t){return $o(ri(i.prototype),"copy",this).call(this,t),this.value=t.value,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid),e}}])&&Ko(e.prototype,n),r&&Ko(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function ii(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}oi.prototype.nodeType="TextureCube";var ui=ge.elements,ai=["float","vec2","vec3","vec4"],ci={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b"},fi={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4"},li=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.requires={uv:[],color:[],lights:!1,fog:!1,transparent:!1,irradiance:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode="\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\t#define texCube(a, b) textureCube(a, b)\n\t\t\t\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)\n\n\t\t\t\t#define tex2D(a, b) texture2D(a, b)\n\t\t\t\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)\n\n\t\t\t#else\n\n\t\t\t\t#define texCube(a, b) textureCube(a, b)\n\t\t\t\t#define texCubeBias(a, b, c) textureCube(a, b, c)\n\n\t\t\t\t#define tex2D(a, b) texture2D(a, b)\n\t\t\t\t#define tex2DBias(a, b, c) texture2D(a, b, c)\n\n\t\t\t#endif\n\n\t\t\t#include <packing>\n\t\t\t#include <common>",this.parsCode={vertex:"",fragment:""},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={},this.updaters=[],this.nodes=[],this.analyzing=!1}var n,r,o;return n=e,r=[{key:"build",value:function(t,e){this.buildShader("vertex",t),this.buildShader("fragment",e);for(var n=0;n<this.requires.uv.length;n++)if(this.requires.uv[n]){var r=n>0?n+1:"";this.addVaryCode("varying vec2 vUv"+r+";"),n>0&&this.addVertexParsCode("attribute vec2 uv"+r+";"),this.addVertexFinalCode("vUv"+r+" = uv"+r+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition&&(this.addVaryCode("varying vec3 vWPosition;"),this.addVertexFinalCode("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;")),this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this}},{key:"buildShader",value:function(t,e){this.resultCode[t]=e.build(this.setShader(t),"v4")}},{key:"setMaterial",value:function(t,e){return this.material=t,this.renderer=e,this.requires.lights=t.lights,this.requires.fog=t.fog,this.mergeDefines(t.defines),this}},{key:"addFlow",value:function(t,e,n){return this.addSlot(t).addCache(e).addContext(n)}},{key:"removeFlow",value:function(){return this.removeSlot().removeCache().removeContext()}},{key:"addCache",value:function(t){return this.cache=t||"",this.caches.push(this.cache),this}},{key:"removeCache",value:function(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}},{key:"addContext",value:function(t){return this.context=Object.assign({},this.context,t),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}},{key:"removeContext",value:function(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}},{key:"addSlot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.slot=t,this.slots.push(this.slot),this}},{key:"removeSlot",value:function(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}},{key:"addVertexCode",value:function(t){this.addCode(t,"vertex")}},{key:"addFragmentCode",value:function(t){this.addCode(t,"fragment")}},{key:"addCode",value:function(t,e){this.code[e||this.shader]+=t+"\n"}},{key:"addVertexNodeCode",value:function(t){this.addNodeCode(t,"vertex")}},{key:"addFragmentNodeCode",value:function(t){this.addNodeCode(t,"fragment")}},{key:"addNodeCode",value:function(t,e){this.nodeCode[e||this.shader]+=t+"\n"}},{key:"clearNodeCode",value:function(t){t=t||this.shader;var e=this.nodeCode[t];return this.nodeCode[t]="",e}},{key:"clearVertexNodeCode",value:function(){return this.clearNodeCode("vertex")}},{key:"clearFragmentNodeCode",value:function(){return this.clearNodeCode("fragment")}},{key:"addVertexFinalCode",value:function(t){this.addFinalCode(t,"vertex")}},{key:"addFragmentFinalCode",value:function(t){this.addFinalCode(t,"fragment")}},{key:"addFinalCode",value:function(t,e){this.finalCode[e||this.shader]+=t+"\n"}},{key:"addVertexParsCode",value:function(t){this.addParsCode(t,"vertex")}},{key:"addFragmentParsCode",value:function(t){this.addParsCode(t,"fragment")}},{key:"addParsCode",value:function(t,e){this.parsCode[e||this.shader]+=t+"\n"}},{key:"addVaryCode",value:function(t){this.addVertexParsCode(t),this.addFragmentParsCode(t)}},{key:"isCache",value:function(t){return-1!==this.caches.indexOf(t)}},{key:"isSlot",value:function(t){return-1!==this.slots.indexOf(t)}},{key:"define",value:function(t,e){this.defines[t]=void 0===e?1:e}},{key:"require",value:function(t){this.requires[t]=!0}},{key:"isDefined",value:function(t){return void 0!==this.defines[t]}},{key:"getVar",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"varying",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",u=this.getVars(r),a=u[t];if(!a){var c=u.length,f=n||"node"+o+c+(i?"_"+i:"");a={name:f,type:e},u.push(a),u[t]=a}return a}},{key:"getTempVar",value:function(t,e,n,r){return this.getVar(t,e,n,this.shader,"T",r)}},{key:"getAttribute",value:function(t,e){if(!this.attributes[t]){var n=this.getVar(t,e);this.addVertexParsCode("attribute "+e+" "+t+";"),this.addVertexFinalCode(n.name+" = "+t+";"),this.attributes[t]={varying:n,name:t,type:e}}return this.attributes[t]}},{key:"getCode",value:function(t){return[this.prefixCode,this.parsCode[t],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[t],"uniform"),this.getIncludesCode("consts",t),this.getIncludesCode("structs",t),this.getIncludesCode("functions",t),"void main() {",this.getVarListCode(this.getVars(t)),this.code[t],this.resultCode[t],this.finalCode[t],"}"].join("\n")}},{key:"getVarListCode",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="",r=0,o=t.length;r<o;++r){var i=t[r],u=i.type,a=i.name,c=this.getFormatByType(u);if(void 0===c)throw new Error("Node pars "+c+" not found.");n+=e+" "+c+" "+a+";\n"}return n}},{key:"getVars",value:function(t){return this.inputs.vars[t||this.shader]}},{key:"getNodeData",value:function(t){var e=t.isNode?t.uuid:t;return this.nodeData[e]=this.nodeData[e]||{}}},{key:"createUniform",value:function(t,e,n,r,o,i){var u=this.inputs.uniforms,a=u.list.length,c=new me({type:e,name:r||"nodeU"+a+(i?"_"+i:""),node:n,needsUpdate:o});return u.list.push(c),u[t].push(c),u[t][c.name]=c,this.uniforms[c.name]=c,c}},{key:"createVertexUniform",value:function(t,e,n,r,o){return this.createUniform("vertex",t,e,n,r,o)}},{key:"createFragmentUniform",value:function(t,e,n,r,o){return this.createUniform("fragment",t,e,n,r,o)}},{key:"include",value:function(t,e,n){var r;if(t="string"==typeof t?_e.get(t):t,!1===this.context.include)return t.name;t instanceof Je?r=this.includes.functions:t instanceof Ze?r=this.includes.consts:t instanceof fn&&(r=this.includes.structs);var o=r[this.shader]=r[this.shader]||[];if(t){var i=o[t.name];if(i||(i=o[t.name]={node:t,deps:[]},o.push(i),i.src=t.build(this,"source")),t instanceof Je&&e&&o[e.name]&&-1==o[e.name].deps.indexOf(t)&&(o[e.name].deps.push(t),t.includes&&t.includes.length)){var u=0;do{this.include(t.includes[u++],e)}while(u<t.includes.length)}return n&&(i.src=n),t.name}throw new Error("Include not found.")}},{key:"colorToVectorProperties",value:function(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}},{key:"colorToVector",value:function(t){return t.replace(/c/g,"v3")}},{key:"getIncludes",value:function(t,e){return this.includes[t][e||this.shader]}},{key:"getIncludesCode",value:function(t,e){var n=this.getIncludes(t,e);if(!n)return"";var r="";n=n.sort(si);for(var o=0;o<n.length;o++)n[o].src&&(r+=n[o].src+"\n");return r}},{key:"getConstructorFromLength",value:function(t){return ai[t-1]}},{key:"isTypeMatrix",value:function(t){return/^m/.test(t)}},{key:"getTypeLength",value:function(t){return"f"===t?1:parseInt(this.colorToVector(t).substr(1))}},{key:"getTypeFromLength",value:function(t){return 1===t?"f":"v"+t}},{key:"findNode",value:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];if(void 0!==e&&e.isNode)return e}}},{key:"resolve",value:function(){for(var e=0;e<arguments.length;e++){var n=arguments[e];if(void 0!==n){if(n.isNode)return n;if(n.isTexture)switch(n.mapping){case t.CubeReflectionMapping:case t.CubeRefractionMapping:return new io(n);case t.CubeUVReflectionMapping:case t.CubeUVRefractionMapping:return new oi(new Sr(n));default:return new Sr(n)}else{if(n.isVector2)return new An(n);if(n.isVector3)return new In(n);if(n.isVector4)return new Vn(n)}}}}},{key:"format",value:function(t,e,n){switch(this.colorToVector(n+" <- "+e)){case"f <- v2":case"f <- v3":case"f <- v4":return t+".x";case"f <- i":case"f <- b":return"float( "+t+" )";case"v2 <- f":return"vec2( "+t+" )";case"v2 <- v3":case"v2 <- v4":return t+".xy";case"v2 <- i":case"v2 <- b":case"v3 <- i":case"v3 <- b":return"vec2( float( "+t+" ) )";case"v3 <- f":return"vec3( "+t+" )";case"v3 <- v2":return"vec3( "+t+", 0.0 )";case"v3 <- v4":return t+".xyz";case"v4 <- f":return"vec4( "+t+" )";case"v4 <- v2":return"vec4( "+t+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+t+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+t+" ) )";case"i <- f":case"i <- b":return"int( "+t+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+t+".x )";case"b <- f":return"( "+t+" != 0.0 )";case"b <- v2":return"( "+t+" != vec2( 0.0 ) )";case"b <- v3":return"( "+t+" != vec3( 0.0 ) )";case"b <- v4":return"( "+t+" != vec4( 0.0 ) )";case"b <- i":return"( "+t+" != 0 )"}return t}},{key:"getTypeByFormat",value:function(t){return ci[t]||t}},{key:"getFormatByType",value:function(t){return fi[t]||t}},{key:"getUuid",value:function(t,e){return(e=void 0===e||e)&&this.cache&&(t=this.cache+"-"+t),t}},{key:"getElementByIndex",value:function(t){return ui[t]}},{key:"getIndexByElement",value:function(t){return ui.indexOf(t)}},{key:"isShader",value:function(t){return this.shader===t}},{key:"setShader",value:function(t){return this.shader=t,this}},{key:"mergeDefines",value:function(t){for(var e in t)this.defines[e]=t[e];return this.defines}},{key:"mergeUniform",value:function(t){for(var e in t)this.uniforms[e]=t[e];return this.uniforms}},{key:"getTextureEncodingFromMap",value:function(e){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=t.LinearEncoding,n===t.LinearEncoding&&this.context.gamma&&(n=t.sRGBEncoding),n}}],r&&ii(n.prototype,r),o&&ii(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();function si(t,e){return t.deps.length-e.deps.length}function pi(t){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pi(t)}function hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yi(){return yi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=di(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},yi.apply(this,arguments)}function di(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=gi(t)););return t}function vi(t,e){return vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},vi(t,e)}function bi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=gi(t);if(e){var o=gi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mi(this,n)}}function mi(t,e){if(e&&("object"===pi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function gi(t){return gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},gi(t)}var _i=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vi(t,e)}(u,e);var n,r,o,i=bi(u);function u(e,n,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,"c")).value=e instanceof t.Color?e:new t.Color(e||0,n,r),o}return n=u,(r=[{key:"generateReadonly",value:function(t,e,n,r){return t.format("vec3( "+this.r+", "+this.g+", "+this.b+" )",r,e)}},{key:"copy",value:function(t){return yi(gi(u.prototype),"copy",this).call(this,t),this.value.copy(t),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).r=this.r,e.g=this.g,e.b=this.b,!0===this.readonly&&(e.readonly=!0)),e}}])&&hi(n.prototype,r),o&&hi(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(mn);function wi(t){return wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wi(t)}function xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Oi(){return Oi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Pi(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Oi.apply(this,arguments)}function Pi(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ji(t)););return t}function Si(t,e){return Si=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Si(t,e)}function Ti(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ji(t);if(e){var o=ji(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ai(this,n)}}function Ai(t,e){if(e&&("object"===wi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ji(t){return ji=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ji(t)}_i.prototype.nodeType="Color",ge.addShortcuts(_i.prototype,"value",["r","g","b"]);var Ri=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Si(t,e)}(i,t);var e,n,r,o=Ti(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"v4")).value=t,e}return e=i,(n=[{key:"generate",value:function(t){var e=this.value.analyzeAndFlow(t,this.type),n=e.code+"\n";return t.isShader("vertex")?n+="gl_Position = "+e.result+";":n+="gl_FragColor = "+e.result+";",n}},{key:"copy",value:function(t){return Oi(ji(i.prototype),"copy",this).call(this,t),this.value=t.value,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid),e}}])&&xi(e.prototype,n),r&&xi(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(xe);function Ni(t){return Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ni(t)}function Fi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ei(t,e){return Ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ei(t,e)}function Li(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ci(t);if(e){var o=Ci(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ki(this,n)}}function ki(t,e){if(e&&("object"===Ni(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ci(t){return Ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ci(t)}Ri.prototype.nodeType="Raw";var Ii=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ei(t,e)}(u,e);var n,r,o,i=Li(u);function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this)).vertex=t||new Ri(new kr(kr.PROJECTION)),n.fragment=e||new Ri(new _i(16711680)),n.updaters=[],n.type="NodeMaterial",n}return n=u,r=[{key:"properties",get:function(){return this.fragment.properties}},{key:"needsUpdate",get:function(){return this.needsCompile},set:function(t){!0===t&&this.version++,this.needsCompile=t}},{key:"onBeforeCompile",value:function(t,e){this.build({renderer:e}),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.extensionDerivatives=!0===this.extensions.derivatives,t.extensionFragDepth=!0===this.extensions.fragDepth,t.extensionDrawBuffers=!0===this.extensions.drawBuffers,t.extensionShaderTextureLOD=!0===this.extensions.shaderTextureLOD}},{key:"customProgramCacheKey",value:function(){return this.getHash()}},{key:"getHash",value:function(){var t="{";return t+='"vertex":'+this.vertex.getHash()+",",t+='"fragment":'+this.fragment.getHash(),t+="}"}},{key:"updateFrame",value:function(t){for(var e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])}},{key:"build",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.builder||new li;return n.setMaterial(this,e.renderer),n.build(this.vertex,this.fragment),this.vertexShader=n.getCode("vertex"),this.fragmentShader=n.getCode("fragment"),this.defines=n.defines,this.uniforms=n.uniforms,this.extensions=n.extensions,this.updaters=n.updaters,this.fog=n.requires.fog,this.lights=n.requires.lights,this.transparent=n.requires.transparent||this.blending>t.NormalBlending,this}},{key:"copy",value:function(t){var e=this.uuid;for(var n in t)this[n]=t[n];return this.uuid=e,void 0!==t.userData&&(this.userData=JSON.parse(JSON.stringify(t.userData))),this}},{key:"toJSON",value:function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.materials&&(e.materials={}),!e.materials[this.uuid]){var n={};n.uuid=this.uuid,n.type=this.type,e.materials[n.uuid]=n,""!==this.name&&(n.name=this.name),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==t.NormalBlending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==t.FrontSide&&(n.side=this.side),this.vertexColors!==t.NoColors&&(n.vertexColors=this.vertexColors),this.depthFunc!==t.LessEqualDepth&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.fog=this.fog,n.lights=this.lights,n.vertex=this.vertex.toJSON(e).uuid,n.fragment=this.fragment.toJSON(e).uuid}return e.material=this.uuid,e}}],r&&Fi(n.prototype,r),o&&Fi(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(t.ShaderMaterial);function Ui(t){return Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ui(t)}function Di(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Mi(t,e){return Mi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Mi(t,e)}function zi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Xi(t);if(e){var o=Xi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bi(this,n)}}function Bi(t,e){if(e&&("object"===Ui(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Xi(t){return Xi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Xi(t)}Ii.prototype.isNodeMaterial=!0;var Ji=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mi(t,e)}(i,t);var e,n,r,o=zi(i);function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,void 0,t)}return e=i,(n=[{key:"getUnique",value:function(){return!0}},{key:"getTexture",value:function(t,e){return mn.prototype.generate.call(this,t,e,this.getUuid(),"t","renderTexture")}}])&&Di(e.prototype,n),r&&Di(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Sr);function Qi(t){return Qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qi(t)}function Vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yi(){return Yi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Hi(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Yi.apply(this,arguments)}function Hi(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ki(t)););return t}function Wi(t,e){return Wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Wi(t,e)}function Gi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ki(t);if(e){var o=Ki(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qi(this,n)}}function qi(t,e){if(e&&("object"===Qi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ki(t){return Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ki(t)}Ji.prototype.nodeType="Screen";var $i=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wi(t,e)}(u,e);var n,r,o,i=Gi(u);function u(){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this)).name="",e.uuid=t.MathUtils.generateUUID(),e.userData={},e.textureID="renderTexture",e.input=new Ji,e.material=new Ii,e.needsUpdate=!0,e}return n=u,r=[{key:"render",value:function(){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.input,this.needsUpdate=!1),this.uniforms=this.material.uniforms,Yi(Ki(u.prototype),"render",this).apply(this,arguments)}},{key:"copy",value:function(t){return this.input=t.input,this}},{key:"toJSON",value:function(t){if((void 0===t||"string"==typeof t)&&(t={nodes:{}}),t&&!t.passes&&(t.passes={}),!t.passes[this.uuid]){var e={};e.uuid=this.uuid,e.type="NodePass",t.passes[this.uuid]=e,""!==this.name&&(e.name=this.name),"{}"!==JSON.stringify(this.userData)&&(e.userData=this.userData),e.input=this.input.toJSON(t).uuid}return t.pass=this.uuid,t}}],r&&Vi(n.prototype,r),o&&Vi(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(Yt);function Zi(t){return Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zi(t)}function tu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eu(){return eu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=nu(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},eu.apply(this,arguments)}function nu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=uu(t)););return t}function ru(t,e){return ru=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ru(t,e)}function ou(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=uu(t);if(e){var o=uu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iu(this,n)}}function iu(t,e){if(e&&("object"===Zi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function uu(t){return uu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},uu(t)}function au(t){return au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(t)}function cu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fu(){return fu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=lu(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},fu.apply(this,arguments)}function lu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yu(t)););return t}function su(t,e){return su=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},su(t,e)}function pu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=yu(t);if(e){var o=yu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hu(this,n)}}function hu(t,e){if(e&&("object"===au(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function yu(t){return yu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},yu(t)}function du(t){return du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},du(t)}function vu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bu(){return bu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=mu(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},bu.apply(this,arguments)}function mu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xu(t)););return t}function gu(t,e){return gu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},gu(t,e)}function _u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=xu(t);if(e){var o=xu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wu(this,n)}}function wu(t,e){if(e&&("object"===du(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function xu(t){return xu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},xu(t)}function Ou(t){return Ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ou(t)}function Pu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Su(){return Su="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Tu(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Su.apply(this,arguments)}function Tu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Nu(t)););return t}function Au(t,e){return Au=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Au(t,e)}function ju(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Nu(t);if(e){var o=Nu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ru(this,n)}}function Ru(t,e){if(e&&("object"===Ou(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Nu(t){return Nu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Nu(t)}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ru(t,e)}(i,t);var e,n,r,o=ou(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,t)).value=e,n}return e=i,(n=[{key:"getType",value:function(t){return t.getTypeByFormat(this.type)}},{key:"generate",value:function(t,e){var n=t.getVar(this.uuid,this.type);return this.value&&t.isShader("vertex")&&t.addNodeCode(n.name+" = "+this.value.build(t,this.getType(t))+";"),t.format(n.name,this.getType(t),e)}},{key:"copy",value:function(t){return eu(uu(i.prototype),"copy",this).call(this,t),this.type=t.type,this.value=t.value,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).type=this.type,this.value&&(e.value=this.value.toJSON(t).uuid)),e}}])&&tu(e.prototype,n),r&&tu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i})(xe).prototype.nodeType="Var",function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&su(t,e)}(i,t);var e,n,r,o=pu(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e)).name=t,n}return e=i,(n=[{key:"getAttributeType",value:function(t){return"number"==typeof this.type?t.getConstructorFromLength(this.type):this.type}},{key:"getType",value:function(t){var e=this.getAttributeType(t);return t.getTypeByFormat(e)}},{key:"generate",value:function(t,e){var n=this.getAttributeType(t),r=t.getAttribute(this.name,n),o=t.isShader("vertex")?this.name:r.varying.name;return t.format(o,this.getType(t),e)}},{key:"copy",value:function(t){return fu(yu(i.prototype),"copy",this).call(this,t),this.type=t.type,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).type=this.type),e}}])&&cu(e.prototype,n),r&&cu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(xe).prototype.nodeType="Attribute",function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gu(t,e)}(i,t);var e,n,r,o=_u(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"b")).value=Boolean(t),e}return e=i,(n=[{key:"generateReadonly",value:function(t,e,n,r){return t.format(this.value,r,e)}},{key:"copy",value:function(t){return bu(xu(i.prototype),"copy",this).call(this,t),this.value=t.value,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value,!0===this.readonly&&(e.readonly=!0)),e}}])&&vu(e.prototype,n),r&&vu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(mn).prototype.nodeType="Bool";var Fu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Au(t,e)}(i,t);var e,n,r,o=ju(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"i")).value=Math.floor(t||0),e}return e=i,(n=[{key:"generateReadonly",value:function(t,e,n,r){return t.format(this.value,r,e)}},{key:"copy",value:function(t){return Su(Nu(i.prototype),"copy",this).call(this,t),this.value=t.value,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value,!0===this.readonly&&(e.readonly=!0)),e}}])&&Pu(e.prototype,n),r&&Pu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(mn);function Eu(t){return Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(t)}function Lu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ku(){return ku="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Cu(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ku.apply(this,arguments)}function Cu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mu(t)););return t}function Iu(t,e){return Iu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Iu(t,e)}function Uu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Mu(t);if(e){var o=Mu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Du(this,n)}}function Du(t,e){if(e&&("object"===Eu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Mu(t){return Mu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Mu(t)}Fu.prototype.nodeType="Int";var zu=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Iu(t,e)}(u,e);var n,r,o,i=Uu(u);function u(e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,"m3")).value=e||new t.Matrix3,n}return n=u,(r=[{key:"elements",get:function(){return this.value.elements},set:function(t){this.value.elements=t}},{key:"generateReadonly",value:function(t,e,n,r){return t.format("mat3( "+this.value.elements.join(", ")+" )",r,e)}},{key:"copy",value:function(t){return ku(Mu(u.prototype),"copy",this).call(this,t),this.value.fromArray(t.elements),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).elements=this.value.elements.concat()),e}}])&&Lu(n.prototype,r),o&&Lu(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(mn);function Bu(t){return Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(t)}function Xu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ju(){return Ju="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Qu(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ju.apply(this,arguments)}function Qu(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Wu(t)););return t}function Vu(t,e){return Vu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Vu(t,e)}function Yu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Wu(t);if(e){var o=Wu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hu(this,n)}}function Hu(t,e){if(e&&("object"===Bu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Wu(t){return Wu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Wu(t)}zu.prototype.nodeType="Matrix3";var Gu=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vu(t,e)}(u,e);var n,r,o,i=Yu(u);function u(e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,"m4")).value=e||new t.Matrix4,n}return n=u,(r=[{key:"elements",get:function(){return this.value.elements},set:function(t){this.value.elements=t}},{key:"generateReadonly",value:function(t,e,n,r){return t.format("mat4( "+this.value.elements.join(", ")+" )",r,e)}},{key:"copy",value:function(t){return Ju(Wu(u.prototype),"copy",this).call(this,t),this.scope.value.fromArray(t.elements),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).elements=this.value.elements.concat()),e}}])&&Xu(n.prototype,r),o&&Xu(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(mn);function qu(t){return qu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(t)}function Ku(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $u(t,e){return $u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},$u(t,e)}function Zu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ea(t);if(e){var o=ea(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ta(this,n)}}function ta(t,e){if(e&&("object"===qu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ea(t){return ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ea(t)}function na(t){return na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},na(t)}function ra(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oa(t,e){return oa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},oa(t,e)}function ia(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=aa(t);if(e){var o=aa(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ua(this,n)}}function ua(t,e){if(e&&("object"===na(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function aa(t){return aa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},aa(t)}Gu.prototype.nodeType="Matrix4",function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$u(t,e)}(i,t);var e,n,r,o=Zu(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),e=o.call(this,"v4"),t&&e.setMirror(t),e}return e=i,(n=[{key:"setMirror",value:function(t){this.mirror=t,this.textureMatrix=new Gu(this.mirror.material.uniforms.textureMatrix.value),this.localPosition=new kr(kr.LOCAL),this.uv=new Lo(this.textureMatrix,this.localPosition,Lo.MUL),this.uvResult=new Lo(null,this.uv,Lo.ADD),this.texture=new Sr(this.mirror.material.uniforms.tDiffuse.value,this.uv,null,!0)}},{key:"generate",value:function(t,e){return t.isShader("fragment")?(this.uvResult.a=this.offset,this.texture.uv=this.offset?this.uvResult:this.uv,"sampler2D"===e?this.texture.build(t,e):t.format(this.texture.build(t,this.type),this.type,e)):(console.warn("THREE.ReflectorNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.type,e))}},{key:"copy",value:function(t){return mn.prototype.copy.call(this,t),this.scope.mirror=t.mirror,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).mirror=this.mirror.uuid,this.offset&&(e.offset=this.offset.toJSON(t).uuid)),e}}])&&Ku(e.prototype,n),r&&Ku(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee).prototype.nodeType="Reflector";var ca=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oa(t,e)}(i,t);var e,n,r,o=ia(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this,n)).object=t,r.property=e,r}return e=i,(n=[{key:"value",get:function(){return this.object[this.property]},set:function(t){this.object[this.property]=t}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value,e.property=this.property),e}}])&&ra(e.prototype,n),r&&ra(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(mn);function fa(t){return fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fa(t)}function la(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pa(){return pa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=ha(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},pa.apply(this,arguments)}function ha(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ba(t)););return t}function ya(t,e){return ya=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ya(t,e)}function da(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ba(t);if(e){var o=ba(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return va(this,n)}}function va(t,e){if(e&&("object"===fa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ba(t){return ba=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ba(t)}ca.prototype.nodeType="Property";var ma=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ya(t,e)}(u,e);var n,r,o,i=da(u);function u(e,n,r){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};la(this,u);var c=new t.WebGLRenderTarget(e,n,a);return(o=i.call(this,c.texture)).input=r,o.clear=void 0===a.clear||a.clear,o.renderTarget=c,o.material=new Ii,o.camera=new t.OrthographicCamera(-1,1,1,-1,0,1),o.scene=new t.Scene,o.quad=new t.Mesh(new t.PlaneGeometry(2,2),o.material),o.quad.frustumCulled=!1,o.scene.add(o.quad),o.render=!0,o}return n=u,r=[{key:"build",value:function(t,e,n){var r=new li;return r.nodes=t.nodes,r.updaters=t.updaters,this.material.fragment.value=this.input,this.material.build({builder:r}),pa(ba(u.prototype),"build",this).call(this,t,e,n)}},{key:"updateFramesaveTo",value:function(e){if(this.saveTo.render=!1,this.saveTo!==this.saveToCurrent){this.saveToMaterial&&this.saveToMaterial.dispose();var n=new Ii;n.fragment.value=this,n.build();var r=new t.Scene,o=new t.Mesh(new t.PlaneGeometry(2,2),n);o.frustumCulled=!1,r.add(o),this.saveToScene=r,this.saveToMaterial=n}this.saveToCurrent=this.saveTo,e.renderer.setRenderTarget(this.saveTo.renderTarget),this.saveTo.clear&&e.renderer.clear(),e.renderer.render(this.saveToScene,this.camera)}},{key:"updateFrame",value:function(t){t.renderer?(this.saveTo&&!1===this.saveTo.render&&this.updateFramesaveTo(t),this.render&&(this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=t.renderTexture),t.renderer.setRenderTarget(this.renderTarget),this.clear&&t.renderer.clear(),t.renderer.render(this.scene,this.camera)),this.saveTo&&!0===this.saveTo.render&&this.updateFramesaveTo(t)):console.warn("RTTNode need a renderer in NodeFrame")}},{key:"copy",value:function(t){return pa(ba(u.prototype),"copy",this).call(this,t),this.saveTo=t.saveTo,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||(e=pa(ba(u.prototype),"toJSON",this).call(this,t),this.saveTo&&(e.saveTo=this.saveTo.toJSON(t).uuid)),e}}],r&&sa(n.prototype,r),o&&sa(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(Sr);function ga(t){return ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ga(t)}function _a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wa(){return wa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=xa(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},wa.apply(this,arguments)}function xa(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ta(t)););return t}function Oa(t,e){return Oa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Oa(t,e)}function Pa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ta(t);if(e){var o=Ta(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Sa(this,n)}}function Sa(t,e){if(e&&("object"===ga(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ta(t){return Ta=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ta(t)}ma.prototype.nodeType="RTT";var Aa=["color","color2"],ja=["vColor","vColor2"];function Ra(t){return Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ra(t)}function Na(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fa(){return Fa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Ea(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Fa.apply(this,arguments)}function Ea(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ia(t)););return t}function La(t,e){return La=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},La(t,e)}function ka(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ia(t);if(e){var o=Ia(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ca(this,n)}}function Ca(t,e){if(e&&("object"===Ra(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ia(t){return Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ia(t)}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Oa(t,e)}(i,t);var e,n,r,o=Pa(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"v4",{shared:!1})).index=t||0,e}return e=i,(n=[{key:"generate",value:function(t,e){t.requires.color[this.index]=!0;var n=t.isShader("vertex")?Aa[this.index]:ja[this.index];return t.format(n,this.getType(t),e)}},{key:"copy",value:function(t){return wa(Ta(i.prototype),"copy",this).call(this,t),this.index=t.index,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).index=this.index),e}}])&&_a(e.prototype,n),r&&_a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i})(Ee).prototype.nodeType="Colors";var Ua=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&La(t,e)}(i,t);var e,n,r,o=ka(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,"v3")).setScope(t||i.POSITION),n.setCamera(e),n}return e=i,n=[{key:"setCamera",value:function(t){this.camera=t,this.updateFrame=void 0!==t?this.onUpdateFrame:void 0}},{key:"setScope",value:function(t){if(this.scope===i.DEPTH&&(delete this.near,delete this.far),this.scope=t,t===i.DEPTH){var e=this.camera;this.near=new yo(e?e.near:1),this.far=new yo(e?e.far:1200)}}},{key:"getType",value:function(){return this.scope===i.DEPTH?"f":this.type}},{key:"getUnique",value:function(){switch(this.scope){case i.DEPTH:case i.TO_VERTEX:return!0}return!1}},{key:"getShared",value:function(){return this.scope!==i.POSITION}},{key:"generate",value:function(t,e){var n;switch(this.scope){case i.POSITION:n="cameraPosition";break;case i.DEPTH:n=t.include(i.Nodes.depthColor)+"( "+this.near.build(t,"f")+", "+this.far.build(t,"f")+" )";break;case i.TO_VERTEX:n="normalize( "+new kr(kr.WORLD).build(t,"v3")+" - cameraPosition )"}return t.format(n,this.getType(t),e)}},{key:"onUpdateFrame",value:function(){if(this.scope===i.DEPTH){var t=this.camera;this.near.value=t.near,this.far.value=t.far}}},{key:"copy",value:function(t){return Fa(Ia(i.prototype),"copy",this).call(this,t),this.setScope(t.scope),t.camera&&this.setCamera(t.camera),t.scope===i.DEPTH&&(this.near.number=t.near,this.far.number=t.far),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope,this.camera&&(e.camera=this.camera.uuid),this.scope!==i.DEPTH)||(e.near=this.near.value,e.far=this.far.value),e}}],n&&Na(e.prototype,n),r&&Na(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Da(t){return Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Da(t)}function Ma(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function za(){return za="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Ba(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},za.apply(this,arguments)}function Ba(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Va(t)););return t}function Xa(t,e){return Xa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Xa(t,e)}function Ja(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Va(t);if(e){var o=Va(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Qa(this,n)}}function Qa(t,e){if(e&&("object"===Da(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Va(t){return Va=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Va(t)}Ua.Nodes={depthColor:new Je("\n\t\tfloat depthColor( float mNear, float mFar ) {\n\n\t\t\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\t\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t\t\t#else\n\n\t\t\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t\t\t#endif\n\n\t\t\treturn 1.0 - smoothstep( mNear, mFar, depth );\n\n\t\t}")},Ua.POSITION="position",Ua.DEPTH="depth",Ua.TO_VERTEX="toVertex",Ua.prototype.nodeType="Camera";var Ya=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xa(t,e)}(i,t);var e,n,r,o=Ja(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"v3",{shared:!1})).scope=t||i.TOTAL,e}return e=i,(n=[{key:"generate",value:function(t,e){return t.isCache("light")?t.format("reflectedLight.directDiffuse",this.type,e):(console.warn('THREE.LightNode is only compatible in "light" channel.'),t.format("vec3( 0.0 )",this.type,e))}},{key:"copy",value:function(t){return za(Va(i.prototype),"copy",this).call(this,t),this.scope=t.scope,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).scope=this.scope),e}}])&&Ma(e.prototype,n),r&&Ma(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Ha(t){return Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ha(t)}function Wa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ga(){return Ga="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=qa(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ga.apply(this,arguments)}function qa(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tc(t)););return t}function Ka(t,e){return Ka=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ka(t,e)}function $a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=tc(t);if(e){var o=tc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Za(this,n)}}function Za(t,e){if(e&&("object"===Ha(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function tc(t){return tc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},tc(t)}Ya.TOTAL="total",Ya.prototype.nodeType="Light";var ec=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ka(t,e)}(u,e);var n,r,o,i=$a(u);function u(){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this)).size=new t.Vector2,e}return n=u,(r=[{key:"updateFrame",value:function(t){if(t.renderer){t.renderer.getSize(this.size);var e=t.renderer.getPixelRatio();this.x=this.size.width*e,this.y=this.size.height*e}else console.warn("ResolutionNode need a renderer in NodeFrame")}},{key:"copy",value:function(t){return Ga(tc(u.prototype),"copy",this).call(this,t),this.renderer=t.renderer,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).renderer=this.renderer.uuid),e}}])&&Wa(n.prototype,r),o&&Wa(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(An);function nc(t){return nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nc(t)}function rc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oc(){return oc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=ic(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},oc.apply(this,arguments)}function ic(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fc(t)););return t}function uc(t,e){return uc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},uc(t,e)}function ac(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=fc(t);if(e){var o=fc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cc(this,n)}}function cc(t,e){if(e&&("object"===nc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function fc(t){return fc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},fc(t)}function lc(t){return lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lc(t)}function sc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pc(){return pc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=hc(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},pc.apply(this,arguments)}function hc(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bc(t)););return t}function yc(t,e){return yc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},yc(t,e)}function dc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=bc(t);if(e){var o=bc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vc(this,n)}}function vc(t,e){if(e&&("object"===lc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function bc(t){return bc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},bc(t)}ec.prototype.nodeType="Resolution",function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uc(t,e)}(i,t);var e,n,r,o=ac(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"v2")).resolution=t||new ec,e}return e=i,(n=[{key:"generate",value:function(t,e){var n;return t.isShader("fragment")?n="( gl_FragCoord.xy / "+this.resolution.build(t,"v2")+")":(console.warn("THREE.ScreenUVNode is not compatible with "+t.shader+" shader."),n="vec2( 0.0 )"),t.format(n,this.getType(t),e)}},{key:"copy",value:function(t){return oc(fc(i.prototype),"copy",this).call(this,t),this.resolution=t.resolution,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).resolution=this.resolution.toJSON(t).uuid),e}}])&&rc(e.prototype,n),r&&rc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee).prototype.nodeType="ScreenUV";var mc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yc(t,e)}(i,t);var e,n,r,o=dc(i);function i(t,e,n,r,u){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(a=o.call(this)).a=t,a.b=e,a.op=n,a.ifNode=r,a.elseNode=u,a}return e=i,(n=[{key:"getType",value:function(t){if(this.ifNode){var e=this.ifNode.getType(t),n=this.elseNode.getType(t);return t.getTypeLength(n)>t.getTypeLength(e)?n:e}return"b"}},{key:"getCondType",value:function(t){return t.getTypeLength(this.b.getType(t))>t.getTypeLength(this.a.getType(t))?this.b.getType(t):this.a.getType(t)}},{key:"generate",value:function(t,e){var n,r=this.getType(t),o=this.getCondType(t),i=this.a.build(t,o),u=this.b.build(t,o);if(this.ifNode){var a=this.ifNode.build(t,r),c=this.elseNode.build(t,r);n="( "+[i,this.op,u,"?",a,":",c].join(" ")+" )"}else n="( "+i+" "+this.op+" "+u+" )";return t.format(n,this.getType(t),e)}},{key:"copy",value:function(t){return pc(bc(i.prototype),"copy",this).call(this,t),this.a=t.a,this.b=t.b,this.op=t.op,this.ifNode=t.ifNode,this.elseNode=t.elseNode,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).a=this.a.toJSON(t).uuid,e.b=this.b.toJSON(t).uuid,e.op=this.op,e.ifNode&&(e.ifNode=this.ifNode.toJSON(t).uuid),e.elseNode&&(e.elseNode=this.elseNode.toJSON(t).uuid)),e}}])&&sc(e.prototype,n),r&&sc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function gc(t){return gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gc(t)}function _c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xc(){return xc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Oc(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},xc.apply(this,arguments)}function Oc(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ac(t)););return t}function Pc(t,e){return Pc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Pc(t,e)}function Sc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ac(t);if(e){var o=Ac(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tc(this,n)}}function Tc(t,e){if(e&&("object"===gc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ac(t){return Ac=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ac(t)}mc.EQUAL="==",mc.NOT_EQUAL="!=",mc.GREATER=">",mc.GREATER_EQUAL=">=",mc.LESS="<",mc.LESS_EQUAL="<=",mc.AND="&&",mc.OR="||",mc.prototype.nodeType="Cond";var jc,Rc,Nc="\nvec3 mod289( vec3 x ) {\n\n\treturn x - floor( x * ( 1.0 / 289.0 ) ) * 289.0;\n\n}\n\nvec4 mod289( vec4 x ) {\n\n\treturn x - floor( x * ( 1.0 / 289.0 ) ) * 289.0;\n\n}\n\nvec4 permute( vec4 x ) {\n\n\treturn mod289( ( ( x * 34.0 ) + 1.0 ) * x );\n\n}\n\nvec4 taylorInvSqrt( vec4 r ) {\n\n\treturn 1.79284291400159 - 0.85373472095314 * r;\n\n}\n\nvec2 fade( vec2 t ) {\n\n\treturn t * t * t * ( t * ( t * 6.0 - 15.0 ) + 10.0 );\n\n}\n\nvec3 fade( vec3 t ) {\n\n\treturn t * t * t * ( t * ( t * 6.0 - 15.0 ) + 10.0 );\n\n}\n".trim(),Fc="\nfloat noise2d( vec2 P, float amplitude, float pivot ) {\n\n\tvec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n\tvec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n\tPi = mod289(Pi); // To avoid truncation effects in permutation\n\tvec4 ix = Pi.xzxz;\n\tvec4 iy = Pi.yyww;\n\tvec4 fx = Pf.xzxz;\n\tvec4 fy = Pf.yyww;\n\n\tvec4 i = permute(permute(ix) + iy);\n\n\tvec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;\n\tvec4 gy = abs(gx) - 0.5 ;\n\tvec4 tx = floor(gx + 0.5);\n\tgx = gx - tx;\n\n\tvec2 g00 = vec2(gx.x,gy.x);\n\tvec2 g10 = vec2(gx.y,gy.y);\n\tvec2 g01 = vec2(gx.z,gy.z);\n\tvec2 g11 = vec2(gx.w,gy.w);\n\n\tvec4 norm = taylorInvSqrt(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\n\tg00 *= norm.x;\n\tg01 *= norm.y;\n\tg10 *= norm.z;\n\tg11 *= norm.w;\n\n\tfloat n00 = dot(g00, vec2(fx.x, fy.x));\n\tfloat n10 = dot(g10, vec2(fx.y, fy.y));\n\tfloat n01 = dot(g01, vec2(fx.z, fy.z));\n\tfloat n11 = dot(g11, vec2(fx.w, fy.w));\n\n\tvec2 fade_xy = fade(Pf.xy);\n\tvec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n\tfloat n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n\treturn 2.3 * n_xy * amplitude + pivot;\n\n}\n".trim(),Ec=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pc(t,e)}(i,t);var e,n,r,o=Sc(i);function i(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yo(1),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yo(0);return _c(this,i),(t=o.call(this,"f")).uv=e,t.amplitude=n,t.pivot=r,t}return e=i,(n=[{key:"generate",value:function(t,e){var n=new Po(i.Nodes.noise2d,[this.uv,this.amplitude,this.pivot]);return t.format(n.generate(t,e),this.getType(t),e)}},{key:"copy",value:function(t){xc(Ac(i.prototype),"copy",this).call(this,t),this.uv=t.uv,this.amplitude=t.amplitude,this.pivot=t.pivot}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).uv=this.uv.toJSON(t).uuid,e.amplitude=this.amplitude.toJSON(t).uuid,e.pivot=this.pivot.toJSON(t).uuid),e}}])&&wc(e.prototype,n),r&&wc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Lc(t){return Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(t)}function kc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ic(){return Ic="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Uc(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ic.apply(this,arguments)}function Uc(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bc(t)););return t}function Dc(t,e){return Dc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Dc(t,e)}function Mc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Bc(t);if(e){var o=Bc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zc(this,n)}}function zc(t,e){if(e&&("object"===Lc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Bc(t){return Bc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Bc(t)}Ec.prototype.nodeType="Noise2D",Ec.Nodes=(jc=new Je(Nc),(Rc=new Je(Fc)).includes=[jc],{noiseCommon:jc,noise2d:Rc});var Xc,Jc="\nfloat noise3d( vec3 P, float amplitude, float pivot ) {\n\n\tvec3 Pi0 = floor(P); // Integer part for indexing\n\tvec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n\tPi0 = mod289(Pi0);\n\tPi1 = mod289(Pi1);\n\tvec3 Pf0 = fract(P); // Fractional part for interpolation\n\tvec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n\tvec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n\tvec4 iy = vec4(Pi0.yy, Pi1.yy);\n\tvec4 iz0 = Pi0.zzzz;\n\tvec4 iz1 = Pi1.zzzz;\n\n\tvec4 ixy = permute(permute(ix) + iy);\n\tvec4 ixy0 = permute(ixy + iz0);\n\tvec4 ixy1 = permute(ixy + iz1);\n\n\tvec4 gx0 = ixy0 * (1.0 / 7.0);\n\tvec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n\tgx0 = fract(gx0);\n\tvec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n\tvec4 sz0 = step(gz0, vec4(0.0));\n\tgx0 -= sz0 * (step(0.0, gx0) - 0.5);\n\tgy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n\tvec4 gx1 = ixy1 * (1.0 / 7.0);\n\tvec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n\tgx1 = fract(gx1);\n\tvec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n\tvec4 sz1 = step(gz1, vec4(0.0));\n\tgx1 -= sz1 * (step(0.0, gx1) - 0.5);\n\tgy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n\tvec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n\tvec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n\tvec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n\tvec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n\tvec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n\tvec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n\tvec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n\tvec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n\tvec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n\tg000 *= norm0.x;\n\tg010 *= norm0.y;\n\tg100 *= norm0.z;\n\tg110 *= norm0.w;\n\tvec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n\tg001 *= norm1.x;\n\tg011 *= norm1.y;\n\tg101 *= norm1.z;\n\tg111 *= norm1.w;\n\n\tfloat n000 = dot(g000, Pf0);\n\tfloat n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n\tfloat n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n\tfloat n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n\tfloat n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n\tfloat n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n\tfloat n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n\tfloat n111 = dot(g111, Pf1);\n\n\tvec3 fade_xyz = fade(Pf0);\n\tvec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n\tvec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n\tfloat n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n\treturn 2.2 * n_xyz * amplitude + pivot;\n\n}\n".trim(),Qc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Dc(t,e)}(i,t);var e,n,r,o=Mc(i);function i(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new kr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yo(1),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new yo(0);return kc(this,i),(t=o.call(this,"f")).position=e,t.amplitude=n,t.pivot=r,t}return e=i,(n=[{key:"generate",value:function(t,e){var n=new Po(i.Nodes.noise3d,[this.position,this.amplitude,this.pivot]);return t.format(n.generate(t,e),this.getType(t),e)}},{key:"copy",value:function(t){Ic(Bc(i.prototype),"copy",this).call(this,t),this.position=t.position,this.amplitude=t.amplitude,this.pivot=t.pivot}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).position=this.position.toJSON(t).uuid,e.amplitude=this.amplitude.toJSON(t).uuid,e.pivot=this.pivot.toJSON(t).uuid),e}}])&&Cc(e.prototype,n),r&&Cc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Vc(t){return Vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vc(t)}function Yc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Hc(){return Hc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Wc(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Hc.apply(this,arguments)}function Wc(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$c(t)););return t}function Gc(t,e){return Gc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Gc(t,e)}function qc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=$c(t);if(e){var o=$c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kc(this,n)}}function Kc(t,e){if(e&&("object"===Vc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $c(t){return $c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},$c(t)}Qc.prototype.nodeType="Noise3D",Qc.Nodes=((Xc=new Je(Jc)).includes=[Ec.Nodes.noiseCommon],{noise3d:Xc});var Zc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gc(t,e)}(i,t);var e,n,r,o=qc(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"f")).uv=t||new tr,e}return e=i,(n=[{key:"generate",value:function(t,e){var n=t.include(i.Nodes.checker);return t.format(n+"( "+this.uv.build(t,"v2")+" )",this.getType(t),e)}},{key:"copy",value:function(t){return Hc($c(i.prototype),"copy",this).call(this,t),this.uv=t.uv,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).uv=this.uv.toJSON(t).uuid),e}}])&&Yc(e.prototype,n),r&&Yc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function tf(t){return tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(t)}function ef(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rf(){return rf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=of(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},rf.apply(this,arguments)}function of(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ff(t)););return t}function uf(t,e){return uf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},uf(t,e)}function af(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ff(t);if(e){var o=ff(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cf(this,n)}}function cf(t,e){if(e&&("object"===tf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ff(t){return ff=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ff(t)}Zc.Nodes={checker:new Je("\n\t\tfloat checker( vec2 uv ) {\n\n\t\t\tfloat cx = floor( uv.x );\n\t\t\tfloat cy = floor( uv.y );\n\t\t\tfloat result = mod( cx + cy, 2.0 );\n\n\t\t\treturn sign( result );\n\n\t\t}")},Zc.prototype.nodeType="Noise";var lf,sf="\nfloat fractal3d( vec3 p, float amplitude, int octaves, float lacunarity, float diminish ) {\n\n\tfloat result = 0.0;\n\n\tfor (int i = 0;  i < octaves; ++i) {\n\n\t\tresult += noise3d(p, amplitude, 0.0);\n\t\tamplitude *= diminish;\n\t\tp *= lacunarity;\n\n\t}\n\n\treturn result;\n\n}\n".trim(),pf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uf(t,e)}(i,t);var e,n,r,o=af(i);function i(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new kr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yo(1),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;return ef(this,i),(t=o.call(this,"f")).position=e,t.amplitude=n,t.octaves=new Fu(r).setReadonly(!0),t.lacunarity=new yo(u).setReadonly(!0),t.diminish=new yo(a).setReadonly(!0),t}return e=i,(n=[{key:"generate",value:function(t,e){var n=new Po(i.Nodes.fractal3d,[this.position,this.amplitude,this.octaves,this.lacunarity,this.diminish]);return t.format(n.generate(t,e),this.getType(t),e)}},{key:"copy",value:function(t){rf(ff(i.prototype),"copy",this).call(this,t),this.position=t.position,this.amplitude=t.amplitude,this.octaves=t.octaves,this.lacunarity=t.lacunarity,this.diminish=t.diminish}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).position=this.position.toJSON(t).uuid,e.amplitude=this.amplitude.toJSON(t).uuid,e.octaves=this.octaves.toJSON(t).uuid,e.lacunarity=this.lacunarity.toJSON(t).uuid,e.diminish=this.diminish.toJSON(t).uuid),e}}])&&nf(e.prototype,n),r&&nf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function hf(t){return hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(t)}function yf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function df(){return df="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=vf(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},df.apply(this,arguments)}function vf(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_f(t)););return t}function bf(t,e){return bf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},bf(t,e)}function mf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_f(t);if(e){var o=_f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gf(this,n)}}function gf(t,e){if(e&&("object"===hf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _f(t){return _f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_f(t)}pf.prototype.nodeType="Fractal3D",pf.Nodes=((lf=new Je(sf)).includes=[Qc.Nodes.noise3d],{fractal3d:lf});var wf=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bf(t,e)}(u,e);var n,r,o,i=mf(u);function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,"v3")).value=t,n.scale=e||new An(1,1),n}return n=u,(r=[{key:"generate",value:function(e,n){if(e.isShader("fragment")){var r=e.include(u.Nodes.perturbNormal2Arb);this.normal=this.normal||new Jr,this.position=this.position||new kr(kr.VIEW),this.uv=this.uv||new tr;var o=this.scale.build(e,"v2");return e.material.side===t.BackSide&&(o="-"+o),e.format(r+"( -"+this.position.build(e,"v3")+", "+this.normal.build(e,"v3")+", "+this.value.build(e,"v3")+", "+this.uv.build(e,"v2")+", "+o+" )",this.getType(e),n)}return console.warn("THREE.NormalMapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),n)}},{key:"copy",value:function(t){return df(_f(u.prototype),"copy",this).call(this,t),this.value=t.value,this.scale=t.scale,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid,e.scale=this.scale.toJSON(t).uuid),e}}])&&yf(n.prototype,r),o&&yf(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(Ee);function xf(t){return xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(t)}function Of(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pf(){return Pf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Sf(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Pf.apply(this,arguments)}function Sf(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Rf(t)););return t}function Tf(t,e){return Tf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Tf(t,e)}function Af(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Rf(t);if(e){var o=Rf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jf(this,n)}}function jf(t,e){if(e&&("object"===xf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Rf(t){return Rf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Rf(t)}wf.Nodes={perturbNormal2Arb:new Je("vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 vUv, vec2 normalScale ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = map * 2.0 - 1.0;\n\n\t\tmapN.xy *= normalScale;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t// Workaround for Adreno GPUs gl_FrontFacing bug. See #15850 and #10331\n\n\t\t\tif ( dot( cross( S, T ), N ) < 0.0 ) mapN.xy *= - 1.0;\n\n\t\t#else\n\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}",null,{derivatives:!0})},wf.prototype.nodeType="NormalMap";var Nf,Ff=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tf(t,e)}(i,t);var e,n,r,o=Af(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,"v3")).value=t,n.scale=e||new yo(1),n.toNormalMap=!1,n}return e=i,(n=[{key:"generate",value:function(t,e){if(t.isShader("fragment")){if(this.toNormalMap){var n=t.include(i.Nodes.bumpToNormal);return t.format(n+"( "+this.value.build(t,"sampler2D")+", "+this.value.uv.build(t,"v2")+", "+this.scale.build(t,"f")+" )",this.getType(t),e)}var r=t.include(i.Nodes.dHdxy_fwd),o=t.include(i.Nodes.perturbNormalArb);this.normal=this.normal||new Jr,this.position=this.position||new kr(kr.VIEW);var u=r+"( "+this.value.build(t,"sampler2D")+", "+this.value.uv.build(t,"v2")+", "+this.scale.build(t,"f")+" )";return t.format(o+"( -"+this.position.build(t,"v3")+", "+this.normal.build(t,"v3")+", "+u+" )",this.getType(t),e)}return console.warn("THREE.BumpMapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},{key:"copy",value:function(t){return Pf(Rf(i.prototype),"copy",this).call(this,t),this.value=t.value,this.scale=t.scale,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid,e.scale=this.scale.toJSON(t).uuid),e}}])&&Of(e.prototype,n),r&&Of(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Ef(t){return Ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(t)}function Lf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function kf(){return kf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Cf(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},kf.apply(this,arguments)}function Cf(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mf(t)););return t}function If(t,e){return If=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},If(t,e)}function Uf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Mf(t);if(e){var o=Mf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Df(this,n)}}function Df(t,e){if(e&&("object"===Ef(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Mf(t){return Mf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Mf(t)}function zf(t){return zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zf(t)}function Bf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xf(){return Xf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Jf(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Xf.apply(this,arguments)}function Jf(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hf(t)););return t}function Qf(t,e){return Qf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Qf(t,e)}function Vf(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Hf(t);if(e){var o=Hf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yf(this,n)}}function Yf(t,e){if(e&&("object"===zf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Hf(t){return Hf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Hf(t)}Ff.Nodes={dHdxy_fwd:Nf=new Je("\n\n\t\tvec2 dHdxy_fwd( sampler2D bumpMap, vec2 vUv, float bumpScale ) {\n\n\t\t\tvec2 dSTdx = dFdx( vUv );\n\t\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\t\treturn vec2( dBx, dBy );\n\n\t\t}",null,{derivatives:!0}),perturbNormalArb:new Je("\n\n\t\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\t\tvec3 vN = surf_norm; // normalized\n\n\t\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\n\t\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t\t}",[Nf],{derivatives:!0}),bumpToNormal:new Je("\n\t\tvec3 bumpToNormal( sampler2D bumpMap, vec2 uv, float scale ) {\n\n\t\t\tvec2 dSTdx = dFdx( uv );\n\t\t\tvec2 dSTdy = dFdy( uv );\n\n\t\t\tfloat Hll = texture2D( bumpMap, uv ).x;\n\t\t\tfloat dBx = texture2D( bumpMap, uv + dSTdx ).x - Hll;\n\t\t\tfloat dBy = texture2D( bumpMap, uv + dSTdy ).x - Hll;\n\n\t\t\treturn vec3( .5 - ( dBx * scale ), .5 - ( dBy * scale ), 1.0 );\n\n\t\t}",null,{derivatives:!0})},Ff.prototype.nodeType="BumpMap",Ff.prototype.hashProperties=["toNormalMap"],function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&If(t,e)}(i,t);var e,n,r,o=Uf(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).code=t,n.value=e,n}return e=i,(n=[{key:"getType",value:function(t){return this.value?this.value.getType(t):t.isShader("fragment")?"f":"void"}},{key:"generate",value:function(t,e){var n=this.code.build(t,e)+";";return t.addNodeCode(n),t.isShader("vertex")?this.value?this.value.build(t,e):void 0:this.value?this.value.build(t,e):t.format("0.0","f",e)}},{key:"copy",value:function(t){return kf(Mf(i.prototype),"copy",this).call(this,t),this.code=t.code,this.value=t.value,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).code=this.code.toJSON(t).uuid,this.value&&(e.value=this.value.toJSON(t).uuid)),e}}])&&Lf(e.prototype,n),r&&Lf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(xe).prototype.nodeType="Bypass";var Wf=ge.elements;function Gf(t){return Gf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gf(t)}function qf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kf(){return Kf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=$f(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Kf.apply(this,arguments)}function $f(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=nl(t)););return t}function Zf(t,e){return Zf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Zf(t,e)}function tl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=nl(t);if(e){var o=nl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return el(this,n)}}function el(t,e){if(e&&("object"===Gf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function nl(t){return nl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},nl(t)}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qf(t,e)}(i,t);var e,n,r,o=Vf(i);function i(t,e,n,r){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(u=o.call(this,"f")).x=t,u.y=e,u.z=n,u.w=r,u}return e=i,(n=[{key:"getNumElements",value:function(){for(var t=Wf.length;t--;)if(void 0!==this[Wf[t]]){++t;break}return Math.max(t,2)}},{key:"getType",value:function(t){return t.getTypeFromLength(this.getNumElements())}},{key:"generate",value:function(t,e){for(var n=this.getType(t),r=this.getNumElements(),o=[],i=0;i<r;i++){var u=this[Wf[i]];o.push(u?u.build(t,"f"):"0.0")}var a=(r>1?t.getConstructorFromLength(r):"")+"( "+o.join(", ")+" )";return t.format(a,n,e)}},{key:"copy",value:function(t){for(var e in Xf(Hf(i.prototype),"copy",this).call(this,t),t.inputs)this[e]=t.inputs[e];return this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);if(!e){(e=this.createJSONNode(t)).inputs={};for(var n=this.getNumElements(),r=0;r<n;r++){var o=this[Wf[r]];o&&(e.inputs[Wf[r]]=o.toJSON(t).uuid)}}return e}}])&&Bf(e.prototype,n),r&&Bf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i})(Ee).prototype.nodeType="Join";var rl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zf(t,e)}(i,t);var e,n,r,o=tl(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this)).node=t,n.components=e||"x",n}return e=i,(n=[{key:"getType",value:function(t){return t.getTypeFromLength(this.components.length)}},{key:"generate",value:function(t,e){var n=this.node.getType(t),r=t.getTypeLength(n)-1,o=this.node.build(t,n);if(r>0){var i,u=0,a=t.colorToVectorProperties(this.components),c=a.length;for(i=0;i<c;i++)u=Math.max(u,t.getIndexByElement(a.charAt(i)));for(u>r&&(u=r),o+=".",i=0;i<c;i++){var f=t.getIndexByElement(a.charAt(i));f>u&&(f=u),o+=t.getElementByIndex(f)}return t.format(o,this.getType(t),e)}return t.format(o,n,e)}},{key:"copy",value:function(t){return Kf(nl(i.prototype),"copy",this).call(this,t),this.node=t.node,this.components=t.components,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).node=this.node.toJSON(t).uuid,e.components=this.components),e}}])&&qf(e.prototype,n),r&&qf(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(xe);function ol(t){return ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ol(t)}function il(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ul(){return ul="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=al(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ul.apply(this,arguments)}function al(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sl(t)););return t}function cl(t,e){return cl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},cl(t,e)}function fl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=sl(t);if(e){var o=sl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ll(this,n)}}function ll(t,e){if(e&&("object"===ol(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function sl(t){return sl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},sl(t)}rl.prototype.nodeType="Switch";var pl="\nfloat remap( float value, float inLow, float inHigh, float outLow, float outHigh ) {\n\n\tfloat x = ( value - inLow ) / ( inHigh - inLow );\n\treturn outLow + ( outHigh - outLow ) * x;\n\n}\n\nvec2 remap( vec2 value, vec2 inLow, vec2 inHigh, vec2 outLow, vec2 outHigh ) {\n\n\treturn vec2(\n\t\tremap( value.x, inLow.x, inHigh.x, outLow.x, outHigh.x ),\n\t\tremap( value.y, inLow.y, inHigh.y, outLow.y, outHigh.y )\n\t);\n\n}\n\nvec2 remap( vec2 value, float inLow, float inHigh, float outLow, float outHigh ) {\n\n\treturn vec2(\n\t\tremap( value.x, inLow, inHigh, outLow, outHigh ),\n\t\tremap( value.y, inLow, inHigh, outLow, outHigh )\n\t);\n\n}\n\nvec3 remap( vec3 value, vec3 inLow, vec3 inHigh, vec3 outLow, vec3 outHigh ) {\n\n\treturn vec3(\n\t\tremap( value.x, inLow.x, inHigh.x, outLow.x, outHigh.x ),\n\t\tremap( value.y, inLow.y, inHigh.y, outLow.y, outHigh.y ),\n\t\tremap( value.z, inLow.z, inHigh.z, outLow.z, outHigh.z )\n\t);\n\n}\n\nvec3 remap( vec3 value, float inLow, float inHigh, float outLow, float outHigh ) {\n\n\treturn vec3(\n\t\tremap( value.x, inLow, inHigh, outLow, outHigh ),\n\t\tremap( value.y, inLow, inHigh, outLow, outHigh ),\n\t\tremap( value.z, inLow, inHigh, outLow, outHigh )\n\t);\n\n}\n\nvec4 remap( vec4 value, vec4 inLow, vec4 inHigh, vec4 outLow, vec4 outHigh ) {\n\n\treturn vec4(\n\t\tremap( value.x, inLow.x, inHigh.x, outLow.x, outHigh.x ),\n\t\tremap( value.y, inLow.y, inHigh.y, outLow.y, outHigh.y ),\n\t\tremap( value.z, inLow.z, inHigh.z, outLow.z, outHigh.z ),\n\t\tremap( value.w, inLow.w, inHigh.w, outLow.w, outHigh.w )\n\t);\n\n}\n\nvec4 remap( vec4 value, float inLow, float inHigh, float outLow, float outHigh ) {\n\n\treturn vec4(\n\t\tremap( value.x, inLow, inHigh, outLow, outHigh ),\n\t\tremap( value.y, inLow, inHigh, outLow, outHigh ),\n\t\tremap( value.z, inLow, inHigh, outLow, outHigh ),\n\t\tremap( value.w, inLow, inHigh, outLow, outHigh )\n\t);\n\n}\n".trim(),hl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cl(t,e)}(i,t);var e,n,r,o=fl(i);function i(t,e,n,r,u){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(a=o.call(this,"f")).value=t,a.inLow=e,a.inHigh=n,a.outLow=r,a.outHigh=u,a}return e=i,(n=[{key:"generate",value:function(t,e){var n=t.include(i.Nodes.remap);return t.format(n+"( "+[this.value.build(t),this.inLow.build(t),this.inHigh.build(t),this.outLow.build(t),this.outHigh.build(t)].join(", ")+" )",this.getType(t),e)}},{key:"getType",value:function(t){return this.value.getType(t)}},{key:"copy",value:function(t){ul(sl(i.prototype),"copy",this).call(this,t),this.value=t.value,this.inLow=t.inLow,this.inHigh=t.inHigh,this.outLow=t.outLow,this.outHigh=t.outHigh}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid,e.inLow=this.inLow.toJSON(t).uuid,e.inHigh=this.inHigh.toJSON(t).uuid,e.outLow=this.outLow.toJSON(t).uuid,e.outHigh=this.outHigh.toJSON(t).uuid),e}}])&&il(e.prototype,n),r&&il(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function yl(t){return yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yl(t)}function dl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vl(){return vl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=bl(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},vl.apply(this,arguments)}function bl(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wl(t)););return t}function ml(t,e){return ml=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ml(t,e)}function gl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wl(t);if(e){var o=wl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _l(this,n)}}function _l(t,e){if(e&&("object"===yl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function wl(t){return wl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},wl(t)}hl.prototype.nodeType="Remap",hl.Nodes={remap:new Je(pl)};var xl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ml(t,e)}(i,t);var e,n,r,o=gl(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this)).scale=void 0!==t?t:1,r.scope=e||i.GLOBAL,r.timeScale=void 0!==n?n:void 0!==t,r}return e=i,(n=[{key:"getReadonly",value:function(){return!1}},{key:"getUnique",value:function(){return this.timeScale&&(this.scope===i.GLOBAL||this.scope===i.DELTA)}},{key:"updateFrame",value:function(t){var e=this.timeScale?this.scale:1;switch(this.scope){case i.LOCAL:this.value+=t.delta*e;break;case i.DELTA:this.value=t.delta*e;break;default:this.value=t.time*e}}},{key:"copy",value:function(t){return vl(wl(i.prototype),"copy",this).call(this,t),this.scope=t.scope,this.scale=t.scale,this.timeScale=t.timeScale,this}},{key:"toJSON",value:function(t){var e=vl(wl(i.prototype),"toJSON",this).call(this,t);return e.scope=this.scope,e.scale=this.scale,e.timeScale=this.timeScale,e}}])&&dl(e.prototype,n),r&&dl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(yo);function Ol(t){return Ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ol(t)}function Pl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Sl(){return Sl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Tl(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Sl.apply(this,arguments)}function Tl(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Nl(t)););return t}function Al(t,e){return Al=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Al(t,e)}function jl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Nl(t);if(e){var o=Nl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rl(this,n)}}function Rl(t,e){if(e&&("object"===Ol(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Nl(t){return Nl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Nl(t)}function Fl(t){return Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(t)}function El(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ll(){return Ll="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=kl(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ll.apply(this,arguments)}function kl(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Dl(t)););return t}function Cl(t,e){return Cl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Cl(t,e)}function Il(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Dl(t);if(e){var o=Dl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ul(this,n)}}function Ul(t,e){if(e&&("object"===Fl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Dl(t){return Dl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Dl(t)}function Ml(t){return Ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(t)}function zl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bl(t,e){return Bl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Bl(t,e)}function Xl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ql(t);if(e){var o=Ql(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jl(this,n)}}function Jl(t,e){if(e&&("object"===Ml(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ql(t){return Ql=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ql(t)}xl.GLOBAL="global",xl.LOCAL="local",xl.DELTA="delta",xl.prototype.nodeType="Timer",_e.addKeyword("time",(function(){return new xl})),function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Al(t,e)}(u,e);var n,r,o,i=jl(u);function u(e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(r=i.call(this)).params={},r.velocity=new t.Vector3,r.setTarget(e),r.setParams(n),r}return n=u,(r=[{key:"getReadonly",value:function(){return!1}},{key:"setParams",value:function(e){"elastic"===this.params.type&&(delete this.moment,delete this.speed,delete this.springVelocity,delete this.lastVelocity),this.params=e||{},"elastic"===this.params.type&&(this.moment=new t.Vector3,this.speed=new t.Vector3,this.springVelocity=new t.Vector3,this.lastVelocity=new t.Vector3)}},{key:"setTarget",value:function(e){this.target&&(delete this.position,delete this.oldPosition),this.target=e,e&&(this.position=e.getWorldPosition(this.position||new t.Vector3),this.oldPosition=this.position.clone())}},{key:"updateFrameVelocity",value:function(){this.target&&(this.position=this.target.getWorldPosition(this.position||new t.Vector3),this.velocity.subVectors(this.position,this.oldPosition),this.oldPosition.copy(this.position))}},{key:"updateFrame",value:function(t){if(this.updateFrameVelocity(t),"elastic"===this.params.type){var e=t.delta*(this.params.fps||60),n=Math.pow(this.params.spring,e),r=Math.pow(this.params.damping,e);this.velocity.multiplyScalar(Math.exp(-this.params.damping*e)),this.velocity.add(this.springVelocity),this.velocity.add(this.speed.multiplyScalar(r).multiplyScalar(1-n)),this.speed.subVectors(this.velocity,this.lastVelocity),this.springVelocity.add(this.speed),this.springVelocity.multiplyScalar(n),this.moment.add(this.springVelocity),this.moment.multiplyScalar(r),this.lastVelocity.copy(this.velocity),this.value.copy(this.moment)}else this.value.copy(this.velocity)}},{key:"copy",value:function(t){return Sl(Nl(u.prototype),"copy",this).call(this,t),t.target&&this.setTarget(t.target),this.setParams(t.params),this}},{key:"toJSON",value:function(t){var e=Sl(Nl(u.prototype),"toJSON",this).call(this,t);return this.target&&(e.target=this.target.uuid),e.params=JSON.parse(JSON.stringify(this.params)),e}}])&&Pl(n.prototype,r),o&&Pl(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(In).prototype.nodeType="Velocity",function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cl(t,e)}(i,t);var e,n,r,o=Il(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,"( uvTransform * vec3( uvNode, 1 ) ).xy","vec2")).uv=t||new tr,n.position=e||new zu,n}return e=i,(n=[{key:"generate",value:function(t,e){return this.keywords.uvNode=this.uv,this.keywords.uvTransform=this.position,Ll(Dl(i.prototype),"generate",this).call(this,t,e)}},{key:"setUvTransform",value:function(t,e,n,r,o,i,u){i=void 0!==i?i:.5,u=void 0!==u?u:.5,this.position.value.setUvTransform(t,e,n,r,o,i,u)}},{key:"copy",value:function(t){return Ll(Dl(i.prototype),"copy",this).call(this,t),this.uv=t.uv,this.position=t.position,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).uv=this.uv.toJSON(t).uuid,e.position=this.position.toJSON(t).uuid),e}}])&&El(e.prototype,n),r&&El(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(vr).prototype.nodeType="UVTransform";var Vl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bl(t,e)}(i,t);var e,n,r,o=Xl(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).texture=t,e.maxMIPLevel=0,e}return e=i,(n=[{key:"value",get:function(){if(0===this.maxMIPLevel){var t=this.texture.value.image;Array.isArray(t)&&(t=t[0]),this.maxMIPLevel=void 0!==t?Math.log(Math.max(t.width,t.height))*Math.LOG2E:0}return this.maxMIPLevel},set:function(t){}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).texture=this.texture.uuid),e}}])&&zl(e.prototype,n),r&&zl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(yo);function Yl(t){return Yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yl(t)}function Hl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wl(){return Wl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Gl(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Wl.apply(this,arguments)}function Gl(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zl(t)););return t}function ql(t,e){return ql=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ql(t,e)}function Kl(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zl(t);if(e){var o=Zl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $l(this,n)}}function $l(t,e){if(e&&("object"===Yl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Zl(t){return Zl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Zl(t)}Vl.prototype.nodeType="MaxMIPLevel";var ts=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ql(t,e)}(i,t);var e,n,r,o=Kl(i);function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,"f")).roughness=t,n.texture=e,n.maxMIPLevel=void 0,n}return e=i,(n=[{key:"setTexture",value:function(t){return this.texture=t,this}},{key:"generate",value:function(t,e){if(t.isShader("fragment")){this.maxMIPLevel=this.maxMIPLevel||new Vl,this.maxMIPLevel.texture=this.texture;var n=t.include(i.Nodes.getSpecularMIPLevel);return t.format(n+"( "+this.roughness.build(t,"f")+", "+this.maxMIPLevel.build(t,"f")+" )",this.type,e)}return console.warn("THREE.SpecularMIPLevelNode is not compatible with "+t.shader+" shader."),t.format("0.0",this.type,e)}},{key:"copy",value:function(t){return Wl(Zl(i.prototype),"copy",this).call(this,t),this.texture=t.texture,this.roughness=t.roughness,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).texture=this.texture,e.roughness=this.roughness),e}}])&&Hl(e.prototype,n),r&&Hl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function es(t){return es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},es(t)}function ns(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rs(){return rs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=os(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},rs.apply(this,arguments)}function os(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cs(t)););return t}function is(t,e){return is=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},is(t,e)}function us(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=cs(t);if(e){var o=cs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return as(this,n)}}function as(t,e){if(e&&("object"===es(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function cs(t){return cs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},cs(t)}function fs(t){return fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fs(t)}function ls(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ss(){return ss="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=ps(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},ss.apply(this,arguments)}function ps(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vs(t)););return t}function hs(t,e){return hs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},hs(t,e)}function ys(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=vs(t);if(e){var o=vs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ds(this,n)}}function ds(t,e){if(e&&("object"===fs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function vs(t){return vs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},vs(t)}ts.Nodes={getSpecularMIPLevel:new Je("\n\n\t\tfloat getSpecularMIPLevel( const in float roughness, const in float maxMIPLevelScalar ) {\n\n\t\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\n\t\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\n\t\t}")},ts.prototype.nodeType="SpecularMIPLevel",function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&is(t,e)}(i,t);var e,n,r,o=us(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this)).slots=t||{},e}return e=i,(n=[{key:"getType",value:function(t,e){return e}},{key:"generate",value:function(t,e){return this.slots[t.slot]?this.slots[t.slot].build(t,e):t.format("0.0","f",e)}},{key:"copy",value:function(t){for(var e in rs(cs(i.prototype),"copy",this).call(this,t),t.slots)this.slots[e]=t.slots[e];return this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);if(!e)for(var n in(e=this.createJSONNode(t)).slots={},this.slots){var r=this.slots[n];r&&(e.slots[n]=r.toJSON(t).uuid)}return e}}])&&ns(e.prototype,n),r&&ns(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee).prototype.nodeType="SubSlot";var bs=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hs(t,e)}(u,e);var n,r,o,i=ys(u);function u(t,e,n,r){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,"v4")).value=t,o.uv=e||new tr,o.radius=n||new An(1,1),o.size=r,o.blurX=!0,o.blurY=!0,o.horizontal=new yo(1/64),o.vertical=new yo(1/64),o}return n=u,(r=[{key:"updateFrame",value:function(){if(this.size)this.horizontal.value=this.radius.x/this.size.x,this.vertical.value=this.radius.y/this.size.y;else if(this.value.value&&this.value.value.image){var t=this.value.value.image;this.horizontal.value=this.radius.x/t.width,this.vertical.value=this.radius.y/t.height}}},{key:"generate",value:function(t,e){if(t.isShader("fragment")){var n,r=[],o=t.include(u.Nodes.blurX),i=t.include(u.Nodes.blurY);return this.blurX&&r.push(o+"( "+this.value.build(t,"sampler2D")+", "+this.uv.build(t,"v2")+", "+this.horizontal.build(t,"f")+" )"),this.blurY&&r.push(i+"( "+this.value.build(t,"sampler2D")+", "+this.uv.build(t,"v2")+", "+this.vertical.build(t,"f")+" )"),n=2==r.length?"( "+r.join(" + ")+" / 2.0 )":r.length?"( "+r[0]+" )":"vec4( 0.0 )",t.format(n,this.getType(t),e)}return console.warn("THREE.BlurNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},{key:"copy",value:function(e){return ss(vs(u.prototype),"copy",this).call(this,e),this.value=e.value,this.uv=e.uv,this.radius=e.radius,void 0!==e.size&&(this.size=new t.Vector2(e.size.x,e.size.y)),this.blurX=e.blurX,this.blurY=e.blurY,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).value=this.value.toJSON(t).uuid,e.uv=this.uv.toJSON(t).uuid,e.radius=this.radius.toJSON(t).uuid,this.size&&(e.size={x:this.size.x,y:this.size.y}),e.blurX=this.blurX,e.blurY=this.blurY),e}}])&&ls(n.prototype,r),o&&ls(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(Ee);function ms(t){return ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ms(t)}function gs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _s(){return _s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=ws(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},_s.apply(this,arguments)}function ws(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ss(t)););return t}function xs(t,e){return xs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},xs(t,e)}function Os(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ss(t);if(e){var o=Ss(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ps(this,n)}}function Ps(t,e){if(e&&("object"===ms(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ss(t){return Ss=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ss(t)}bs.Nodes={blurX:new Je("\n\t\tvec4 blurX( sampler2D tex, vec2 uv, float s ) {\n\t\t\tvec4 sum = vec4( 0.0 );\n\t\t\tsum += texture2D( tex, vec2( uv.x - 4.0 * s, uv.y ) ) * 0.051;\n\t\t\tsum += texture2D( tex, vec2( uv.x - 3.0 * s, uv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tex, vec2( uv.x - 2.0 * s, uv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tex, vec2( uv.x - 1.0 * s, uv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tex, vec2( uv.x + 1.0 * s, uv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tex, vec2( uv.x + 2.0 * s, uv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tex, vec2( uv.x + 3.0 * s, uv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tex, vec2( uv.x + 4.0 * s, uv.y ) ) * 0.051;\n\t\t\treturn sum * .667;\n\t\t}"),blurY:new Je("\n\t\tvec4 blurY( sampler2D tex, vec2 uv, float s ) {\n\t\t\tvec4 sum = vec4( 0.0 );\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y - 4.0 * s ) ) * 0.051;\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y - 3.0 * s ) ) * 0.0918;\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y - 2.0 * s ) ) * 0.12245;\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y - 1.0 * s ) ) * 0.1531;\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y + 1.0 * s ) ) * 0.1531;\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y + 2.0 * s ) ) * 0.12245;\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y + 3.0 * s ) ) * 0.0918;\n\t\t\tsum += texture2D( tex, vec2( uv.x, uv.y + 4.0 * s ) ) * 0.051;\n\t\t\treturn sum * .667;\n\t\t}")},bs.prototype.nodeType="Blur",bs.prototype.hashProperties=["blurX","blurY"];var Ts,As=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xs(t,e)}(i,t);var e,n,r,o=Os(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"f")).rgb=t,e}return e=i,(n=[{key:"generate",value:function(t,e){var n=t.include(i.Nodes.luminance);return t.format(n+"( "+this.rgb.build(t,"v3")+" )",this.getType(t),e)}},{key:"copy",value:function(t){return _s(Ss(i.prototype),"copy",this).call(this,t),this.rgb=t.rgb,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).rgb=this.rgb.toJSON(t).uuid),e}}])&&gs(e.prototype,n),r&&gs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function js(t){return js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(t)}function Rs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ns(){return Ns="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Fs(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ns.apply(this,arguments)}function Fs(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Cs(t)););return t}function Es(t,e){return Es=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Es(t,e)}function Ls(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Cs(t);if(e){var o=Cs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ks(this,n)}}function ks(t,e){if(e&&("object"===js(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Cs(t){return Cs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Cs(t)}As.Nodes={LUMA:Ts=new Ze("vec3 LUMA vec3( 0.2125, 0.7154, 0.0721 )"),luminance:new Je("\n\n\t\tfloat luminance( vec3 rgb ) {\n\n\t\t\treturn dot( rgb, LUMA );\n\n\t\t}",[Ts])},As.prototype.nodeType="Luminance";var Is=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Es(t,e)}(i,t);var e,n,r,o=Ls(i);function i(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=o.call(this,"v3")).rgb=t,r.adjustment=e,r.method=n||i.SATURATION,r}return e=i,(n=[{key:"generate",value:function(t,e){var n=this.rgb.build(t,"v3"),r=this.adjustment.build(t,"f");switch(this.method){case i.BRIGHTNESS:return t.format("( "+n+" + "+r+" )",this.getType(t),e);case i.CONTRAST:return t.format("( "+n+" * "+r+" )",this.getType(t),e)}var o=t.include(i.Nodes[this.method]);return t.format(o+"( "+n+", "+r+" )",this.getType(t),e)}},{key:"copy",value:function(t){return Ns(Cs(i.prototype),"copy",this).call(this,t),this.rgb=t.rgb,this.adjustment=t.adjustment,this.method=t.method,this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).rgb=this.rgb.toJSON(t).uuid,e.adjustment=this.adjustment.toJSON(t).uuid,e.method=this.method),e}}])&&Rs(e.prototype,n),r&&Rs(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Ee);function Us(t){return Us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Us(t)}function Ds(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ms(){return Ms="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=zs(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ms.apply(this,arguments)}function zs(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qs(t)););return t}function Bs(t,e){return Bs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Bs(t,e)}function Xs(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Qs(t);if(e){var o=Qs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Js(this,n)}}function Js(t,e){if(e&&("object"===Us(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Qs(t){return Qs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Qs(t)}Is.Nodes={hue:new Je("\n\t\tvec3 hue(vec3 rgb, float adjustment) {\n\n\t\t\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);\n\t\t\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);\n\n\t\t\tvec3 yiq = RGBtoYIQ * rgb;\n\n\t\t\tfloat hue = atan(yiq.z, yiq.y) + adjustment;\n\t\t\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\n\n\t\t\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\n\n\t\t}"),saturation:new Je("\n\t\tvec3 saturation(vec3 rgb, float adjustment) {\n\n\t\t\tvec3 intensity = vec3( luminance( rgb ) );\n\n\t\t\treturn mix( intensity, rgb, adjustment );\n\n\t\t}",[As.Nodes.luminance]),vibrance:new Je("\n\n\t\tvec3 vibrance(vec3 rgb, float adjustment) {\n\n\t\t\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;\n\n\t\t\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));\n\t\t\tfloat amt = (mx - average) * (-3.0 * adjustment);\n\n\t\t\treturn mix(rgb.rgb, vec3(mx), amt);\n\n\t\t}")},Is.SATURATION="saturation",Is.HUE="hue",Is.VIBRANCE="vibrance",Is.BRIGHTNESS="brightness",Is.CONTRAST="contrast",Is.prototype.nodeType="ColorAdjustment",Is.prototype.hashProperties=["method"];var Vs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bs(t,e)}(i,t);var e,n,r,o=Xs(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).color=new _i(16777215),t}return e=i,(n=[{key:"generate",value:function(t){var e;if(t.isShader("vertex")){var n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0,r=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>"];r.push("#include <begin_vertex>"),n&&r.push(n.code,n.result?"transformed = "+n.result+";":""),r.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <logdepthbuf_vertex>","#include <worldpos_vertex>","#include <clipping_planes_vertex>","#include <fog_vertex>"),e=r.join("\n")}else{this.color.analyze(t,{slot:"color"}),this.alpha&&this.alpha.analyze(t),this.mask&&this.mask.analyze(t);var o=this.color.flow(t,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(t,"f"):void 0,u=this.mask?this.mask.flow(t,"b"):void 0;t.requires.transparent=void 0!==i;var a=[o.code];u&&a.push(u.code,"if ( ! "+u.result+" ) discard;"),i&&a.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),i?a.push("gl_FragColor = vec4("+o.result+", "+i.result+" );"):a.push("gl_FragColor = vec4("+o.result+", 1.0 );"),e=a.join("\n")}return e}},{key:"copy",value:function(t){return Ms(Qs(i.prototype),"copy",this).call(this,t),this.color=t.color,t.position&&(this.position=t.position),t.alpha&&(this.alpha=t.alpha),t.mask&&(this.mask=t.mask),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||((e=this.createJSONNode(t)).color=this.color.toJSON(t).uuid,this.position&&(e.position=this.position.toJSON(t).uuid),this.alpha&&(e.alpha=this.alpha.toJSON(t).uuid),this.mask&&(e.mask=this.mask.toJSON(t).uuid)),e}}])&&Ds(e.prototype,n),r&&Ds(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(xe);function Ys(t){return Ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ys(t)}function Hs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ws(){return Ws="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=Gs(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ws.apply(this,arguments)}function Gs(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zs(t)););return t}function qs(t,e){return qs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},qs(t,e)}function Ks(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zs(t);if(e){var o=Zs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $s(this,n)}}function $s(t,e){if(e&&("object"===Ys(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Zs(t){return Zs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Zs(t)}Vs.prototype.nodeType="Basic";var tp=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qs(t,e)}(u,e);var n,r,o,i=Ks(u);function u(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this)).color=new _i(15658734),t.spherical=!0,t}return n=u,(r=[{key:"build",value:function(e){var n;if(e.define("SPRITE"),e.requires.lights=!1,e.requires.transparent=void 0!==this.alpha,e.isShader("vertex")){var r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(t.UniformsUtils.merge([t.UniformsLib.fog])),e.addParsCode("\n\t\t\t\t#include <fog_pars_vertex>\n\t\t\t\t#include <logdepthbuf_pars_vertex>\n\t\t\t\t#include <clipping_planes_pars_vertex>"),n=["#include <clipping_planes_fragment>","#include <begin_vertex>"],r&&n.push(r.code,r.result?"transformed = "+r.result+";":""),n.push("#include <project_vertex>","#include <fog_vertex>","mat4 modelViewMtx = modelViewMatrix;","mat4 modelMtx = modelMatrix;","modelMtx[3][0] = 0.0;","modelMtx[3][1] = 0.0;","modelMtx[3][2] = 0.0;"),this.spherical||n.push("modelMtx[1][1] = 1.0;"),n.push("modelViewMtx[0][0] = 1.0;","modelViewMtx[0][1] = 0.0;","modelViewMtx[0][2] = 0.0;"),this.spherical&&n.push("modelViewMtx[1][0] = 0.0;","modelViewMtx[1][1] = 1.0;","modelViewMtx[1][2] = 0.0;"),n.push("modelViewMtx[2][0] = 0.0;","modelViewMtx[2][1] = 0.0;","modelViewMtx[2][2] = 1.0;","gl_Position = projectionMatrix * modelViewMtx * modelMtx * vec4( transformed, 1.0 );","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","#include <fog_vertex>")}else{e.addParsCode("\n\t\t\t\t#include <fog_pars_fragment>\n\t\t\t\t#include <logdepthbuf_pars_fragment>\n\t\t\t\t#include <clipping_planes_pars_fragment>"),e.addCode("\n\t\t\t\t#include <clipping_planes_fragment>\n\t\t\t\t#include <logdepthbuf_fragment>"),this.mask&&this.mask.analyze(e),this.alpha&&this.alpha.analyze(e),this.color.analyze(e,{slot:"color"});var o=this.mask?this.mask.flow(e,"b"):void 0,i=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.color.flow(e,"c",{slot:"color"});n=[],o&&n.push(o.code,"if ( ! "+o.result+" ) discard;"),i?n.push(i.code,"#ifdef ALPHATEST","if ( "+i.result+" <= ALPHATEST ) discard;","#endif",u.code,"gl_FragColor = vec4( "+u.result+", "+i.result+" );"):n.push(u.code,"gl_FragColor = vec4( "+u.result+", 1.0 );"),n.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>")}return n.join("\n")}},{key:"copy",value:function(t){return Ws(Zs(u.prototype),"copy",this).call(this,t),t.position&&(this.position=t.position),this.color=t.color,void 0!==t.spherical&&(this.spherical=t.spherical),t.mask&&(this.mask=t.mask),t.alpha&&(this.alpha=t.alpha),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),this.position&&(e.position=this.position.toJSON(t).uuid),e.color=this.color.toJSON(t).uuid,!1===this.spherical&&(e.spherical=!1),this.mask&&(e.mask=this.mask.toJSON(t).uuid),this.alpha&&(e.alpha=this.alpha.toJSON(t).uuid)),e}}])&&Hs(n.prototype,r),o&&Hs(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(xe);function ep(t){return ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ep(t)}function np(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rp(){return rp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=op(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},rp.apply(this,arguments)}function op(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cp(t)););return t}function ip(t,e){return ip=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ip(t,e)}function up(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=cp(t);if(e){var o=cp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ap(this,n)}}function ap(t,e){if(e&&("object"===ep(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function cp(t){return cp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},cp(t)}tp.prototype.nodeType="Sprite";var fp=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ip(t,e)}(u,e);var n,r,o,i=up(u);function u(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this)).color=new _i(15658734),t.specular=new _i(1118481),t.shininess=new yo(30),t}return n=u,(r=[{key:"build",value:function(e){var n;if(e.define("PHONG"),e.requires.lights=!0,e.isShader("vertex")){var r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(t.UniformsUtils.merge([t.UniformsLib.fog,t.UniformsLib.lights])),e.addParsCode('\n\t\t\t\tvarying vec3 vViewPosition;\n\n\t\t\t\t//"#include <encodings_pars_fragment> // encoding functions\n\t\t\t\t#include <fog_pars_vertex>\n\t\t\t\t#include <normal_pars_vertex>\n\t\t\t\t#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\t\t\t\t#include <shadowmap_pars_vertex>\n\t\t\t\t#include <logdepthbuf_pars_vertex>\n\t\t\t\t#include <clipping_planes_pars_vertex>');var o=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#include <normal_vertex>","#include <begin_vertex>"];r&&o.push(r.code,r.result?"transformed = "+r.result+";":""),o.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),n=o.join("\n")}else{this.mask&&this.mask.analyze(e),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.alpha&&this.alpha.analyze(e),this.normal&&this.normal.analyze(e),this.light&&this.light.analyze(e,{cache:"light"}),this.ao&&this.ao.analyze(e),this.ambient&&this.ambient.analyze(e),this.shadow&&this.shadow.analyze(e),this.emissive&&this.emissive.analyze(e,{slot:"emissive"}),this.environment&&this.environment.analyze(e,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.analyze(e);var i=this.mask?this.mask.flow(e,"b"):void 0,u=this.color.flow(e,"c",{slot:"color"}),a=this.specular.flow(e,"c"),c=this.shininess.flow(e,"f"),f=this.alpha?this.alpha.flow(e,"f"):void 0,l=this.normal?this.normal.flow(e,"v3"):void 0,s=this.light?this.light.flow(e,"v3",{cache:"light"}):void 0,p=this.ao?this.ao.flow(e,"f"):void 0,h=this.ambient?this.ambient.flow(e,"c"):void 0,y=this.shadow?this.shadow.flow(e,"c"):void 0,d=this.emissive?this.emissive.flow(e,"c",{slot:"emissive"}):void 0,v=this.environment?this.environment.flow(e,"c",{slot:"environment"}):void 0,b=this.environmentAlpha&&this.environment?this.environmentAlpha.flow(e,"f"):void 0;e.requires.transparent=void 0!==f,e.addParsCode("\n\t\t\t\t#include <fog_pars_fragment>\n\t\t\t\t#include <bsdfs>\n\t\t\t\t#include <lights_pars_begin>\n\t\t\t\t#include <normal_pars_fragment>\n\t\t\t\t#include <lights_phong_pars_fragment>\n\t\t\t\t#include <shadowmap_pars_fragment>\n\t\t\t\t#include <logdepthbuf_pars_fragment>");var m=["#include <normal_fragment_begin>","\tBlinnPhongMaterial material;"];i&&m.push(i.code,"if ( ! "+i.result+" ) discard;"),m.push(u.code,"\tvec3 diffuseColor = "+u.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",a.code,"\tvec3 specular = "+a.result+";",c.code,"\tfloat shininess = max( 0.0001, "+c.result+" );","\tfloat specularStrength = 1.0;"),f&&m.push(f.code,"#ifdef ALPHATEST","if ( "+f.result+" <= ALPHATEST ) discard;","#endif"),l&&m.push(l.code,"normal = "+l.result+";"),m.push("material.diffuseColor = "+(s?"vec3( 1.0 )":"diffuseColor")+";"),m.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),s&&(m.push(s.code,"reflectedLight.directDiffuse = "+s.result+";"),m.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),p&&m.push(p.code,"reflectedLight.indirectDiffuse *= "+p.result+";"),h&&m.push(h.code,"reflectedLight.indirectDiffuse += "+h.result+";"),y&&m.push(y.code,"reflectedLight.directDiffuse *= "+y.result+";","reflectedLight.directSpecular *= "+y.result+";"),d&&m.push(d.code,"reflectedLight.directDiffuse += "+d.result+";"),m.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),v&&(m.push(v.code),b?m.push(b.code,"outgoingLight = mix( outgoingLight, "+v.result+", "+b.result+" );"):m.push("outgoingLight = "+v.result+";")),f?m.push("gl_FragColor = vec4( outgoingLight, "+f.result+" );"):m.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),m.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>"),n=m.join("\n")}return n}},{key:"copy",value:function(t){return rp(cp(u.prototype),"copy",this).call(this,t),t.position&&(this.position=t.position),this.color=t.color,this.specular=t.specular,this.shininess=t.shininess,t.mask&&(this.mask=t.mask),t.alpha&&(this.alpha=t.alpha),t.normal&&(this.normal=t.normal),t.light&&(this.light=t.light),t.shadow&&(this.shadow=t.shadow),t.ao&&(this.ao=t.ao),t.emissive&&(this.emissive=t.emissive),t.ambient&&(this.ambient=t.ambient),t.environment&&(this.environment=t.environment),t.environmentAlpha&&(this.environmentAlpha=t.environmentAlpha),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),this.position&&(e.position=this.position.toJSON(t).uuid),e.color=this.color.toJSON(t).uuid,e.specular=this.specular.toJSON(t).uuid,e.shininess=this.shininess.toJSON(t).uuid,this.mask&&(e.mask=this.mask.toJSON(t).uuid),this.alpha&&(e.alpha=this.alpha.toJSON(t).uuid),this.normal&&(e.normal=this.normal.toJSON(t).uuid),this.light&&(e.light=this.light.toJSON(t).uuid),this.ao&&(e.ao=this.ao.toJSON(t).uuid),this.ambient&&(e.ambient=this.ambient.toJSON(t).uuid),this.shadow&&(e.shadow=this.shadow.toJSON(t).uuid),this.emissive&&(e.emissive=this.emissive.toJSON(t).uuid),this.environment&&(e.environment=this.environment.toJSON(t).uuid),this.environmentAlpha&&(e.environmentAlpha=this.environmentAlpha.toJSON(t).uuid)),e}}])&&np(n.prototype,r),o&&np(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(xe);function lp(t){return lp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(t)}function sp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pp(){return pp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=hp(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},pp.apply(this,arguments)}function hp(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bp(t)););return t}function yp(t,e){return yp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},yp(t,e)}function dp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=bp(t);if(e){var o=bp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vp(this,n)}}function vp(t,e){if(e&&("object"===lp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function bp(t){return bp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},bp(t)}fp.prototype.nodeType="Phong";var mp=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yp(t,e)}(u,e);var n,r,o,i=dp(u);function u(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this)).color=new _i(16777215),t.roughness=new yo(1),t.metalness=new yo(0),t}return n=u,(r=[{key:"build",value:function(e){var n;e.define("STANDARD");var r=this.clearcoat||this.clearcoatRoughness||this.clearCoatNormal;if(r&&(e.define("CLEARCOAT"),e.define("USE_CLEARCOAT")),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){var o=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(t.UniformsUtils.merge([t.UniformsLib.fog,t.UniformsLib.lights])),t.UniformsLib.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode('\n\t\t\t\tvarying vec3 vViewPosition;\n\n\t\t\t\t#ifndef FLAT_SHADED\n\n\t\t\t\t\tvarying vec3 vNormal;\n\n\t\t\t\t#endif\n\n\t\t\t\t//"#include <encodings_pars_fragment> // encoding functions\n\t\t\t\t#include <fog_pars_vertex>\n\t\t\t\t#include <morphtarget_pars_vertex>\n\t\t\t\t#include <skinning_pars_vertex>\n\t\t\t\t#include <shadowmap_pars_vertex>\n\t\t\t\t#include <logdepthbuf_pars_vertex>\n\t\t\t\t#include <clipping_planes_pars_vertex>');var i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];o&&i.push(o.code,o.result?"transformed = "+o.result+";":""),i.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),n=i.join("\n")}else{var u=new vr("material.roughness","f"),a=new vr("material.clearcoatRoughness","f"),c={roughness:u,bias:new ts(u),viewNormal:new vr("normal","v3"),worldNormal:new vr("inverseTransformDirection( geometry.normal, viewMatrix )","v3"),gamma:!0},f={gamma:!0},l={roughness:a,bias:new ts(a),viewNormal:new vr("clearcoatNormal","v3"),worldNormal:new vr("inverseTransformDirection( geometry.clearcoatNormal, viewMatrix )","v3"),gamma:!0};this.mask&&this.mask.analyze(e),this.color.analyze(e,{slot:"color",context:f}),this.roughness.analyze(e),this.metalness.analyze(e),this.alpha&&this.alpha.analyze(e),this.normal&&this.normal.analyze(e),this.clearcoat&&this.clearcoat.analyze(e),this.clearcoatRoughness&&this.clearcoatRoughness.analyze(e),this.clearcoatNormal&&this.clearcoatNormal.analyze(e),this.reflectivity&&this.reflectivity.analyze(e),this.light&&this.light.analyze(e,{cache:"light"}),this.ao&&this.ao.analyze(e),this.ambient&&this.ambient.analyze(e),this.shadow&&this.shadow.analyze(e),this.emissive&&this.emissive.analyze(e,{slot:"emissive"}),this.environment&&(this.environment.analyze(e,{cache:"radiance",context:c,slot:"radiance"}),e.requires.irradiance&&this.environment.analyze(e,{cache:"irradiance",context:c,slot:"irradiance"})),this.sheenColor&&this.sheenColor.analyze(e);var s,p=this.mask?this.mask.flow(e,"b"):void 0,h=this.color.flow(e,"c",{slot:"color",context:f}),y=this.roughness.flow(e,"f"),d=this.metalness.flow(e,"f"),v=this.alpha?this.alpha.flow(e,"f"):void 0,b=this.normal?this.normal.flow(e,"v3"):void 0,m=this.clearcoat?this.clearcoat.flow(e,"f"):void 0,g=this.clearcoatRoughness?this.clearcoatRoughness.flow(e,"f"):void 0,_=this.clearcoatNormal?this.clearcoatNormal.flow(e,"v3"):void 0,w=this.reflectivity?this.reflectivity.flow(e,"f"):void 0,x=this.light?this.light.flow(e,"v3",{cache:"light"}):void 0,O=this.ao?this.ao.flow(e,"f"):void 0,P=this.ambient?this.ambient.flow(e,"c"):void 0,S=this.shadow?this.shadow.flow(e,"c"):void 0,T=this.emissive?this.emissive.flow(e,"c",{slot:"emissive"}):void 0;this.environment&&(s={radiance:this.environment.flow(e,"c",{cache:"radiance",context:c,slot:"radiance"})},e.requires.irradiance&&(s.irradiance=this.environment.flow(e,"c",{cache:"irradiance",context:c,slot:"irradiance"})));var A=r&&s?this.environment.flow(e,"c",{cache:"clearcoat",context:l,slot:"environment"}):void 0,j=this.sheenColor?this.sheenColor.flow(e,"c"):void 0;e.requires.transparent=void 0!==v,e.addParsCode("\n\t\t\t\tvarying vec3 vViewPosition;\n\n\t\t\t\t#define NODE_MAXIMUM_SPECULAR_COEFFICIENT 0.16\n\t\t\t\t#define NODE_DEFAULT_SPECULAR_COEFFICIENT 0.04\n\n\t\t\t\t#ifndef FLAT_SHADED\n\n\t\t\t\t\tvarying vec3 vNormal;\n\n\t\t\t\t#endif\n\n\t\t\t\t#include <dithering_pars_fragment>\n\t\t\t\t#include <fog_pars_fragment>\n\t\t\t\t#include <bsdfs>\n\t\t\t\t#include <lights_pars_begin>\n\t\t\t\t#include <lights_physical_pars_fragment>\n\t\t\t\t#include <shadowmap_pars_fragment>\n\t\t\t\t#include <logdepthbuf_pars_fragment>");var R=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\t#include <clearcoat_normal_fragment_begin>","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];p&&R.push(p.code,"if ( ! "+p.result+" ) discard;"),R.push(h.code,"\tvec3 diffuseColor = "+h.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",y.code,"\tfloat roughnessFactor = "+y.result+";",d.code,"\tfloat metalnessFactor = "+d.result+";"),v&&R.push(v.code,"#ifdef ALPHATEST","\tif ( "+v.result+" <= ALPHATEST ) discard;","#endif"),b&&R.push(b.code,"normal = "+b.result+";"),_&&R.push(_.code,"clearcoatNormal = "+_.result+";"),R.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),R.push("material.diffuseColor = "+(x?"vec3( 1.0 )":"diffuseColor * ( 1.0 - metalnessFactor )")+";","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),m?R.push(m.code,"material.clearcoat = saturate( "+m.result+" );"):r&&R.push("material.clearcoat = 0.0;"),g?R.push(g.code,"material.clearcoatRoughness = max( "+g.result+", 0.0525 );","material.clearcoatRoughness += geometryRoughness;","material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );"):r&&R.push("material.clearcoatRoughness = 0.0;"),j&&R.push("material.sheenColor = "+j.result+";"),w?R.push(w.code,"material.specularColor = mix( vec3( NODE_MAXIMUM_SPECULAR_COEFFICIENT * pow2( "+w.result+" ) ), diffuseColor, metalnessFactor );"):R.push("material.specularColor = mix( vec3( NODE_DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );"),R.push("#include <lights_fragment_begin>"),x&&(R.push(x.code,"reflectedLight.directDiffuse = "+x.result+";"),R.push("diffuseColor *= 1.0 - metalnessFactor;","reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),O&&R.push(O.code,"reflectedLight.indirectDiffuse *= "+O.result+";","float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );","reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, "+O.result+", material.roughness );"),P&&R.push(P.code,"reflectedLight.indirectDiffuse += "+P.result+";"),S&&R.push(S.code,"reflectedLight.directDiffuse *= "+S.result+";","reflectedLight.directSpecular *= "+S.result+";"),T&&R.push(T.code,"reflectedLight.directDiffuse += "+T.result+";"),s&&(R.push(s.radiance.code),e.requires.irradiance&&R.push(s.irradiance.code),A&&R.push(A.code,"clearcoatRadiance += "+A.result+";"),R.push("radiance += "+s.radiance.result+";"),e.requires.irradiance&&R.push("iblIrradiance += PI * "+s.irradiance.result+";")),R.push("#include <lights_fragment_end>"),R.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),v?R.push("gl_FragColor = vec4( outgoingLight, "+v.result+" );"):R.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),R.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>","#include <dithering_fragment>"),n=R.join("\n")}return n}},{key:"copy",value:function(t){return pp(bp(u.prototype),"copy",this).call(this,t),t.position&&(this.position=t.position),this.color=t.color,this.roughness=t.roughness,this.metalness=t.metalness,t.mask&&(this.mask=t.mask),t.alpha&&(this.alpha=t.alpha),t.normal&&(this.normal=t.normal),t.clearcoat&&(this.clearcoat=t.clearcoat),t.clearcoatRoughness&&(this.clearcoatRoughness=t.clearcoatRoughness),t.clearcoatNormal&&(this.clearcoatNormal=t.clearcoatNormal),t.reflectivity&&(this.reflectivity=t.reflectivity),t.light&&(this.light=t.light),t.shadow&&(this.shadow=t.shadow),t.ao&&(this.ao=t.ao),t.emissive&&(this.emissive=t.emissive),t.ambient&&(this.ambient=t.ambient),t.environment&&(this.environment=t.environment),t.sheenColor&&(this.sheenColor=t.sheenColor),this}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),this.position&&(e.position=this.position.toJSON(t).uuid),e.color=this.color.toJSON(t).uuid,e.roughness=this.roughness.toJSON(t).uuid,e.metalness=this.metalness.toJSON(t).uuid,this.mask&&(e.mask=this.mask.toJSON(t).uuid),this.alpha&&(e.alpha=this.alpha.toJSON(t).uuid),this.normal&&(e.normal=this.normal.toJSON(t).uuid),this.clearcoat&&(e.clearcoat=this.clearcoat.toJSON(t).uuid),this.clearcoatRoughness&&(e.clearcoatRoughness=this.clearcoatRoughness.toJSON(t).uuid),this.clearcoatNormal&&(e.clearcoatNormal=this.clearcoatNormal.toJSON(t).uuid),this.reflectivity&&(e.reflectivity=this.reflectivity.toJSON(t).uuid),this.light&&(e.light=this.light.toJSON(t).uuid),this.shadow&&(e.shadow=this.shadow.toJSON(t).uuid),this.ao&&(e.ao=this.ao.toJSON(t).uuid),this.emissive&&(e.emissive=this.emissive.toJSON(t).uuid),this.ambient&&(e.ambient=this.ambient.toJSON(t).uuid),this.environment&&(e.environment=this.environment.toJSON(t).uuid),this.sheenColor&&(e.sheenColor=this.sheenColor.toJSON(t).uuid)),e}}])&&sp(n.prototype,r),o&&sp(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(xe);function gp(t){return gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gp(t)}function _p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wp(){return wp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=xp(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},wp.apply(this,arguments)}function xp(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tp(t)););return t}function Op(t,e){return Op=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Op(t,e)}function Pp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Tp(t);if(e){var o=Tp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Sp(this,n)}}function Sp(t,e){if(e&&("object"===gp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Tp(t){return Tp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Tp(t)}mp.prototype.nodeType="Standard";var Ap=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Op(t,e)}(u,e);var n,r,o,i=Pp(u);function u(){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this)).properties={color:new t.Color(16777215),roughness:.5,metalness:.5,normalScale:new t.Vector2(1,1)},e.inputs={color:new ca(e.properties,"color","c"),roughness:new ca(e.properties,"roughness","f"),metalness:new ca(e.properties,"metalness","f"),normalScale:new ca(e.properties,"normalScale","v2")},e}return n=u,r=[{key:"build",value:function(t){var e=this.properties,n=this.inputs;if(t.isShader("fragment")){var r=t.findNode(e.color,n.color),o=t.resolve(e.map);this.color=o?new Lo(r,o,Lo.MUL):r;var i=t.findNode(e.roughness,n.roughness),a=t.resolve(e.roughnessMap);this.roughness=a?new Lo(i,new rl(a,"g"),Lo.MUL):i;var c=t.findNode(e.metalness,n.metalness),f=t.resolve(e.metalnessMap);this.metalness=f?new Lo(c,new rl(f,"b"),Lo.MUL):c,e.normalMap?(this.normal=new wf(t.resolve(e.normalMap)),this.normal.scale=t.findNode(e.normalScale,n.normalScale)):this.normal=void 0,this.environment=t.resolve(e.envMap)}return wp(Tp(u.prototype),"build",this).call(this,t)}},{key:"toJSON",value:function(t){var e=this.getJSONNode(t);return e||(e=this.createJSONNode(t),console.warn(".toJSON not implemented in",this)),e}}],r&&_p(n.prototype,r),o&&_p(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(mp);function jp(t){return jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(t)}function Rp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Np(t,e){return Np=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Np(t,e)}function Fp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Lp(t);if(e){var o=Lp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ep(this,n)}}function Ep(t,e){if(e&&("object"===jp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Lp(t){return Lp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Lp(t)}Ap.prototype.nodeType="MeshStandard";var kp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Np(t,e)}(i,t);var e,n,r,o=Fp(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=new Vs;return(t=o.call(this,e,e)).type="BasicNodeMaterial",t}return e=i,n&&Rp(e.prototype,n),r&&Rp(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Ii);function Cp(t){return Cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cp(t)}function Ip(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Up(t,e){return Up=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Up(t,e)}function Dp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=zp(t);if(e){var o=zp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mp(this,n)}}function Mp(t,e){if(e&&("object"===Cp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function zp(t){return zp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},zp(t)}ge.addShortcuts(kp.prototype,"fragment",["color","alpha","mask","position"]);var Bp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Up(t,e)}(i,t);var e,n,r,o=Dp(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=new tp;return(t=o.call(this,e,e)).type="SpriteNodeMaterial",t}return e=i,n&&Ip(e.prototype,n),r&&Ip(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Ii);function Xp(t){return Xp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(t)}function Jp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qp(t,e){return Qp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Qp(t,e)}function Vp(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Hp(t);if(e){var o=Hp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yp(this,n)}}function Yp(t,e){if(e&&("object"===Xp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Hp(t){return Hp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Hp(t)}ge.addShortcuts(Bp.prototype,"fragment",["color","alpha","mask","position","spherical"]);var Wp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qp(t,e)}(i,t);var e,n,r,o=Vp(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=new fp;return(t=o.call(this,e,e)).type="PhongNodeMaterial",t}return e=i,n&&Jp(e.prototype,n),r&&Jp(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Ii);function Gp(t){return Gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gp(t)}function qp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kp(t,e){return Kp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Kp(t,e)}function $p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=th(t);if(e){var o=th(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zp(this,n)}}function Zp(t,e){if(e&&("object"===Gp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function th(t){return th=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},th(t)}ge.addShortcuts(Wp.prototype,"fragment",["color","alpha","specular","shininess","normal","emissive","ambient","light","shadow","ao","environment","environmentAlpha","mask","position"]);var eh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kp(t,e)}(i,t);var e,n,r,o=$p(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=new mp;return(t=o.call(this,e,e)).type="StandardNodeMaterial",t}return e=i,n&&qp(e.prototype,n),r&&qp(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Ii);function nh(t){return nh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(t)}function rh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oh(t,e){return oh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},oh(t,e)}function ih(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ah(t);if(e){var o=ah(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return uh(this,n)}}function uh(t,e){if(e&&("object"===nh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ah(t){return ah=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ah(t)}ge.addShortcuts(eh.prototype,"fragment",["color","alpha","roughness","metalness","reflectivity","clearcoat","clearcoatRoughness","clearcoatNormal","normal","emissive","ambient","light","shadow","ao","environment","mask","position","sheenColor"]);var ch=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oh(t,e)}(i,t);var e,n,r,o=ih(i);function i(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var e=new Ap;return(t=o.call(this,e,e)).type="MeshStandardNodeMaterial",t}return e=i,n&&rh(e.prototype,n),r&&rh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Ii);ge.addShortcuts(ch.prototype,"properties",["color","roughness","metalness","map","normalMap","normalScale","metalnessMap","roughnessMap","envMap"]);function fh(t){return fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(t)}function lh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ph(t,e){return ph=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ph(t,e)}function hh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=dh(t);if(e){var o=dh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yh(this,n)}}function yh(t,e){if(e&&("object"===fh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function dh(t){return dh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},dh(t)}var vh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ph(t,e)}(i,t);var e,n,r,o=hh(i);function i(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.hue,r=void 0===n?0:n,u=e.saturation,a=void 0===u?1:u,c=e.vibrance,f=void 0===c?0:c,l=e.brightness,s=void 0===l?0:l,p=e.contrast,h=void 0===p?1:p;lh(this,i),t=o.call(this),r=new yo(r),a=new yo(a),f=new yo(f),s=new yo(s),h=new yo(h);var y=new Ji,d=new Is(y,r,Is.HUE),v=new Is(d,a,Is.SATURATION),b=new Is(v,f,Is.VIBRANCE),m=new Is(b,s,Is.BRIGHTNESS),g=new Is(m,h,Is.CONTRAST);return t.input=g,t._hue=r,t._saturation=a,t._vibrance=f,t._brightness=s,t._contrast=h,t}return e=i,(n=[{key:"brightness",get:function(){return this._brightness.value},set:function(t){this._brightness.value=t}},{key:"contrast",get:function(){return this._contrast.value},set:function(t){this._contrast.value=t}},{key:"hue",get:function(){return this._hue.value},set:function(t){this._hue.value=t}},{key:"saturation",get:function(){return this._saturation.value},set:function(t){this._saturation.value=t}},{key:"vibrance",get:function(){return this._vibrance.value},set:function(t){this._vibrance.value=t}}])&&sh(e.prototype,n),r&&sh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}($i),bh={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new t.Color(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"};function mh(t){return mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(t)}function gh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _h(t,e){return _h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},_h(t,e)}function wh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Oh(t);if(e){var o=Oh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xh(this,n)}}function xh(t,e){if(e&&("object"===mh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Oh(t){return Oh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Oh(t)}var Ph=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_h(t,e)}(u,e);var n,r,o,i=wh(u);function u(e,n,r,o){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(a=i.call(this)).strength=void 0!==n?n:1,a.radius=r,a.threshold=o,a.resolution=void 0!==e?new t.Vector2(e.x,e.y):new t.Vector2(256,256),a.clearColor=new t.Color(0,0,0);var c={minFilter:t.LinearFilter,magFilter:t.LinearFilter,format:t.RGBAFormat};a.renderTargetsHorizontal=[],a.renderTargetsVertical=[],a.nMips=5;var f=Math.round(a.resolution.x/2),l=Math.round(a.resolution.y/2);a.renderTargetBright=new t.WebGLRenderTarget(f,l,c),a.renderTargetBright.texture.name="UnrealBloomPass.bright",a.renderTargetBright.texture.generateMipmaps=!1;for(var s=0;s<a.nMips;s++){var p=new t.WebGLRenderTarget(f,l,c);p.texture.name="UnrealBloomPass.h"+s,p.texture.generateMipmaps=!1,a.renderTargetsHorizontal.push(p);var h=new t.WebGLRenderTarget(f,l,c);h.texture.name="UnrealBloomPass.v"+s,h.texture.generateMipmaps=!1,a.renderTargetsVertical.push(h),f=Math.round(f/2),l=Math.round(l/2)}void 0===bh&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");var y=bh;a.highPassUniforms=t.UniformsUtils.clone(y.uniforms),a.highPassUniforms.luminosityThreshold.value=o,a.highPassUniforms.smoothWidth.value=.01,a.materialHighPassFilter=new t.ShaderMaterial({uniforms:a.highPassUniforms,vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,defines:{}}),a.separableBlurMaterials=[];var d=[3,5,7,9,11];f=Math.round(a.resolution.x/2),l=Math.round(a.resolution.y/2);for(var v=0;v<a.nMips;v++)a.separableBlurMaterials.push(a.getSeperableBlurMaterial(d[v])),a.separableBlurMaterials[v].uniforms.texSize.value=new t.Vector2(f,l),f=Math.round(f/2),l=Math.round(l/2);a.compositeMaterial=a.getCompositeMaterial(a.nMips),a.compositeMaterial.uniforms.blurTexture1.value=a.renderTargetsVertical[0].texture,a.compositeMaterial.uniforms.blurTexture2.value=a.renderTargetsVertical[1].texture,a.compositeMaterial.uniforms.blurTexture3.value=a.renderTargetsVertical[2].texture,a.compositeMaterial.uniforms.blurTexture4.value=a.renderTargetsVertical[3].texture,a.compositeMaterial.uniforms.blurTexture5.value=a.renderTargetsVertical[4].texture,a.compositeMaterial.uniforms.bloomStrength.value=n,a.compositeMaterial.uniforms.bloomRadius.value=.1,a.compositeMaterial.needsUpdate=!0;a.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],a.bloomTintColors=[new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1),new t.Vector3(1,1,1)],a.compositeMaterial.uniforms.bloomTintColors.value=a.bloomTintColors,void 0===Et&&console.error("THREE.UnrealBloomPass relies on CopyShader");var b=Et;return a.copyUniforms=t.UniformsUtils.clone(b.uniforms),a.copyUniforms.opacity.value=1,a.materialCopy=new t.ShaderMaterial({uniforms:a.copyUniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,blending:t.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),a.enabled=!0,a.needsSwap=!1,a._oldClearColor=new t.Color,a.oldClearAlpha=1,a.basic=new t.MeshBasicMaterial,a.fsQuad=new Mt(null),a}return n=u,r=[{key:"dispose",value:function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(var e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()}},{key:"setSize",value:function(e,n){var r=Math.round(e/2),o=Math.round(n/2);this.renderTargetBright.setSize(r,o);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(r,o),this.renderTargetsVertical[i].setSize(r,o),this.separableBlurMaterials[i].uniforms.texSize.value=new t.Vector2(r,o),r=Math.round(r/2),o=Math.round(o/2)}},{key:"render",value:function(t,e,n,r,o){t.getClearColor(this._oldClearColor),this.oldClearAlpha=t.getClearAlpha();var i=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),o&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t);for(var a=this.renderTargetBright,c=0;c<this.nMips;c++)this.fsQuad.material=this.separableBlurMaterials[c],this.separableBlurMaterials[c].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[c].uniforms.direction.value=u.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[c]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[c].uniforms.colorTexture.value=this.renderTargetsHorizontal[c].texture,this.separableBlurMaterials[c].uniforms.direction.value=u.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[c]),t.clear(),this.fsQuad.render(t),a=this.renderTargetsVertical[c];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,o&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(n),this.fsQuad.render(t)),t.setClearColor(this._oldClearColor,this.oldClearAlpha),t.autoClear=i}},{key:"getSeperableBlurMaterial",value:function(e){return new t.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new t.Vector2(.5,.5)},direction:{value:new t.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\n\t\t\t\tuniform vec2 direction;\n\n\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\n\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\n\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\t\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t\t}\n\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})}},{key:"getCompositeMaterial",value:function(e){return new t.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform sampler2D dirtTexture;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\n\t\t\t\t}"})}}],r&&gh(n.prototype,r),o&&gh(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(It);Ph.BlurDirectionX=new t.Vector2(1,0),Ph.BlurDirectionY=new t.Vector2(0,1);var Sh="vec3 bayerMatrixDither( vec3 color ) {\r\n\r\n\t// Silly code because old devices ( OpenGL ES < 3 ) don't support arrays\r\n\r\n\tint index = int( mod( gl_FragCoord.x - 0.5, 8.0 ) ) + \r\n\t\tint( mod( gl_FragCoord.y - 0.5, 8.0 ) * 8.0 );\r\n\r\n\tfloat dither = 0.0078;\r\n\r\n\tdither = ( index == 1 ) ? 0.0039 : dither;\r\n\tdither = ( index == 2 ) ? 0.0068 : dither;\r\n\tdither = ( index == 3 ) ? 0.0029 : dither;\r\n\tdither = ( index == 4 ) ? 0.0076 : dither;\r\n\tdither = ( index == 5 ) ? 0.0036 : dither;\r\n\tdither = ( index == 6 ) ? 0.0066 : dither;\r\n\tdither = ( index == 7 ) ? 0.0027 : dither;\r\n\r\n\tdither = ( index == 8 )  ? 0.0019 : dither;\r\n\tdither = ( index == 9 )  ? 0.0059 : dither;\r\n\tdither = ( index == 10 ) ? 0.0009 : dither;\r\n\tdither = ( index == 11 ) ? 0.0049 : dither;\r\n\tdither = ( index == 12 ) ? 0.0017 : dither;\r\n\tdither = ( index == 13 ) ? 0.0056 : dither;\r\n\tdither = ( index == 14 ) ? 0.0007 : dither;\r\n\tdither = ( index == 15 ) ? 0.0046 : dither;\r\n\r\n\tdither = ( index == 16 ) ? 0.0063 : dither;\r\n\tdither = ( index == 17 ) ? 0.0024 : dither;\r\n\tdither = ( index == 18 ) ? 0.0073 : dither;\r\n\tdither = ( index == 19 ) ? 0.0034 : dither;\r\n\tdither = ( index == 20 ) ? 0.0061 : dither;\r\n\tdither = ( index == 21 ) ? 0.0022 : dither;\r\n\tdither = ( index == 22 ) ? 0.0071 : dither;\r\n\tdither = ( index == 23 ) ? 0.0032 : dither;\r\n\r\n\tdither = ( index == 24 ) ? 0.0005 : dither;\r\n\tdither = ( index == 25 ) ? 0.0044 : dither;\r\n\tdither = ( index == 26 ) ? 0.0014 : dither;\r\n\tdither = ( index == 27 ) ? 0.0054 : dither;\r\n\tdither = ( index == 28 ) ? 0.0002 : dither;\r\n\tdither = ( index == 29 ) ? 0.0041 : dither;\r\n\tdither = ( index == 30 ) ? 0.0012 : dither;\r\n\tdither = ( index == 31 ) ? 0.0051 : dither;\r\n\r\n\tdither = ( index == 32 ) ? 0.0074 : dither;\r\n\tdither = ( index == 33 ) ? 0.0035 : dither;\r\n\tdither = ( index == 34 ) ? 0.0065 : dither;\r\n\tdither = ( index == 35 ) ? 0.0025 : dither;\r\n\tdither = ( index == 36 ) ? 0.0077 : dither;\r\n\tdither = ( index == 37 ) ? 0.0038 : dither;\r\n\tdither = ( index == 38 ) ? 0.0067 : dither;\r\n\tdither = ( index == 39 ) ? 0.0028 : dither;\r\n\r\n\tdither = ( index == 40 ) ? 0.0016 : dither;\r\n\tdither = ( index == 41 ) ? 0.0055 : dither;\r\n\tdither = ( index == 42 ) ? 0.0006 : dither;\r\n\tdither = ( index == 43 ) ? 0.0045 : dither;\r\n\tdither = ( index == 44 ) ? 0.0018 : dither;\r\n\tdither = ( index == 45 ) ? 0.0057 : dither;\r\n\tdither = ( index == 46 ) ? 0.0008 : dither;\r\n\tdither = ( index == 47 ) ? 0.0047 : dither;\r\n\r\n\tdither = ( index == 48 ) ? 0.006  : dither;\r\n\tdither = ( index == 49 ) ? 0.0021 : dither;\r\n\tdither = ( index == 50 ) ? 0.007  : dither;\r\n\tdither = ( index == 51 ) ? 0.003  : dither;\r\n\tdither = ( index == 52 ) ? 0.0062 : dither;\r\n\tdither = ( index == 53 ) ? 0.0023 : dither;\r\n\tdither = ( index == 54 ) ? 0.0072 : dither;\r\n\tdither = ( index == 55 ) ? 0.0033 : dither;\r\n\r\n\tdither = ( index == 56 ) ? 0.0001 : dither;\r\n\tdither = ( index == 57 ) ? 0.004  : dither;\r\n\tdither = ( index == 58 ) ? 0.0011 : dither;\r\n\tdither = ( index == 59 ) ? 0.005  : dither;\r\n\tdither = ( index == 60 ) ? 0.0003 : dither;\r\n\tdither = ( index == 61 ) ? 0.0043 : dither;\r\n\tdither = ( index == 62 ) ? 0.0013 : dither;\r\n\tdither = ( index == 63 ) ? 0.0052 : dither;\r\n\r\n\treturn color - dither;\r\n\t\r\n}";function Th(t){return Th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Th(t)}function Ah(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rh(t,e){return Rh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Rh(t,e)}function Nh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Eh(t);if(e){var o=Eh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fh(this,n)}}function Fh(t,e){if(e&&("object"===Th(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Eh(t){return Eh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Eh(t)}var Lh=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rh(t,e)}(u,e);var n,r,o,i=Nh(u);function u(){return Ah(this,u),i.apply(this,arguments)}return n=u,(r=[{key:"getCompositeMaterial",value:function(e){return new t.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\t\tuniform sampler2D blurTexture1;\n\t\t\t\tuniform sampler2D blurTexture2;\n\t\t\t\tuniform sampler2D blurTexture3;\n\t\t\t\tuniform sampler2D blurTexture4;\n\t\t\t\tuniform sampler2D blurTexture5;\n\t\t\t\tuniform sampler2D dirtTexture;\n\t\t\t\tuniform float bloomStrength;\n\t\t\t\tuniform float bloomRadius;\n\t\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\n\t\t\t\tfloat lerpBloomFactor(const in float factor) {\n\t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t\t}\n\n\t\t\t\t".concat(Sh,"\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 color = bloomStrength * ( \n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +\n\t\t\t\t\t\tlerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv)\n\t\t\t\t\t);\n\n\t\t\t\t\tcolor.rgb = bayerMatrixDither( color.rgb );\n\n\t\t\t\t\tgl_FragColor = color;\n\t\t\t\t}")})}}])&&jh(n.prototype,r),o&&jh(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(Ph),kh={uniforms:{tDiffuse:{value:null},resolution:{value:new t.Vector2(1/1024,1/512)}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:'\n\n\t\tprecision highp float;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tuniform vec2 resolution;\n\n\t\tvarying vec2 vUv;\n\n\t\t#define FXAA_PC 1\n\t\t#define FXAA_GLSL_100 1\n\t\t#define FXAA_QUALITY_PRESET 12\n\n\t\t#define FXAA_GREEN_AS_LUMA 1\n\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_PC_CONSOLE\n\t\t\t\t//\n\t\t\t\t// The console algorithm for PC is included\n\t\t\t\t// for developers targeting really low spec machines.\n\t\t\t\t// Likely better to just run FXAA_PC, and use a really low preset.\n\t\t\t\t//\n\t\t\t\t#define FXAA_PC_CONSOLE 0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_GLSL_120\n\t\t\t\t#define FXAA_GLSL_120 0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_GLSL_130\n\t\t\t\t#define FXAA_GLSL_130 0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_HLSL_3\n\t\t\t\t#define FXAA_HLSL_3 0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_HLSL_4\n\t\t\t\t#define FXAA_HLSL_4 0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_HLSL_5\n\t\t\t\t#define FXAA_HLSL_5 0\n\t\t#endif\n\t\t/*==========================================================================*/\n\t\t#ifndef FXAA_GREEN_AS_LUMA\n\t\t\t\t//\n\t\t\t\t// For those using non-linear color,\n\t\t\t\t// and either not able to get luma in alpha, or not wanting to,\n\t\t\t\t// this enables FXAA to run using green as a proxy for luma.\n\t\t\t\t// So with this enabled, no need to pack luma in alpha.\n\t\t\t\t//\n\t\t\t\t// This will turn off AA on anything which lacks some amount of green.\n\t\t\t\t// Pure red and blue or combination of only R and B, will get no AA.\n\t\t\t\t//\n\t\t\t\t// Might want to lower the settings for both,\n\t\t\t\t//\t\tfxaaConsoleEdgeThresholdMin\n\t\t\t\t//\t\tfxaaQualityEdgeThresholdMin\n\t\t\t\t// In order to insure AA does not get turned off on colors\n\t\t\t\t// which contain a minor amount of green.\n\t\t\t\t//\n\t\t\t\t// 1 = On.\n\t\t\t\t// 0 = Off.\n\t\t\t\t//\n\t\t\t\t#define FXAA_GREEN_AS_LUMA 0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_EARLY_EXIT\n\t\t\t\t//\n\t\t\t\t// Controls algorithm\'s early exit path.\n\t\t\t\t// On PS3 turning this ON adds 2 cycles to the shader.\n\t\t\t\t// On 360 turning this OFF adds 10ths of a millisecond to the shader.\n\t\t\t\t// Turning this off on console will result in a more blurry image.\n\t\t\t\t// So this defaults to on.\n\t\t\t\t//\n\t\t\t\t// 1 = On.\n\t\t\t\t// 0 = Off.\n\t\t\t\t//\n\t\t\t\t#define FXAA_EARLY_EXIT 1\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_DISCARD\n\t\t\t\t//\n\t\t\t\t// Only valid for PC OpenGL currently.\n\t\t\t\t// Probably will not work when FXAA_GREEN_AS_LUMA = 1.\n\t\t\t\t//\n\t\t\t\t// 1 = Use discard on pixels which don\'t need AA.\n\t\t\t\t//\t\t For APIs which enable concurrent TEX+ROP from same surface.\n\t\t\t\t// 0 = Return unchanged color on pixels which don\'t need AA.\n\t\t\t\t//\n\t\t\t\t#define FXAA_DISCARD 0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_FAST_PIXEL_OFFSET\n\t\t\t\t//\n\t\t\t\t// Used for GLSL 120 only.\n\t\t\t\t//\n\t\t\t\t// 1 = GL API supports fast pixel offsets\n\t\t\t\t// 0 = do not use fast pixel offsets\n\t\t\t\t//\n\t\t\t\t#ifdef GL_EXT_gpu_shader4\n\t\t\t\t\t\t#define FXAA_FAST_PIXEL_OFFSET 1\n\t\t\t\t#endif\n\t\t\t\t#ifdef GL_NV_gpu_shader5\n\t\t\t\t\t\t#define FXAA_FAST_PIXEL_OFFSET 1\n\t\t\t\t#endif\n\t\t\t\t#ifdef GL_ARB_gpu_shader5\n\t\t\t\t\t\t#define FXAA_FAST_PIXEL_OFFSET 1\n\t\t\t\t#endif\n\t\t\t\t#ifndef FXAA_FAST_PIXEL_OFFSET\n\t\t\t\t\t\t#define FXAA_FAST_PIXEL_OFFSET 0\n\t\t\t\t#endif\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#ifndef FXAA_GATHER4_ALPHA\n\t\t\t\t//\n\t\t\t\t// 1 = API supports gather4 on alpha channel.\n\t\t\t\t// 0 = API does not support gather4 on alpha channel.\n\t\t\t\t//\n\t\t\t\t#if (FXAA_HLSL_5 == 1)\n\t\t\t\t\t\t#define FXAA_GATHER4_ALPHA 1\n\t\t\t\t#endif\n\t\t\t\t#ifdef GL_ARB_gpu_shader5\n\t\t\t\t\t\t#define FXAA_GATHER4_ALPHA 1\n\t\t\t\t#endif\n\t\t\t\t#ifdef GL_NV_gpu_shader5\n\t\t\t\t\t\t#define FXAA_GATHER4_ALPHA 1\n\t\t\t\t#endif\n\t\t\t\t#ifndef FXAA_GATHER4_ALPHA\n\t\t\t\t\t\t#define FXAA_GATHER4_ALPHA 0\n\t\t\t\t#endif\n\t\t#endif\n\n\n\t\t/*============================================================================\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tFXAA QUALITY - TUNING KNOBS\n\t\t------------------------------------------------------------------------------\n\t\tNOTE the other tuning knobs are now in the shader function inputs!\n\t\t============================================================================*/\n\t\t#ifndef FXAA_QUALITY_PRESET\n\t\t\t\t//\n\t\t\t\t// Choose the quality preset.\n\t\t\t\t// This needs to be compiled into the shader as it effects code.\n\t\t\t\t// Best option to include multiple presets is to\n\t\t\t\t// in each shader define the preset, then include this file.\n\t\t\t\t//\n\t\t\t\t// OPTIONS\n\t\t\t\t// -----------------------------------------------------------------------\n\t\t\t\t// 10 to 15 - default medium dither (10=fastest, 15=highest quality)\n\t\t\t\t// 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)\n\t\t\t\t// 39\t\t\t - no dither, very expensive\n\t\t\t\t//\n\t\t\t\t// NOTES\n\t\t\t\t// -----------------------------------------------------------------------\n\t\t\t\t// 12 = slightly faster then FXAA 3.9 and higher edge quality (default)\n\t\t\t\t// 13 = about same speed as FXAA 3.9 and better than 12\n\t\t\t\t// 23 = closest to FXAA 3.9 visually and performance wise\n\t\t\t\t//\t_ = the lowest digit is directly related to performance\n\t\t\t\t// _\t= the highest digit is directly related to style\n\t\t\t\t//\n\t\t\t\t#define FXAA_QUALITY_PRESET 12\n\t\t#endif\n\n\n\t\t/*============================================================================\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t FXAA QUALITY - PRESETS\n\n\t\t============================================================================*/\n\n\t\t/*============================================================================\n\t\t\t\t\t\t\t\t\t\t\t\t FXAA QUALITY - MEDIUM DITHER PRESETS\n\t\t============================================================================*/\n\t\t#if (FXAA_QUALITY_PRESET == 10)\n\t\t\t\t#define FXAA_QUALITY_PS 3\n\t\t\t\t#define FXAA_QUALITY_P0 1.5\n\t\t\t\t#define FXAA_QUALITY_P1 3.0\n\t\t\t\t#define FXAA_QUALITY_P2 12.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 11)\n\t\t\t\t#define FXAA_QUALITY_PS 4\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 3.0\n\t\t\t\t#define FXAA_QUALITY_P3 12.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 12)\n\t\t\t\t#define FXAA_QUALITY_PS 5\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 4.0\n\t\t\t\t#define FXAA_QUALITY_P4 12.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 13)\n\t\t\t\t#define FXAA_QUALITY_PS 6\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 4.0\n\t\t\t\t#define FXAA_QUALITY_P5 12.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 14)\n\t\t\t\t#define FXAA_QUALITY_PS 7\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 2.0\n\t\t\t\t#define FXAA_QUALITY_P5 4.0\n\t\t\t\t#define FXAA_QUALITY_P6 12.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 15)\n\t\t\t\t#define FXAA_QUALITY_PS 8\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 2.0\n\t\t\t\t#define FXAA_QUALITY_P5 2.0\n\t\t\t\t#define FXAA_QUALITY_P6 4.0\n\t\t\t\t#define FXAA_QUALITY_P7 12.0\n\t\t#endif\n\n\t\t/*============================================================================\n\t\t\t\t\t\t\t\t\t\t\t\t FXAA QUALITY - LOW DITHER PRESETS\n\t\t============================================================================*/\n\t\t#if (FXAA_QUALITY_PRESET == 20)\n\t\t\t\t#define FXAA_QUALITY_PS 3\n\t\t\t\t#define FXAA_QUALITY_P0 1.5\n\t\t\t\t#define FXAA_QUALITY_P1 2.0\n\t\t\t\t#define FXAA_QUALITY_P2 8.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 21)\n\t\t\t\t#define FXAA_QUALITY_PS 4\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 8.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 22)\n\t\t\t\t#define FXAA_QUALITY_PS 5\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 8.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 23)\n\t\t\t\t#define FXAA_QUALITY_PS 6\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 2.0\n\t\t\t\t#define FXAA_QUALITY_P5 8.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 24)\n\t\t\t\t#define FXAA_QUALITY_PS 7\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 2.0\n\t\t\t\t#define FXAA_QUALITY_P5 3.0\n\t\t\t\t#define FXAA_QUALITY_P6 8.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 25)\n\t\t\t\t#define FXAA_QUALITY_PS 8\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 2.0\n\t\t\t\t#define FXAA_QUALITY_P5 2.0\n\t\t\t\t#define FXAA_QUALITY_P6 4.0\n\t\t\t\t#define FXAA_QUALITY_P7 8.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 26)\n\t\t\t\t#define FXAA_QUALITY_PS 9\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 2.0\n\t\t\t\t#define FXAA_QUALITY_P5 2.0\n\t\t\t\t#define FXAA_QUALITY_P6 2.0\n\t\t\t\t#define FXAA_QUALITY_P7 4.0\n\t\t\t\t#define FXAA_QUALITY_P8 8.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 27)\n\t\t\t\t#define FXAA_QUALITY_PS 10\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 2.0\n\t\t\t\t#define FXAA_QUALITY_P5 2.0\n\t\t\t\t#define FXAA_QUALITY_P6 2.0\n\t\t\t\t#define FXAA_QUALITY_P7 2.0\n\t\t\t\t#define FXAA_QUALITY_P8 4.0\n\t\t\t\t#define FXAA_QUALITY_P9 8.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 28)\n\t\t\t\t#define FXAA_QUALITY_PS 11\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 2.0\n\t\t\t\t#define FXAA_QUALITY_P5 2.0\n\t\t\t\t#define FXAA_QUALITY_P6 2.0\n\t\t\t\t#define FXAA_QUALITY_P7 2.0\n\t\t\t\t#define FXAA_QUALITY_P8 2.0\n\t\t\t\t#define FXAA_QUALITY_P9 4.0\n\t\t\t\t#define FXAA_QUALITY_P10 8.0\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_QUALITY_PRESET == 29)\n\t\t\t\t#define FXAA_QUALITY_PS 12\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.5\n\t\t\t\t#define FXAA_QUALITY_P2 2.0\n\t\t\t\t#define FXAA_QUALITY_P3 2.0\n\t\t\t\t#define FXAA_QUALITY_P4 2.0\n\t\t\t\t#define FXAA_QUALITY_P5 2.0\n\t\t\t\t#define FXAA_QUALITY_P6 2.0\n\t\t\t\t#define FXAA_QUALITY_P7 2.0\n\t\t\t\t#define FXAA_QUALITY_P8 2.0\n\t\t\t\t#define FXAA_QUALITY_P9 2.0\n\t\t\t\t#define FXAA_QUALITY_P10 4.0\n\t\t\t\t#define FXAA_QUALITY_P11 8.0\n\t\t#endif\n\n\t\t/*============================================================================\n\t\t\t\t\t\t\t\t\t\t\t\t FXAA QUALITY - EXTREME QUALITY\n\t\t============================================================================*/\n\t\t#if (FXAA_QUALITY_PRESET == 39)\n\t\t\t\t#define FXAA_QUALITY_PS 12\n\t\t\t\t#define FXAA_QUALITY_P0 1.0\n\t\t\t\t#define FXAA_QUALITY_P1 1.0\n\t\t\t\t#define FXAA_QUALITY_P2 1.0\n\t\t\t\t#define FXAA_QUALITY_P3 1.0\n\t\t\t\t#define FXAA_QUALITY_P4 1.0\n\t\t\t\t#define FXAA_QUALITY_P5 1.5\n\t\t\t\t#define FXAA_QUALITY_P6 2.0\n\t\t\t\t#define FXAA_QUALITY_P7 2.0\n\t\t\t\t#define FXAA_QUALITY_P8 2.0\n\t\t\t\t#define FXAA_QUALITY_P9 2.0\n\t\t\t\t#define FXAA_QUALITY_P10 4.0\n\t\t\t\t#define FXAA_QUALITY_P11 8.0\n\t\t#endif\n\n\n\n\t\t/*============================================================================\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tAPI PORTING\n\n\t\t============================================================================*/\n\t\t#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)\n\t\t\t\t#define FxaaBool bool\n\t\t\t\t#define FxaaDiscard discard\n\t\t\t\t#define FxaaFloat float\n\t\t\t\t#define FxaaFloat2 vec2\n\t\t\t\t#define FxaaFloat3 vec3\n\t\t\t\t#define FxaaFloat4 vec4\n\t\t\t\t#define FxaaHalf float\n\t\t\t\t#define FxaaHalf2 vec2\n\t\t\t\t#define FxaaHalf3 vec3\n\t\t\t\t#define FxaaHalf4 vec4\n\t\t\t\t#define FxaaInt2 ivec2\n\t\t\t\t#define FxaaSat(x) clamp(x, 0.0, 1.0)\n\t\t\t\t#define FxaaTex sampler2D\n\t\t#else\n\t\t\t\t#define FxaaBool bool\n\t\t\t\t#define FxaaDiscard clip(-1)\n\t\t\t\t#define FxaaFloat float\n\t\t\t\t#define FxaaFloat2 float2\n\t\t\t\t#define FxaaFloat3 float3\n\t\t\t\t#define FxaaFloat4 float4\n\t\t\t\t#define FxaaHalf half\n\t\t\t\t#define FxaaHalf2 half2\n\t\t\t\t#define FxaaHalf3 half3\n\t\t\t\t#define FxaaHalf4 half4\n\t\t\t\t#define FxaaSat(x) saturate(x)\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_GLSL_100 == 1)\n\t\t\t#define FxaaTexTop(t, p) texture2D(t, p, 0.0)\n\t\t\t#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_GLSL_120 == 1)\n\t\t\t\t// Requires,\n\t\t\t\t//\t#version 120\n\t\t\t\t// And at least,\n\t\t\t\t//\t#extension GL_EXT_gpu_shader4 : enable\n\t\t\t\t//\t(or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)\n\t\t\t\t#define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)\n\t\t\t\t#if (FXAA_FAST_PIXEL_OFFSET == 1)\n\t\t\t\t\t\t#define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)\n\t\t\t\t#else\n\t\t\t\t\t\t#define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)\n\t\t\t\t#endif\n\t\t\t\t#if (FXAA_GATHER4_ALPHA == 1)\n\t\t\t\t\t\t// use #extension GL_ARB_gpu_shader5 : enable\n\t\t\t\t\t\t#define FxaaTexAlpha4(t, p) textureGather(t, p, 3)\n\t\t\t\t\t\t#define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)\n\t\t\t\t\t\t#define FxaaTexGreen4(t, p) textureGather(t, p, 1)\n\t\t\t\t\t\t#define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)\n\t\t\t\t#endif\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_GLSL_130 == 1)\n\t\t\t\t// Requires "#version 130" or better\n\t\t\t\t#define FxaaTexTop(t, p) textureLod(t, p, 0.0)\n\t\t\t\t#define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)\n\t\t\t\t#if (FXAA_GATHER4_ALPHA == 1)\n\t\t\t\t\t\t// use #extension GL_ARB_gpu_shader5 : enable\n\t\t\t\t\t\t#define FxaaTexAlpha4(t, p) textureGather(t, p, 3)\n\t\t\t\t\t\t#define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)\n\t\t\t\t\t\t#define FxaaTexGreen4(t, p) textureGather(t, p, 1)\n\t\t\t\t\t\t#define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)\n\t\t\t\t#endif\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_HLSL_3 == 1)\n\t\t\t\t#define FxaaInt2 float2\n\t\t\t\t#define FxaaTex sampler2D\n\t\t\t\t#define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))\n\t\t\t\t#define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_HLSL_4 == 1)\n\t\t\t\t#define FxaaInt2 int2\n\t\t\t\tstruct FxaaTex { SamplerState smpl; Texture2D tex; };\n\t\t\t\t#define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)\n\t\t\t\t#define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)\n\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t#if (FXAA_HLSL_5 == 1)\n\t\t\t\t#define FxaaInt2 int2\n\t\t\t\tstruct FxaaTex { SamplerState smpl; Texture2D tex; };\n\t\t\t\t#define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)\n\t\t\t\t#define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)\n\t\t\t\t#define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)\n\t\t\t\t#define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)\n\t\t\t\t#define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)\n\t\t\t\t#define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)\n\t\t#endif\n\n\n\t\t/*============================================================================\n\t\t\t\t\t\t\t\t\t\t\t GREEN AS LUMA OPTION SUPPORT FUNCTION\n\t\t============================================================================*/\n\t\t#if (FXAA_GREEN_AS_LUMA == 0)\n\t\t\t\tFxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }\n\t\t#else\n\t\t\t\tFxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\n\t\t#endif\n\n\n\n\n\t\t/*============================================================================\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t FXAA3 QUALITY - PC\n\n\t\t============================================================================*/\n\t\t#if (FXAA_PC == 1)\n\t\t/*--------------------------------------------------------------------------*/\n\t\tFxaaFloat4 FxaaPixelShader(\n\t\t\t\t//\n\t\t\t\t// Use noperspective interpolation here (turn off perspective interpolation).\n\t\t\t\t// {xy} = center of pixel\n\t\t\t\tFxaaFloat2 pos,\n\t\t\t\t//\n\t\t\t\t// Used only for FXAA Console, and not used on the 360 version.\n\t\t\t\t// Use noperspective interpolation here (turn off perspective interpolation).\n\t\t\t\t// {xy_} = upper left of pixel\n\t\t\t\t// {_zw} = lower right of pixel\n\t\t\t\tFxaaFloat4 fxaaConsolePosPos,\n\t\t\t\t//\n\t\t\t\t// Input color texture.\n\t\t\t\t// {rgb_} = color in linear or perceptual color space\n\t\t\t\t// if (FXAA_GREEN_AS_LUMA == 0)\n\t\t\t\t//\t\t {__a} = luma in perceptual color space (not linear)\n\t\t\t\tFxaaTex tex,\n\t\t\t\t//\n\t\t\t\t// Only used on the optimized 360 version of FXAA Console.\n\t\t\t\t// For everything but 360, just use the same input here as for "tex".\n\t\t\t\t// For 360, same texture, just alias with a 2nd sampler.\n\t\t\t\t// This sampler needs to have an exponent bias of -1.\n\t\t\t\tFxaaTex fxaaConsole360TexExpBiasNegOne,\n\t\t\t\t//\n\t\t\t\t// Only used on the optimized 360 version of FXAA Console.\n\t\t\t\t// For everything but 360, just use the same input here as for "tex".\n\t\t\t\t// For 360, same texture, just alias with a 3nd sampler.\n\t\t\t\t// This sampler needs to have an exponent bias of -2.\n\t\t\t\tFxaaTex fxaaConsole360TexExpBiasNegTwo,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Quality.\n\t\t\t\t// This must be from a constant/uniform.\n\t\t\t\t// {x_} = 1.0/screenWidthInPixels\n\t\t\t\t// {_y} = 1.0/screenHeightInPixels\n\t\t\t\tFxaaFloat2 fxaaQualityRcpFrame,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Console.\n\t\t\t\t// This must be from a constant/uniform.\n\t\t\t\t// This effects sub-pixel AA quality and inversely sharpness.\n\t\t\t\t//\t Where N ranges between,\n\t\t\t\t//\t\t N = 0.50 (default)\n\t\t\t\t//\t\t N = 0.33 (sharper)\n\t\t\t\t// {x__} = -N/screenWidthInPixels\n\t\t\t\t// {_y_} = -N/screenHeightInPixels\n\t\t\t\t// {_z_} =\tN/screenWidthInPixels\n\t\t\t\t// {__w} =\tN/screenHeightInPixels\n\t\t\t\tFxaaFloat4 fxaaConsoleRcpFrameOpt,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Console.\n\t\t\t\t// Not used on 360, but used on PS3 and PC.\n\t\t\t\t// This must be from a constant/uniform.\n\t\t\t\t// {x__} = -2.0/screenWidthInPixels\n\t\t\t\t// {_y_} = -2.0/screenHeightInPixels\n\t\t\t\t// {_z_} =\t2.0/screenWidthInPixels\n\t\t\t\t// {__w} =\t2.0/screenHeightInPixels\n\t\t\t\tFxaaFloat4 fxaaConsoleRcpFrameOpt2,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Console.\n\t\t\t\t// Only used on 360 in place of fxaaConsoleRcpFrameOpt2.\n\t\t\t\t// This must be from a constant/uniform.\n\t\t\t\t// {x__} =\t8.0/screenWidthInPixels\n\t\t\t\t// {_y_} =\t8.0/screenHeightInPixels\n\t\t\t\t// {_z_} = -4.0/screenWidthInPixels\n\t\t\t\t// {__w} = -4.0/screenHeightInPixels\n\t\t\t\tFxaaFloat4 fxaaConsole360RcpFrameOpt2,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Quality.\n\t\t\t\t// This used to be the FXAA_QUALITY_SUBPIX define.\n\t\t\t\t// It is here now to allow easier tuning.\n\t\t\t\t// Choose the amount of sub-pixel aliasing removal.\n\t\t\t\t// This can effect sharpness.\n\t\t\t\t//\t 1.00 - upper limit (softer)\n\t\t\t\t//\t 0.75 - default amount of filtering\n\t\t\t\t//\t 0.50 - lower limit (sharper, less sub-pixel aliasing removal)\n\t\t\t\t//\t 0.25 - almost off\n\t\t\t\t//\t 0.00 - completely off\n\t\t\t\tFxaaFloat fxaaQualitySubpix,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Quality.\n\t\t\t\t// This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.\n\t\t\t\t// It is here now to allow easier tuning.\n\t\t\t\t// The minimum amount of local contrast required to apply algorithm.\n\t\t\t\t//\t 0.333 - too little (faster)\n\t\t\t\t//\t 0.250 - low quality\n\t\t\t\t//\t 0.166 - default\n\t\t\t\t//\t 0.125 - high quality\n\t\t\t\t//\t 0.063 - overkill (slower)\n\t\t\t\tFxaaFloat fxaaQualityEdgeThreshold,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Quality.\n\t\t\t\t// This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.\n\t\t\t\t// It is here now to allow easier tuning.\n\t\t\t\t// Trims the algorithm from processing darks.\n\t\t\t\t//\t 0.0833 - upper limit (default, the start of visible unfiltered edges)\n\t\t\t\t//\t 0.0625 - high quality (faster)\n\t\t\t\t//\t 0.0312 - visible limit (slower)\n\t\t\t\t// Special notes when using FXAA_GREEN_AS_LUMA,\n\t\t\t\t//\t Likely want to set this to zero.\n\t\t\t\t//\t As colors that are mostly not-green\n\t\t\t\t//\t will appear very dark in the green channel!\n\t\t\t\t//\t Tune by looking at mostly non-green content,\n\t\t\t\t//\t then start at zero and increase until aliasing is a problem.\n\t\t\t\tFxaaFloat fxaaQualityEdgeThresholdMin,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Console.\n\t\t\t\t// This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.\n\t\t\t\t// It is here now to allow easier tuning.\n\t\t\t\t// This does not effect PS3, as this needs to be compiled in.\n\t\t\t\t//\t Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.\n\t\t\t\t//\t Due to the PS3 being ALU bound,\n\t\t\t\t//\t there are only three safe values here: 2 and 4 and 8.\n\t\t\t\t//\t These options use the shaders ability to a free *|/ by 2|4|8.\n\t\t\t\t// For all other platforms can be a non-power of two.\n\t\t\t\t//\t 8.0 is sharper (default!!!)\n\t\t\t\t//\t 4.0 is softer\n\t\t\t\t//\t 2.0 is really soft (good only for vector graphics inputs)\n\t\t\t\tFxaaFloat fxaaConsoleEdgeSharpness,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Console.\n\t\t\t\t// This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.\n\t\t\t\t// It is here now to allow easier tuning.\n\t\t\t\t// This does not effect PS3, as this needs to be compiled in.\n\t\t\t\t//\t Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.\n\t\t\t\t//\t Due to the PS3 being ALU bound,\n\t\t\t\t//\t there are only two safe values here: 1/4 and 1/8.\n\t\t\t\t//\t These options use the shaders ability to a free *|/ by 2|4|8.\n\t\t\t\t// The console setting has a different mapping than the quality setting.\n\t\t\t\t// Other platforms can use other values.\n\t\t\t\t//\t 0.125 leaves less aliasing, but is softer (default!!!)\n\t\t\t\t//\t 0.25 leaves more aliasing, and is sharper\n\t\t\t\tFxaaFloat fxaaConsoleEdgeThreshold,\n\t\t\t\t//\n\t\t\t\t// Only used on FXAA Console.\n\t\t\t\t// This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.\n\t\t\t\t// It is here now to allow easier tuning.\n\t\t\t\t// Trims the algorithm from processing darks.\n\t\t\t\t// The console setting has a different mapping than the quality setting.\n\t\t\t\t// This only applies when FXAA_EARLY_EXIT is 1.\n\t\t\t\t// This does not apply to PS3,\n\t\t\t\t// PS3 was simplified to avoid more shader instructions.\n\t\t\t\t//\t 0.06 - faster but more aliasing in darks\n\t\t\t\t//\t 0.05 - default\n\t\t\t\t//\t 0.04 - slower and less aliasing in darks\n\t\t\t\t// Special notes when using FXAA_GREEN_AS_LUMA,\n\t\t\t\t//\t Likely want to set this to zero.\n\t\t\t\t//\t As colors that are mostly not-green\n\t\t\t\t//\t will appear very dark in the green channel!\n\t\t\t\t//\t Tune by looking at mostly non-green content,\n\t\t\t\t//\t then start at zero and increase until aliasing is a problem.\n\t\t\t\tFxaaFloat fxaaConsoleEdgeThresholdMin,\n\t\t\t\t//\n\t\t\t\t// Extra constants for 360 FXAA Console only.\n\t\t\t\t// Use zeros or anything else for other platforms.\n\t\t\t\t// These must be in physical constant registers and NOT immediates.\n\t\t\t\t// Immediates will result in compiler un-optimizing.\n\t\t\t\t// {xyzw} = float4(1.0, -1.0, 0.25, -0.25)\n\t\t\t\tFxaaFloat4 fxaaConsole360ConstDir\n\t\t) {\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat2 posM;\n\t\t\t\tposM.x = pos.x;\n\t\t\t\tposM.y = pos.y;\n\t\t\t\t#if (FXAA_GATHER4_ALPHA == 1)\n\t\t\t\t\t\t#if (FXAA_DISCARD == 0)\n\t\t\t\t\t\t\t\tFxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n\t\t\t\t\t\t\t\t#if (FXAA_GREEN_AS_LUMA == 0)\n\t\t\t\t\t\t\t\t\t\t#define lumaM rgbyM.w\n\t\t\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\t\t\t#define lumaM rgbyM.y\n\t\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#if (FXAA_GREEN_AS_LUMA == 0)\n\t\t\t\t\t\t\t\tFxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);\n\t\t\t\t\t\t\t\tFxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\tFxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);\n\t\t\t\t\t\t\t\tFxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#if (FXAA_DISCARD == 1)\n\t\t\t\t\t\t\t\t#define lumaM luma4A.w\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#define lumaE luma4A.z\n\t\t\t\t\t\t#define lumaS luma4A.x\n\t\t\t\t\t\t#define lumaSE luma4A.y\n\t\t\t\t\t\t#define lumaNW luma4B.w\n\t\t\t\t\t\t#define lumaN luma4B.z\n\t\t\t\t\t\t#define lumaW luma4B.x\n\t\t\t\t#else\n\t\t\t\t\t\tFxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n\t\t\t\t\t\t#if (FXAA_GREEN_AS_LUMA == 0)\n\t\t\t\t\t\t\t\t#define lumaM rgbyM.w\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\t#define lumaM rgbyM.y\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\t#if (FXAA_GLSL_100 == 1)\n\t\t\t\t\t\t\tFxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tFxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t#endif\n\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat maxSM = max(lumaS, lumaM);\n\t\t\t\tFxaaFloat minSM = min(lumaS, lumaM);\n\t\t\t\tFxaaFloat maxESM = max(lumaE, maxSM);\n\t\t\t\tFxaaFloat minESM = min(lumaE, minSM);\n\t\t\t\tFxaaFloat maxWN = max(lumaN, lumaW);\n\t\t\t\tFxaaFloat minWN = min(lumaN, lumaW);\n\t\t\t\tFxaaFloat rangeMax = max(maxWN, maxESM);\n\t\t\t\tFxaaFloat rangeMin = min(minWN, minESM);\n\t\t\t\tFxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n\t\t\t\tFxaaFloat range = rangeMax - rangeMin;\n\t\t\t\tFxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n\t\t\t\tFxaaBool earlyExit = range < rangeMaxClamped;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tif(earlyExit)\n\t\t\t\t\t\t#if (FXAA_DISCARD == 1)\n\t\t\t\t\t\t\t\tFxaaDiscard;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\t\treturn rgbyM;\n\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t#if (FXAA_GATHER4_ALPHA == 0)\n\t\t\t\t\t\t#if (FXAA_GLSL_100 == 1)\n\t\t\t\t\t\t\tFxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tFxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t\tFxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\t#endif\n\t\t\t\t#else\n\t\t\t\t\t\tFxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));\n\t\t\t\t\t\tFxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat lumaNS = lumaN + lumaS;\n\t\t\t\tFxaaFloat lumaWE = lumaW + lumaE;\n\t\t\t\tFxaaFloat subpixRcpRange = 1.0/range;\n\t\t\t\tFxaaFloat subpixNSWE = lumaNS + lumaWE;\n\t\t\t\tFxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n\t\t\t\tFxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat lumaNESE = lumaNE + lumaSE;\n\t\t\t\tFxaaFloat lumaNWNE = lumaNW + lumaNE;\n\t\t\t\tFxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n\t\t\t\tFxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat lumaNWSW = lumaNW + lumaSW;\n\t\t\t\tFxaaFloat lumaSWSE = lumaSW + lumaSE;\n\t\t\t\tFxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n\t\t\t\tFxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n\t\t\t\tFxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n\t\t\t\tFxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n\t\t\t\tFxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n\t\t\t\tFxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n\t\t\t\tFxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n\t\t\t\tFxaaBool horzSpan = edgeHorz >= edgeVert;\n\t\t\t\tFxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tif(!horzSpan) lumaN = lumaW;\n\t\t\t\tif(!horzSpan) lumaS = lumaE;\n\t\t\t\tif(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n\t\t\t\tFxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat gradientN = lumaN - lumaM;\n\t\t\t\tFxaaFloat gradientS = lumaS - lumaM;\n\t\t\t\tFxaaFloat lumaNN = lumaN + lumaM;\n\t\t\t\tFxaaFloat lumaSS = lumaS + lumaM;\n\t\t\t\tFxaaBool pairN = abs(gradientN) >= abs(gradientS);\n\t\t\t\tFxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n\t\t\t\tif(pairN) lengthSign = -lengthSign;\n\t\t\t\tFxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat2 posB;\n\t\t\t\tposB.x = posM.x;\n\t\t\t\tposB.y = posM.y;\n\t\t\t\tFxaaFloat2 offNP;\n\t\t\t\toffNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n\t\t\t\toffNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n\t\t\t\tif(!horzSpan) posB.x += lengthSign * 0.5;\n\t\t\t\tif( horzSpan) posB.y += lengthSign * 0.5;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat2 posN;\n\t\t\t\tposN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n\t\t\t\tposN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n\t\t\t\tFxaaFloat2 posP;\n\t\t\t\tposP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n\t\t\t\tposP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n\t\t\t\tFxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n\t\t\t\tFxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\n\t\t\t\tFxaaFloat subpixE = subpixC * subpixC;\n\t\t\t\tFxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tif(!pairN) lumaNN = lumaSS;\n\t\t\t\tFxaaFloat gradientScaled = gradient * 1.0/4.0;\n\t\t\t\tFxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n\t\t\t\tFxaaFloat subpixF = subpixD * subpixE;\n\t\t\t\tFxaaBool lumaMLTZero = lumaMM < 0.0;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tlumaEndN -= lumaNN * 0.5;\n\t\t\t\tlumaEndP -= lumaNN * 0.5;\n\t\t\t\tFxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\tFxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n\t\t\t\tFxaaBool doneNP = (!doneN) || (!doneP);\n\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tif(doneNP) {\n\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t#if (FXAA_QUALITY_PS > 3)\n\t\t\t\t\t\tif(doneNP) {\n\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n\t\t\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n\t\t\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n\t\t\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t#if (FXAA_QUALITY_PS > 4)\n\t\t\t\t\t\t\t\tif(doneNP) {\n\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n\t\t\t\t\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t#if (FXAA_QUALITY_PS > 5)\n\t\t\t\t\t\t\t\t\t\tif(doneNP) {\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n\t\t\t\t\t\t\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t\t\t#if (FXAA_QUALITY_PS > 6)\n\t\t\t\t\t\t\t\t\t\t\t\tif(doneNP) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t#if (FXAA_QUALITY_PS > 7)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(doneNP) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t#if (FXAA_QUALITY_PS > 8)\n\t\t\t\tif(doneNP) {\n\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t#if (FXAA_QUALITY_PS > 9)\n\t\t\t\t\t\tif(doneNP) {\n\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n\t\t\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n\t\t\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n\t\t\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t#if (FXAA_QUALITY_PS > 10)\n\t\t\t\t\t\t\t\tif(doneNP) {\n\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n\t\t\t\t\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t#if (FXAA_QUALITY_PS > 11)\n\t\t\t\t\t\t\t\t\t\tif(doneNP) {\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n\t\t\t\t\t\t\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t\t\t#if (FXAA_QUALITY_PS > 12)\n\t\t\t\t\t\t\t\t\t\t\t\tif(doneNP) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoneN = abs(lumaEndN) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoneP = abs(lumaEndP) >= gradientScaled;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdoneNP = (!doneN) || (!doneP);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t}\n\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#endif\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\t}\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat dstN = posM.x - posN.x;\n\t\t\t\tFxaaFloat dstP = posP.x - posM.x;\n\t\t\t\tif(!horzSpan) dstN = posM.y - posN.y;\n\t\t\t\tif(!horzSpan) dstP = posP.y - posM.y;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n\t\t\t\tFxaaFloat spanLength = (dstP + dstN);\n\t\t\t\tFxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n\t\t\t\tFxaaFloat spanLengthRcp = 1.0/spanLength;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaBool directionN = dstN < dstP;\n\t\t\t\tFxaaFloat dst = min(dstN, dstP);\n\t\t\t\tFxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n\t\t\t\tFxaaFloat subpixG = subpixF * subpixF;\n\t\t\t\tFxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n\t\t\t\tFxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n\t\t/*--------------------------------------------------------------------------*/\n\t\t\t\tFxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n\t\t\t\tFxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n\t\t\t\tif(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n\t\t\t\tif( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n\t\t\t\t#if (FXAA_DISCARD == 1)\n\t\t\t\t\t\treturn FxaaTexTop(tex, posM);\n\t\t\t\t#else\n\t\t\t\t\t\treturn FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\n\t\t\t\t#endif\n\t\t}\n\t\t/*==========================================================================*/\n\t\t#endif\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = FxaaPixelShader(\n\t\t\t\tvUv,\n\t\t\t\tvec4(0.0),\n\t\t\t\ttDiffuse,\n\t\t\t\ttDiffuse,\n\t\t\t\ttDiffuse,\n\t\t\t\tresolution,\n\t\t\t\tvec4(0.0),\n\t\t\t\tvec4(0.0),\n\t\t\t\tvec4(0.0),\n\t\t\t\t0.75,\n\t\t\t\t0.166,\n\t\t\t\t0.0833,\n\t\t\t\t0.0,\n\t\t\t\t0.0,\n\t\t\t\t0.0,\n\t\t\t\tvec4(0.0)\n\t\t\t);\n\n\t\t\t// TODO avoid querying texture twice for same texel\n\t\t\tgl_FragColor.a = texture2D(tDiffuse, vUv).a;\n\t\t}'};function Ch(t){return Ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ch(t)}function Ih(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Uh(t,e){return Uh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Uh(t,e)}function Dh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=zh(t);if(e){var o=zh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mh(this,n)}}function Mh(t,e){if(e&&("object"===Ch(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function zh(t){return zh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},zh(t)}var Bh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Uh(t,e)}(i,t);var e,n,r,o=Dh(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,kh)}return e=i,(n=[{key:"setSize",value:function(t,e){var n=this.material.uniforms.resolution.value;n.x=1/t,n.y=1/e}}])&&Ih(e.prototype,n),r&&Ih(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(Yt);function Xh(t){return Xh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xh(t)}function Jh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vh(t,e){return Vh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Vh(t,e)}function Yh(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Wh(t);if(e){var o=Wh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hh(this,n)}}function Hh(t,e){if(e&&("object"===Xh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Wh(t){return Wh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Wh(t)}var Gh,qh,Kh=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vh(t,e)}(u,e);var n,r,o,i=Yh(u);function u(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;Qh(this,u);var a=(e=i.call(this,new t.ShaderMaterial(u.shader))).material.uniforms;return a.uTop.value=n,a.uBottom.value=r,a.uFalloff.value=o,e}return n=u,r&&Jh(n.prototype,r),o&&Jh(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n}(Yt);Kh.shader={uniforms:{tDiffuse:{value:null},uTop:{value:0},uBottom:{value:0},uFalloff:{value:0}},vertexShader:"varying vec2 vUv;\r\n\r\nvoid main() {\r\n\r\n\tvUv = uv;\r\n\r\n\tgl_Position = vec4( position, 1.0 );\r\n\r\n}",fragmentShader:"\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float uTop;\n\t\tuniform float uBottom;\n\t\tuniform float uFalloff;\n\t\tvarying vec2 vUv;\n\n\t\t".concat(Sh,"\n\n\t\tvoid main() {\n\n\t\t\tfloat falloff = uFalloff;\n\t\t\tfloat amount = uBottom;\n\t\t\tif ( vUv.y > 0.5 ) amount = uTop;\n\n\t\t\tvec4 color = texture2D( tDiffuse, vUv );\n\n\t\t\tfloat dist = distance(vUv.y, 0.5);\n\t\t\tcolor.rgb *= smoothstep( 0.8, falloff * 0.799, dist * (amount + falloff) );\n\t\t\t\n\t\t\tcolor.rgb = bayerMatrixDither( color.rgb );\n\n\t\t\tgl_FragColor = color;\n\n\t\t}\n\t")};var $h=new t.WebGLRenderer({powerPreference:"high-performance",stencil:!1});$h.toneMapping=t.ACESFilmicToneMapping;var Zh=$h.domElement;document.getElementById("main").appendChild(Zh);var ty=new ae($h);Gh={renderer:$h,canvas:Zh,composer:ty,init:function(){var e=window,n=e.innerWidth,r=e.innerHeight,o=e.devicePixelRatio,i=Math.round(n/o),u=Math.round(r/o),a=ey.current,c=a.bloom,f=a.adjustments;qh={render:new de(K.scene,K.camera),fxaa:new Bh,bloom:new Lh(new t.Vector2(i,u),c.strength,c.radius,c.threshold),vignette:new Kh(.7,1.2,.25),adjustments:new vh(f)},Object.values(qh).forEach((function(t){return ty.addPass(t)})),Gh.post=qh},resize:function(t,e,n){$h.setPixelRatio(n),$h.setSize(t,e),ty.setSize(t,e),Object.values(qh).forEach((function(r){r.setSize&&r.setSize(t,e,n)}))},update:function(){ty.render()}};var ey,ny=new Ft.GUI;function ry(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],u=!0,a=!1;try{for(n=n.call(t);!(u=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==n.return||n.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return oy(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oy(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oy(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}ny.init=function(){var t=ey.orb,e=Gh.post.adjustments,n=ny.addFolder("Orb");n.add(t,"passes",1,4).step(1),n.add(t,"smoothness",3,30).step(1),n.add(t,"speed",1,100).step(1),n.open();var r=ny.addFolder("Rotation");r.add(t.rotationSpeed,"x",-100,100).step(1),r.add(t.rotationSpeed,"y",-100,100).step(1),r.add(t.rotationSpeed,"z",-100,100).step(1),r.open();var o=1/Math.pow(10,_.digits),i=ny.addFolder("Color");i.add(t,"value1",0,1).step(o),i.add(t,"value2",0,1).step(o),i.add(e,"hue",0,2*Math.PI).step(o),i.add(e,"saturation",0,3).step(o),i.open();var u,a,c,f="save (URL)",l=ny.addFolder("Settings");if(l.add(ey,"reset"),l.add(ey,"random"),l.add((u={},a=f,c=ey.save,a in u?Object.defineProperty(u,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):u[a]=c,u),f),l.open(),ny.updateDisplay=function(){return ny.controllersRecursive().forEach((function(t){return t.updateDisplay()}))},window.sessionStorage){var s="closeGUI";"false"!==window.sessionStorage.getItem(s)&&ny.close(),ny.domElement.addEventListener("click",(function(){window.sessionStorage.setItem(s,ny.closed)}))}};var iy="rotationSpeed";function uy(){var t=ey,e=t.orb,n=t.current;if(ey.orb){var r=Gh.post.adjustments;Object.entries(n.adjustments).forEach((function(t){var e=ry(t,2),n=e[0],o=e[1];r[n]=o})),Object.entries(n.orb).forEach((function(t){var n=ry(t,2),r=n[0],o=n[1];r!==iy&&(e[r]=o)})),Object.entries(n.orb.rotationSpeed).forEach((function(t){var n=ry(t,2),r=n[0],o=n[1];e.rotationSpeed[r]=o})),ny.updateDisplay()}}function ay(){var t="Orion",e=_.hash;document.title=e?"".concat(t," #").concat(e):t,e?sy(e):py(!1)}function cy(){var t=Nt.defaults;ey.current=(0,it.cloneDeep)(t),ey.reference=(0,it.cloneDeep)(t)}var fy=Nt.WINLO_PARAM,ly="seed";function sy(t){t?jt.seed=t:jt.autoseed(),ey.current.seed=jt.seed;var e=function(t,e,n){var r=n.min,o=n.max,i=n.round,u=jt.random(r,o,i);t[e]=_.round(u)},n=Nt.random,r=ey.current,o=r.adjustments,i=r.orb;Object.entries(n.adjustments).forEach((function(t){var n=ry(t,2),r=n[0],i=n[1];jt.random()>.5?e(o,r,i):o[r]=jt.bool()?i.min:i.max})),Object.entries(n.orb).forEach((function(t){var n=ry(t,2),r=n[0],o=n[1];return e(i,r,o)})),Object.entries(n.rotationSpeed).forEach((function(t){var n=ry(t,2),r=n[0],o=n[1];jt.random()>.66?e(i.rotationSpeed,r,o):i.rotationSpeed[r]=0})),ey.reference=(0,it.cloneDeep)(ey.current),uy(),t||(t=jt.seed,_.save({seed:t},!1,{hash:ly}))}function py(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&_.reset(),cy(),uy()}function hy(t){return hy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hy(t)}function yy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function dy(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function by(t,e){return by=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},by(t,e)}function my(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_y(t);if(e){var o=_y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gy(this,n)}}function gy(t,e){if(e&&("object"===hy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _y(t){return _y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},_y(t)}ey={random:sy,save:function(){!function(){var t=ey,e=t.orb,n=t.current;Object.keys(n.adjustments).forEach((function(t){n.adjustments[t]=_.round(Gh.post.adjustments[t])})),Object.keys(n.orb).forEach((function(t){t!==iy&&(n.orb[t]=_.round(e[t]))})),Object.keys(n.orb.rotationSpeed).forEach((function(t){n.orb.rotationSpeed[t]=_.round(e.rotationSpeed[t])}))}();var t=ey,e=t.current,n=t.reference;_.save(e,fy,{reference:n,hash:ly})},load:function(){ay(),_.load(ey.current,fy,{hash:ly}),uy()},reset:py,init:function(t){ey.orb=t,window.addEventListener("hashchange",ay)}},cy();var wy=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&by(t,e)}(u,e);var n,r,o,i=my(u);function u(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);var n=ey.current.orb,r=n.passes,o=n.smoothness,a=n.speed,c=n.value1,f=n.value2,l=n.rotationSpeed,s=new t.SphereGeometry(1,320,320),p=new t.ShaderMaterial({vertexShader:"#define PI acos(-1.0)\n\nuniform int uPasses;\nuniform float uSmoothness;\nuniform float uSpeed;\nuniform float uTime;\nvarying vec4 vPosition;\nvarying float vDistance;\n\n// Classic Perlin 3D Noise, by Stefan Gustavson\nvec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}\nvec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}\nvec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}\n\nfloat cnoise(vec3 P){\n  vec3 Pi0 = floor(P); // Integer part for indexing\n  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n  Pi0 = mod(Pi0, 289.0);\n  Pi1 = mod(Pi1, 289.0);\n  vec3 Pf0 = fract(P); // Fractional part for interpolation\n  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n  vec4 iz0 = Pi0.zzzz;\n  vec4 iz1 = Pi1.zzzz;\n\n  vec4 ixy = permute(permute(ix) + iy);\n  vec4 ixy0 = permute(ixy + iz0);\n  vec4 ixy1 = permute(ixy + iz1);\n\n  vec4 gx0 = ixy0 / 7.0;\n  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n  gx0 = fract(gx0);\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n  vec4 sz0 = step(gz0, vec4(0.0));\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n  vec4 gx1 = ixy1 / 7.0;\n  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n  gx1 = fract(gx1);\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n  vec4 sz1 = step(gz1, vec4(0.0));\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n  g000 *= norm0.x;\n  g010 *= norm0.y;\n  g100 *= norm0.z;\n  g110 *= norm0.w;\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n  g001 *= norm1.x;\n  g011 *= norm1.y;\n  g101 *= norm1.z;\n  g111 *= norm1.w;\n\n  float n000 = dot(g000, Pf0);\n  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n  float n111 = dot(g111, Pf1);\n\n  vec3 fade_xyz = fade(Pf0);\n  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n  return 2.2 * n_xyz;\n}\n// \n\nvoid main() {\n\n    vec3 pos = position;\n\n    float speed = 0.01 * uSpeed;\n    float loopLength = 10.0 * speed;\n\n    float factor1 = uSmoothness;\n    float factor2 = uSmoothness * 0.8;\n    float factor = mix(factor1, factor2, sin( uTime ));\n\n    // Lerp-based noise loop\n    float transitionStart = loopLength * 0.5;\n    float time = mod(uTime * speed, loopLength);\n\n    float v1 = cnoise(pos + time);\n    float v2 = cnoise(pos + time - loopLength);\n\n\tfor ( int i = 0; i < 4; i ++ ) {\n\t\tv1 = cnoise( vec3(v1) );\n\t\tv2 = cnoise( vec3(v2) );\n\t\tif ( i + 2 > uPasses ) break; // Const index hack for old GL versions\n\t}\n\n    float transitionProgress = (time-transitionStart)/(loopLength-transitionStart);\n    float progress = clamp(transitionProgress, 0.0, 1.0);\n\n    float noise = mix(v1, v2, progress) / factor;\n\n    pos += noise;\n\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(pos, 1.0);\n\n    vPosition = modelMatrix * vec4(pos, 1.0);\n    vDistance = distance(pos, vec3(0.0));\n\n}",fragmentShader:"uniform float uValue1;\nuniform float uValue2;\nvarying vec4 vPosition;\nvarying float vDistance;\n\nfloat map(float s, float a1, float a2, float b1, float b2) {\n\n    return b1 + (s-a1)*(b2-b1)/(a2-a1);\n\n}\n\nvoid main() {\n\n\tvec4 baseColor = vec4( 0.95, 0.98, 1.0, 1.0 );\n\tvec4 color1 = baseColor * uValue1;\n\tvec4 color2 = baseColor * uValue2;\n\n    float distanceMap = map(vDistance, 1.0 , 1.1, 0.0, 1.0);\n\n    vec4 color = mix( color1, color2, distanceMap );\n\n    gl_FragColor = vec4( color );\n\n}",uniforms:{uPasses:{value:r},uSmoothness:{value:o},uSpeed:{value:a},uTime:{value:0},uValue1:{value:c},uValue2:{value:f}}});return(e=i.call(this,s,p)).rotationSpeed=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yy(Object(n),!0).forEach((function(e){dy(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yy(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},l),e}return n=u,(r=[{key:"update",value:function(t){var e=this.rotation,n=this.rotationSpeed,r=.01;t/=1e3,e.x=t*n.x*r,e.y=t*n.y*r,e.z=t*n.z*r,this.time=t}},{key:"invert",value:function(){var t=this.value1,e=this.value2,n=t;t=e,e=n}},{key:"passes",get:function(){return this.material.uniforms.uPasses.value},set:function(t){this.material.uniforms.uPasses.value=t}},{key:"smoothness",get:function(){return this.material.uniforms.uSmoothness.value},set:function(t){this.material.uniforms.uSmoothness.value=t}},{key:"speed",get:function(){return this.material.uniforms.uSpeed.value},set:function(t){this.material.uniforms.uSpeed.value=t}},{key:"time",get:function(){return this.material.uniforms.uTime.value},set:function(t){this.material.uniforms.uTime.value=t}},{key:"value1",get:function(){return this.material.uniforms.uValue1.value},set:function(t){this.material.uniforms.uValue1.value=t}},{key:"value2",get:function(){return this.material.uniforms.uValue2.value},set:function(t){this.material.uniforms.uValue2.value=t}}])&&vy(n.prototype,r),o&&vy(n,o),Object.defineProperty(n,"prototype",{writable:!1}),u}(t.Mesh);function xy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Py=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;xy(this,t),this.callbacks="function"==typeof e?[e]:e,this.fps=n,this.elapsed=0,this._last=0,this._delta=0,this._isPlaying=!1,this._tick=this.tick.bind(this)}var e,n,r;return e=t,n=[{key:"add",value:function(t){this.has(t)||this.callbacks.push(t)}},{key:"remove",value:function(t){this.has(t)&&this.callbacks.splice(this.callbacks.indexOf(t),1)}},{key:"has",value:function(t){return this.callbacks.includes(t)}},{key:"reset",value:function(){this.elapsed=0}},{key:"start",value:function(){this._last=this.now,this._delta=0,this._isPlaying=!0,this.requestFrame()}},{key:"pause",value:function(){this._isPlaying=!1}},{key:"stop",value:function(){this.pause(),this.reset()}},{key:"tick",value:function(){var e=this;if(this.isPlaying){this.requestFrame();var n=this.now,r=Math.min(t.maxDelta,n-this._last);this._last=n,this._delta+=r,this.elapsed+=r;var o=this._frameDuration-this._delta;o<=0&&(this.callbacks.forEach((function(t){return t.call(e,e.elapsed,e._delta)})),this._delta=Math.abs(o))}}},{key:"requestFrame",value:function(){requestAnimationFrame(this._tick)}},{key:"fps",get:function(){return this._fps},set:function(t){this._fps=t,this._frameDuration=t>0?Math.floor(1e3/t):0}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"now",get:function(){return t.time.now()}}],n&&Oy(e.prototype,n),r&&Oy(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Sy(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sy(t)}function Ty(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ay(t,e,n){return e&&Ty(t.prototype,e),n&&Ty(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function jy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ry(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ny(t,e)}function Ny(t,e){return Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ny(t,e)}function Fy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ky(t);if(e){var o=ky(this).constructor;Reflect.construct(r,arguments,o)}else r.apply(this,arguments);return Ey(this,n)}}function Ey(t,e){if(e&&("object"===Sy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ly(t)}function Ly(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ky(t){return Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ky(t)}Py.maxDelta=100,Py.time=void 0===performance?Date:performance;var Cy={type:"change"},Iy={type:"start"},Uy={type:"end"},Dy=(t.EventDispatcher,document.body.style),My=K.camera,zy=K.scene,By=new t.Vector2,Xy=new t.Raycaster;function Jy(t){By.x=t.clientX/window.innerWidth*2-1,By.y=1-t.clientY/window.innerHeight*2}function Qy(t){Jy(t),Vy.intersects&&ey.random()}var Vy={pointer:By,raycaster:Xy,update:function(){var t=Vy.camera,e=t.target,n=t.origin,r=t.targetXY,o=t.lookAt,i=t.lerpSpeed;e.x=n.x+r.x*By.x,e.y=n.y+r.y*By.y,e.z=n.z,My.position.lerp(e,i),My.lookAt(o);var u=Vy.intersects;Dy.cursor=u?"pointer":"auto"},init:function(){var t=Gh.canvas;t.addEventListener("pointermove",Jy),t.addEventListener("pointerup",Qy)},resize:function(e,n){My.position.set(0,.5,10),e<n&&(My.position.z=14),Vy.camera={lookAt:new t.Vector3(0,0,0),origin:new t.Vector3,target:new t.Vector3,targetXY:new t.Vector2(5,1),lerpSpeed:.02},Vy.camera.origin.copy(My.position)},get intersects(){return Xy.setFromCamera(By,My),Xy.intersectObjects(zy.children,!1).length}};_.init(),_.digits=2,ey.load();var Yy=K.scene,Hy=new ot;Hy.position.y=-1.35,Yy.add(Hy);var Wy=new wy;function Gy(t){ey.init(Wy),Hy.init(t),Gh.init(),Vy.init(),setTimeout(ny.init,0),window.addEventListener("resize",qy),qy(),new Py(Ky,60).start()}function qy(){var t=window,e=t.innerWidth,n=t.innerHeight,r=t.devicePixelRatio,o=e,i=n;[K,Gh,Hy,Vy].forEach((function(t){return t.resize(o,i,r)})),Wy.position.z=o<i?2:0}function Ky(t){[Vy,Wy,Gh].forEach((function(e){return e.update(t)}))}Yy.add(Wy),(new t.TextureLoader).load("textures/polished_concrete_basecolor.jpg",(function(t){return Gy(t)}),void 0,(function(){return Gy()}))}()}();